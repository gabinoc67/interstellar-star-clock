<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Einstein–Casanova Unified Action Playground — v3</title>

<script>
  window.MathJax = { tex: { inlineMath: [['$','$'], ['\\(','\\)']] } };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

<style>
:root{
  --bg:#050815;--panel:#111735;--ink:#eaf0ff;--muted:#9fa8d6;--accent:#8fb4ff;
  --border:#1c2750;--ok:#35e6a2;--warn:#ffd15a;--bad:#ff6b8b;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
.wrap{max-width:1460px;margin:0 auto;padding:16px}
.panel{
  background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px 14px;margin-bottom:16px;
}
h1{margin:0 0 10px;font-size:1.55rem}
h2{margin:4px 0;font-size:1.15rem}
.muted{color:var(--muted);font-size:0.9rem}
textarea{min-height:60px;padding:6px 8px;width:100%}
select,input{width:100%;background:#050b20;color:var(--ink);border:1px solid var(--border);border-radius:6px}
.slider-row{display:flex;align-items:center;gap:8px}
.slider-row span.value{min-width:32px;text-align:right;font-size:0.85rem;color:var(--muted)}
.checkbox-row{display:flex;gap:8px;margin-top:6px}
.btn-row{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
button{
  border:none;border-radius:999px;padding:8px 14px;cursor:pointer;color:#050815;
  font-weight:600;font-size:0.88rem;
}
button.primary{background:var(--accent)}
button.secondary{background:#18204a;color:var(--ink)}
button.danger{background:var(--bad)}
.results{background:#0a1230;border:1px solid var(--border);border-radius:10px;margin-top:10px;padding:10px}
.tag-row{display:flex;flex-wrap:wrap;gap:6px;margin-top:5px}
.section-grid{display:grid;grid-template-columns:1.1fr 1.2fr;gap:12px}
@media(max-width:900px){.section-grid{grid-template-columns:1fr}}
.eq-box{background:#050b20;border:1px solid var(--border);border-radius:12px;padding:10px 14px;margin-top:14px}
#equationImg{width:100%;max-width:100%;border-radius:8px;border:1px solid var(--border);margin-top:12px}
.log-table{width:100%;font-size:0.8rem;margin-top:10px;border-collapse:collapse}
.log-table th,.log-table td{border:1px solid var(--border);padding:4px;text-align:left}
</style>
</head>
<body>
<div class="wrap">

<h1>Einstein–Casanova Unified Action Playground — v3</h1>
<p class="muted">Interactive testbed for tuning each term of the Unified Lagrangian and attaching researcher notes for export.</p>

<!-- HOW TO -->
<div class="panel">
<h2>How to use:</h2>
<ol class="muted" style="padding-left:20px">
<li>Select scenario</li>
<li>Toggle which fields are relevant</li>
<li>Adjust strength sliders + scenario-specific inputs</li>
<li>Add optional research notes</li>
<li>Click <strong>Calculate + Add to Log</strong></li>
<li>Export JSON/CSV when ready</li>
</ol>
</div>

<!-- SCENARIO + TOGGLES -->
<div class="section-grid">
<div class="panel">
<h2>Scenario</h2>
<select id="scenario">
<option value="cosmo">Cosmology — Universe evolution</option>
<option value="collider">Particle Collider — QFT Regime</option>
<option value="blackhole">Near Black Hole — Strong Curvature</option>
<option value="warp">Warp Engine — Φ₍warp₎ bubble</option>
<option value="cst">CST Star Clock</option>
<option value="sprc">SPR-C / Consciousness Lab</option>
</select>

<hr style="border:none;border-top:1px solid var(--border);margin:12px 0" />
<h3>Active Fields</h3>

<div class="checkbox-row"><input type="checkbox" id="gravActive" checked><label>Gravity</label></div>
<div class="checkbox-row"><input type="checkbox" id="gaugeActive" checked><label>Gauge</label></div>
<div class="checkbox-row"><input type="checkbox" id="dmActive" checked><label>Dark Matter</label></div>
<div class="checkbox-row"><input type="checkbox" id="deActive" checked><label>Dark Energy</label></div>
<div class="checkbox-row"><input type="checkbox" id="vacActive" checked><label>Vacuum Energy</label></div>
<div class="checkbox-row"><input type="checkbox" id="warpActive" checked><label>Warp Field</label></div>
<div class="checkbox-row"><input type="checkbox" id="consActive" checked><label>Consciousness</label></div>
</div>

<!-- SLIDERS + INPUTS -->
<div class="panel">
<h2>Sector Strengths</h2>

<label>Gravity<div class="slider-row"><input type="range" id="gravStrength" min="0" max="10" step="0.1" value="6"><span id="gravVal">6.0</span></div></label>
<label>Gauge<div class="slider-row"><input type="range" id="gaugeStrength" min="0" max="10" step="0.1" value="7"><span id="gaugeVal">7.0</span></div></label>
<label>Dark Matter<div class="slider-row"><input type="range" id="dmStrength" min="0" max="10" step="0.1" value="5"><span id="dmVal">5.0</span></div></label>
<label>Dark Energy<div class="slider-row"><input type="range" id="deStrength" min="0" max="10" step="0.1" value="4"><span id="deVal">4.0</span></div></label>
<label>Vacuum<div class="slider-row"><input type="range" id="vacStrength" min="0" max="10" step="0.1" value="3"><span id="vacVal">3.0</span></div></label>
<label>Warp<div class="slider-row"><input type="range" id="warpStrength" min="0" max="10" step="0.1" value="2"><span id="warpVal">2.0</span></div></label>
<label>Consciousness<div class="slider-row"><input type="range" id="consStrength" min="0" max="10" step="0.1" value="1"><span id="consVal">1.0</span></div></label>

<hr style="border:none;border-top:1px solid var(--border);margin:12px 0" />
<h3>Per-Scenario Inputs</h3>
<div id="scenarioInputs"></div>
</div>
</div>

<!-- RESULTS -->
<div class="panel">
<h2>Output</h2>
<div class="results">
  <div id="summaryText" class="muted">Click Calculate after entering parameters.</div>
  <div id="tagRow" class="tag-row"></div>
  <div id="bars" class="bars"></div>
</div>
</div>

<!-- RESEARCH LOG -->
<div class="panel">
<h2>Research Log</h2>
<textarea id="logNotes" placeholder="Observations, stability comments, theoretical expectations..."></textarea>
<div class="btn-row">
  <button class="primary" id="btnAddLog">Calculate + Add to Log</button>
  <button class="secondary" id="btnExportJSON">Export JSON</button>
  <button class="secondary" id="btnExportCSV">Export CSV</button>
  <button class="danger" id="btnReset">Reset All</button>
</div>

<table class="log-table" id="logTable">
  <thead><tr><th>#</th><th>Scenario</th><th>Dominant Sector</th><th>S_eff</th><th>Notes</th></tr></thead>
  <tbody></tbody>
</table>
</div>

<!-- EQUATION IMAGE ONLY -->
<div class="panel eq-box">
<h2>Unified Action — Permanent Equation Image</h2>
<p class="muted">This image stays here permanently as your master formula reference.</p>
<img id="equationImg"
     src="https://gabinoc67.github.io/interstellar-star-clock/einstein.jpg"
     alt="Unified Action Equation" />
</div>

<script>
/* slider labels */
["grav","gauge","dm","de","vac","warp","cons"].forEach(p=>{
  const s=document.getElementById(p+"Strength"),v=document.getElementById(p+"Val");
  s.addEventListener("input",()=>{v.textContent=parseFloat(s.value).toFixed(1);});
});

/* scenario input templates */
const inputTemplates = {
  cosmo:`<label>Redshift z<input type="number" id="in_z" step="0.001" value="1.2"></label>`,
  collider:`<label>√s (TeV)<input type="number" id="in_s" step="0.1" value="13.0"></label>`,
  blackhole:`<label>r/rₛ<input type="number" id="in_rrs" step="0.01" value="1.1"></label>`,
  warp:`<label>Bubble Radius<input type="number" id="in_Rb" step="0.1" value="12.0"></label>
        <label>J(E↔m)<input type="number" id="in_Jem" step="0.001" value="0.24"></label>`,
  cst:`<label>CST Offset Δτ (ns)<input type="number" id="in_dtau" step="0.01" value="0.74"></label>`,
  sprc:`<label>Network Size N<input type="number" id="in_N" value="512"></label>
        <label>Coupling Θ<input type="number" id="in_theta" step="0.01" value="1.35"></label>`
};
function refreshScenarioInputs(){document.getElementById("scenarioInputs").innerHTML = inputTemplates[document.getElementById("scenario").value];}
document.getElementById("scenario").addEventListener("change",refreshScenarioInputs);

/* scenario weights */
const W={
 cosmo:{grav:2.3,gauge:1.1,dm:1.9,de:2.2,vac:1.9,warp:0.6,cons:0.3},
 collider:{grav:0.6,gauge:2.7,dm:0.8,de:0.2,vac:0.3,warp:0.4,cons:0.2},
 blackhole:{grav:3.1,gauge:1.2,dm:0.9,de:0.6,vac:1.2,warp:1.3,cons:0.3},
 warp:{grav:0.9,gauge:1.4,dm:0.6,de:1.1,vac:2.4,warp:3.0,cons:0.7},
 cst:{grav:1.8,gauge:1.8,dm:1.3,de:0.8,vac:0.9,warp:1.2,cons:0.5},
 sprc:{grav:0.5,gauge:1.3,dm:0.4,de:0.4,vac:0.7,warp:0.9,cons:3.1}
};
function sectorVal(k){
 if(!document.getElementById(k+"Active").checked) return 0;
 return parseFloat(document.getElementById(k+"Strength").value) * W[document.getElementById("scenario").value][k];
}

/* scenario extras */
function scenarioExtras(s){
 switch(s){
  case"cosmo":return{DE:1+0.12*in_z.value,vac:1+0.06*in_z.value};
  case"collider":return{gauge:1+0.05*in_s.value};
  case"blackhole":return{grav:Math.min(5,1/in_rrs.value)};
  case"warp":return{warp:1+0.03*in_Rb.value+0.4*in_Jem.value};
  case"cst":return{gauge:1+0.1*in_dtau.value};
  case"sprc":return{cons:1+0.002*in_N.value+0.25*in_theta.value};
 }
 return {};
}

function runCalculation(){
 const s=document.getElementById("scenario").value, e=scenarioExtras(s);
 let grav=sectorVal("grav"), gauge=sectorVal("gauge"), dm=sectorVal("dm"),
     de=sectorVal("de"), vac=sectorVal("vac"), warp=sectorVal("warp"), cons=sectorVal("cons");
 if(e.DE) de*=e.DE;if(e.vac) vac*=e.vac;if(e.gauge) gauge*=e.gauge;if(e.grav) grav*=e.grav;
 if(e.warp) warp*=e.warp;if(e.cons) cons*=e.cons;

 const total=grav+gauge+dm+de+vac+warp+cons;
 if(!total){summaryText.innerHTML="No sectors active";tagRow.innerHTML="";bars.innerHTML="";return{dominant:"None",Seff:0};}

 const f=[grav,gauge,dm,de,vac,warp,cons].map(v=>v/total);
 const classical=grav+gauge+dm, exotic=de+vac+warp+cons, Seff=(0.7*classical+1.3*exotic).toFixed(2);
 const stab=(classical/(classical+de+vac+1e-9)), stabPct=(100*stab).toFixed(1);
 const names=["Gravity","Gauge","Dark Matter","Dark Energy","Vacuum","Warp","Consciousness"];
 const dom=names[f.indexOf(Math.max(...f))];

 summaryText.innerHTML=`<strong>S_eff:</strong> ${Seff}<br><strong>Stability:</strong> ${stabPct}%<br><strong>Dominant sector:</strong> ${dom}`;

 let tags="";
 if(stab>0.7) tags+=`<span class="tag ok">Classical stable</span>`;
 else if(stab>0.4) tags+=`<span class="tag warn">Mixed</span>`;
 else tags+=`<span class="tag bad">Vacuum dominated</span>`;
 if(f[5]>0.2) tags+=`<span class="tag warn">Warp reinforced</span>`;
 if(f[6]>0.2) tags+=`<span class="tag ok">Consciousness linked</span>`;
 tagRow.innerHTML = tags;

 bars.innerHTML = names.map((n,i)=>`<div class="bar"><div style="font-size:0.8rem;color:var(--muted)">${n}: ${(100*f[i]).toFixed(1)}%</div><div class="bar-track"><div class="bar-fill" style="width:${(100*f[i]).toFixed(1)}%;"></div></div></div>`).join("");

 return{dominant:dom,Seff:Seff};
}

/* log system */
const log=[];
btnAddLog.addEventListener("click",()=>{
 const r=runCalculation();log.push({scenario:scenario.value,dominant:r.dominant,Seff:r.Seff,notes:logNotes.value});
 logNotes.value="";updateTable();
});
function updateTable(){
 logTable.querySelector("tbody").innerHTML = log.map((L,i)=>`<tr><td>${i+1}</td><td>${L.scenario}</td><td>${L.dominant}</td><td>${L.Seff}</td><td>${L.notes}</td></tr>`).join("");
}

/* export */
btnExportJSON.addEventListener("click",()=>{const b=new Blob([JSON.stringify(log,null,2)],{type:"application/json"});const a=document.createElement("a");a.href=URL.createObjectURL(b);a.download="Unified_Log.json";a.click();});
btnExportCSV.addEventListener("click",()=>{
 let csv="index,scenario,dominant,Seff,notes\n";
 log.forEach((L,i)=>{csv+=`${i+1},${L.scenario},${L.dominant},${L.Seff},"${(L.notes||"").replace(/"/g,'""')}"\n`;});
 const a=document.createElement("a");a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));a.download="Unified_Log.csv";a.click();
});

/* reset */
btnReset.addEventListener("click",()=>{
 scenario.value="cosmo";refreshScenarioInputs();
 ["grav","gauge","dm","de","vac","warp","cons"].forEach(k=>document.getElementById(k+"Active").checked=true);
 const d={grav:6,gauge:7,dm:5,de:4,vac:3,warp:2,cons:1};
 Object.keys(d).forEach(k=>{document.getElementById(k+"Strength").value=d[k];document.getElementById(k+"Val").textContent=d[k].toFixed(1);});
 log.length=0;updateTable();
 summaryText.innerHTML="Click Calculate after entering parameters.";tagRow.innerHTML="";bars.innerHTML="";logNotes.value="";
});

/* initialize */
refreshScenarioInputs();
</script>
</div>
</body>
</html>
