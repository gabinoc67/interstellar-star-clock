<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>ü™ê Interstellar Star Clock ‚Äî Solar System + Planet Clocks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{ --fg:#00ffcc; --gap: clamp(10px, 2vmin, 22px); --pad: clamp(10px, 2vmin, 18px); }
    *{ box-sizing: border-box; }
    body{
      background:#000; color:var(--fg); font-family:'Courier New', monospace;
      margin:0; min-height:100vh; display:flex; justify-content:center; padding: var(--pad);
    }
    .wrap{
      display:grid;
      grid-template-columns: minmax(420px, 1.25fr) minmax(360px, 1fr) minmax(260px, .85fr);
      gap: var(--gap);
      max-width: min(1600px, 98vw);
      width:100%;
      align-items:start;
    }
    header{
      grid-column: 1 / -1; display:flex; justify-content:space-between; align-items:center; gap: var(--gap);
    }
    h1{ margin:0; font-size: clamp(0.75rem, 1.8vw, 1.2rem); line-height:1.12; letter-spacing:.4px; }
    .controls{ display:flex; align-items:center; gap:.5rem; font-size: clamp(.8rem, 1.4vw, .95rem); }
    select{
      background:#001a16; color:var(--fg); border:1px solid #064e3b; padding:.25rem .45rem; border-radius:6px;
    }
    .solar { display:flex; justify-content:center; align-items:center; }
    canvas{ width:100%; max-width:900px; aspect-ratio:1 / 1; background:#000; border:1px solid #064e3b; border-radius:10px; }
    .content{ text-align:center; padding: var(--pad); }
    h2{ margin:.2rem 0 .35rem; font-size: clamp(.9rem, 1.7vw, 1.2rem); }
    .clock-box{ margin-top: .7rem; font-size: clamp(.8rem, 1.3vw, 1.05rem); }
    .muted{ opacity:.85; font-size:.95em; }
    .planet-image{ display:flex; justify-content:center; align-items:center; }
    .planet-image img{ width:min(26vw, 42vh, 360px); height:auto; display:block; }
    @media (max-width: 1100px){
      .wrap{ grid-template-columns: 1fr; }
      .planet-image img{ width:min(60vw, 48vh, 360px); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ü™ê Interstellar Star Clock ‚Äî Solar System (live) + <span id="titlePlanet">Earth</span> Clocks</h1>
      <div class="controls">
        <label for="planet">Planet:</label>
        <select id="planet">
          <option>Mercury</option><option>Venus</option><option selected>Earth</option>
          <option>Mars</option><option>Jupiter</option><option>Saturn</option>
          <option>Uranus</option><option>Neptune</option><option>Pluto</option>
        </select>
      </div>
    </header>

    <!-- LEFT: Solar system -->
    <div class="solar">
      <canvas id="solarCanvas"></canvas>
    </div>

    <!-- CENTER: Selected planet readouts -->
    <div class="content">
      <div class="clock-box">
        <h2>üåç Local Time (America/Chicago)</h2>
        <div id="localClock"></div>
      </div>
      <div class="clock-box">
        <h2>üåå Interstellar Time</h2>
        <div id="interstellarClock" class="muted"></div>
      </div>
      <div class="clock-box">
        <h2>üöÄ Stardate</h2>
        <div id="starDate" class="muted"></div>
      </div>
      <div class="clock-box">
        <h2>üìè Distance from Sun</h2>
        <div id="distanceFromSun"></div>
        <div id="distanceAU" class="muted"></div>
      </div>
      <div class="clock-box">
        <h2>üìê Distance from Earth</h2>
        <div id="distanceFromEarth"></div>
        <div id="distanceEarthAU" class="muted"></div>
      </div>
      <div class="clock-box">
        <h2>üî≠ Orbital Position</h2>
        <div id="trueAnomaly"></div>
      </div>
      <div class="clock-box">
        <h2>üïõ Orbit Clock (since perihelion)</h2>
        <div id="orbitSince"></div>
        <div id="orbitRemaining"></div>
        <div id="orbitPercent"></div>
        <div id="orbitDetails" class="muted"></div>
      </div>
    </div>

    <!-- RIGHT: Planet image -->
    <div class="planet-image">
      <img id="planetImg" alt="Planet image">
    </div>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const DEG2RAD = Math.PI/180, RAD2DEG = 180/Math.PI, AU_TO_MILES = 92955807.3;
    function norm360(x){ x = x % 360; return x < 0 ? x + 360 : x; }
    function norm2pi(x){ x = x % (2*Math.PI); return x < 0 ? x + 2*Math.PI : x; }

    function toJulianDate(dateUTC) {
      const a = Math.floor((14 - (dateUTC.getUTCMonth()+1)) / 12);
      const y = dateUTC.getUTCFullYear() + 4800 - a;
      const m = (dateUTC.getUTCMonth()+1) + 12*a - 3;
      const JDN = dateUTC.getUTCDate()
        + Math.floor((153*m + 2)/5)
        + 365*y + Math.floor(y/4) - Math.floor(y/100) + Math.floor(y/400) - 32045;
      const dayFrac = (dateUTC.getUTCHours() - 12)/24
        + dateUTC.getUTCMinutes()/1440 + dateUTC.getUTCSeconds()/86400
        + dateUTC.getUTCMilliseconds()/86400000;
      return JDN + dayFrac;
    }
    function dhmsDays(totalDays) {
      const d = Math.floor(totalDays);
      const h = Math.floor((totalDays - d) * 24);
      const m = Math.floor(((totalDays - d) * 24 - h) * 60);
      const s = Math.floor(((((totalDays - d) * 24 - h) * 60) - m) * 60);
      return `${d}d ${h}h ${m}m ${s}s`;
    }

    // PLANETS data (Kepler elements already in your system)
    const PLANETS = {
      Mercury:{ a:0.39, e:0.206, P:87.97, color:"#9ad" },
      Venus:{ a:0.72, e:0.007, P:224.7, color:"#f7c" },
      Earth:{ a:1.0, e:0.017, P:365.25, color:"#0fc" },
      Mars:{ a:1.52, e:0.093, P:687, color:"#f66" },
      Jupiter:{ a:5.20, e:0.049, P:4332, color:"#ffb" },
      Saturn:{ a:9.54, e:0.054, P:10759, color:"#fb9" },
      Uranus:{ a:19.19, e:0.047, P:30688, color:"#9ff" },
      Neptune:{ a:30.07, e:0.009, P:60182, color:"#9bf" },
      Pluto:{ a:39.48, e:0.249, P:90560, color:"#ddd" }
    };

    function solveKepler(M, e) {
      let E = M;
      for (let i=0;i<10;i++) E = M + e*Math.sin(E);
      return E;
    }

    function orbitState(name, dateUTC){
      const p = PLANETS[name];
      const JD = toJulianDate(dateUTC);
      const M = 2*Math.PI * ((JD % p.P)/p.P); // mean anomaly
      const E = solveKepler(M, p.e);
      const ŒΩ = 2*Math.atan2(Math.sqrt(1+p.e)*Math.sin(E/2), Math.sqrt(1-p.e)*Math.cos(E/2));
      const r = p.a*(1-p.e*Math.cos(E));
      return {x:r*Math.cos(ŒΩ), y:r*Math.sin(ŒΩ), r, ŒΩ, color:p.color};
    }

    // Scaling: expand inner, compress outer
    function scaleAU(rAU){
      if (rAU < 2) return rAU*2.2;     // inner planets expanded
      if (rAU < 10) return rAU*0.9;    // middle compressed slightly
      if (rAU < 40) return rAU*0.4;    // outer compressed more
      return Math.log(rAU+1)*2.5;
    }

    // Draw Solar System
    const solarCanvas = document.getElementById('solarCanvas');
    const sctx = solarCanvas.getContext('2d');

    function resizeSolar(){
      const css = solarCanvas.getBoundingClientRect();
      const ratio = window.devicePixelRatio || 1;
      solarCanvas.width = css.width*ratio;
      solarCanvas.height = css.height*ratio;
      sctx.setTransform(ratio,0,0,ratio,0,0);
    }

    function drawSolar(){
      resizeSolar();
      const w = solarCanvas.clientWidth, h = solarCanvas.clientHeight;
      const cx=w/2, cy=h/2;
      sctx.clearRect(0,0,w,h);

      // degree ticks
      sctx.strokeStyle="rgba(255,255,255,0.25)";
      sctx.fillStyle="rgba(255,255,255,0.6)";
      sctx.font="10px Courier New";
      const Rpx=Math.min(cx,cy)*0.88;
      for (let deg=0;deg<360;deg+=30){
        const rad=(deg-90)*DEG2RAD;
        const x=cx+Rpx*Math.cos(rad), y=cy+Rpx*Math.sin(rad);
        sctx.fillText(deg+"¬∞",x,y);
      }

      // Sun
      sctx.fillStyle="#ffb400";
      sctx.beginPath(); sctx.arc(cx,cy,6,0,2*Math.PI); sctx.fill();

      // planets
      Object.keys(PLANETS).forEach(n=>{
        const st=orbitState(n,new Date());
        const r=scaleAU(Math.hypot(st.x,st.y));
        const ang=Math.atan2(st.y,st.x);
        const x=cx+r*Math.cos(ang), y=cy+r*Math.sin(ang);

        sctx.strokeStyle="rgba(255,255,255,0.2)";
        sctx.beginPath(); sctx.moveTo(cx,cy); sctx.lineTo(x,y); sctx.stroke();

        sctx.fillStyle=st.color;
        sctx.beginPath(); sctx.arc(x,y,5,0,2*Math.PI); sctx.fill();
        sctx.fillText(n,x+7,y);
      });
    }

    // clocks
    const localClock=document.getElementById("localClock");
    const interstellarClock=document.getElementById("interstellarClock");
    const starDateEl=document.getElementById("starDate");
    const titlePlanet=document.getElementById("titlePlanet");
    const planetImg=document.getElementById("planetImg");
    const selectPlanet=document.getElementById("planet");

    const IMG={
      Mercury:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/mercury2.png",
      Venus:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/venus2.png",
      Earth:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/earth.png",
      Mars:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/mars.png",
      Jupiter:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/jupiter.png",
      Saturn:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/saturn.png",
      Uranus:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/uranus.png",
      Neptune:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/neptune2.png",
      Pluto:"https://raw.githubusercontent.com/gabinoc67/interstellar-star-clock/main/pluto2.png"
    };

    function updateClocks(){
      const now=new Date();
      localClock.textContent=now.toLocaleString("en-US",{timeZone:"America/Chicago"});
      interstellarClock.textContent=now.toUTCString();
      const JD=toJulianDate(now);
      starDateEl.textContent=((JD-2415020.0)/365.25*1000).toFixed(2);
      titlePlanet.textContent=selectPlanet.value;
      planetImg.src=IMG[selectPlanet.value];
      drawSolar();
    }

    setInterval(updateClocks,1000);
    updateClocks();
  });
  </script>
</body>
</html>
