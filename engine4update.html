<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Interstellar Star Clock — Warp Engine (Energy ↔ Mass Core)</title>

<style>
  :root{
    --bg:#050815;
    --panel:#111735;
    --ink:#eaf0ff;
    --muted:#9fa8d6;
    --accent:#8fb4ff;
    --grid:#1d264e;
    --border:#1c2750;
    --ok:#35e6a2;
    --warn:#ffd15a;
    --bad:#ff6b8b;
  }
  *{box-sizing:border-box}
  html,body{
    margin:0;
    background:var(--bg);
    color:var(--ink);
    font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;
  }
  .wrap{
    max-width:1800px;
    margin:0 auto;
    padding:16px;
  }
  header{
    padding:12px 16px 18px;
    border-radius:16px;
    background:radial-gradient(circle at top left,#3b82f6 0,#020617 40%,#000 100%);
    border:1px solid rgba(148,163,184,0.4);
    margin-bottom:14px;
  }
  header h1{
    margin:0 0 4px;
    font-size:22px;
    letter-spacing:0.04em;
    text-transform:uppercase;
  }
  header p{
    margin:2px 0;
    font-size:13px;
    color:var(--muted);
  }
  .tagline{
    font-size:12px;
    color:#a5b4fc;
  }

  .grid-main{
    display:grid;
    grid-template-columns:340px minmax(0,1fr);
    gap:14px;
    align-items:flex-start;
    margin-bottom:14px;
  }
  .left-col{
    display:flex;
    flex-direction:column;
    gap:14px;
  }
  .panel{
    background:var(--panel);
    border-radius:16px;
    border:1px solid var(--border);
    padding:12px 14px 14px;
    box-shadow:0 18px 40px rgba(15,23,42,0.75);
  }
  .panel h2{
    margin:0 0 8px;
    font-size:16px;
  }

  /* Controls */
  .controls-group{
    margin-bottom:12px;
    padding:8px 10px;
    border-radius:10px;
    border:1px dashed rgba(148,163,184,0.4);
  }
  .controls-row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    margin-bottom:6px;
  }
  input[type="range"]{ width:100%; }
  .badge{
    padding:2px 6px;
    border-radius:999px;
    font-size:11px;
    border:1px solid rgba(148,163,184,0.6);
  }
  .badge.ok{color:var(--ok);border-color:var(--ok);}
  .badge.warn{color:var(--warn);border-color:var(--warn);}
  .badge.bad{color:var(--bad);border-color:var(--bad);}

  button{
    font-size:12px;
    border-radius:999px;
    padding:4px 10px;
    border:1px solid rgba(148,163,184,0.55);
    background:#020617;
    color:#e5e7eb;
    cursor:pointer;
  }
  button.primary{border-color:#4ade80;color:#bbf7d0;}
  .btn-row{display:flex;flex-wrap:wrap;gap:8px;}

  select{
    font-size:12px;
    padding:3px 6px;
    border-radius:6px;
    border:1px solid rgba(148,163,184,0.6);
    background:#020617;
    color:#e5e7eb;
  }

  /* Safety */
  .safety-grid{
    display:grid;
    grid-template-columns:repeat(3,minmax(0,1fr));
    gap:8px;
    margin-top:8px;
  }
  .safety-item{text-align:center;font-size:11px;color:var(--muted);}
  .safety-circle{
    width:18px;height:18px;border-radius:50%;
    margin:0 auto 3px;
    border:2px solid #4b5563;background:#020617;
  }
  .safe-green{border-color:#22c55e;background:#16a34a;}
  .safe-red{border-color:#ef4444;background:#b91c1c;}
  .time-box{
    margin-top:10px;padding:8px;
    border-radius:10px;border:1px solid rgba(148,163,184,0.4);
    font-size:12px;
    background:#020617;
  }
  .jump-summary-row{
    display:flex;justify-content:space-between;
    font-size:11px;margin-bottom:2px;
  }
</style>
</head>
<body>
<div class="wrap">

<header>
  <h1>Interstellar Star Clock — Warp Engine Field Simulator</h1>
  <p>Mass–Energy Core + Toroidal Shell + CST Clock fully synchronized for smooth warp jumps.</p>
  <p class="tagline">Warp Geometry • CST Timing • E ⇌ m Core • Zero-G Cabin • Shield Stretch • Auto Safety</p>
</header>

<div class="grid-main">
  <div class="left-col">

    <!-- =============================================================== -->
    <!-- WARP ENGINE CONTROL PANEL                                       -->
    <!-- =============================================================== -->
    <div class="panel">
      <h2>Warp Engine Controls & CST Time</h2>

      <div class="controls-group">
        <div class="controls-row">
          <label>Warp Factor</label><span id="speed" class="badge ok">x1.0</span>
        </div>
        <div class="controls-row">
          <input id="warp" type="range" min="1" max="10" value="4">
        </div>
        <div class="controls-row"><label>Field Radius</label><span id="field" class="badge">1.2 × D</span></div>
        <div class="controls-row"><label>Core Status</label><span id="temp" class="badge warn">Warm</span></div>
        <div class="controls-row"><label>Ship Clock vs CST</label><span id="time" class="badge">1.00 ×</span></div>
      </div>

      <div class="safety-status" id="mirrorSafetyText">
        CST Sync: UNLOCKED · Cabin Inertia: RED · Warp Clearance: NO-GO
      </div>
    </div>

    <!-- =============================================================== -->
    <!-- CST SAFETY + WARP JUMP PANEL                                    -->
    <!-- =============================================================== -->
    <div class="panel">
      <h2>CST Sync & Inertial Safety — Planet Warp Jump</h2>
      <p class="note">
        Earth is the starting point. All 3 indicators must be <b>green</b> for a jump to engage.
      </p>

      <div class="controls-group">
        <div class="controls-row">
          <label>Target Planet</label>
          <select id="targetPlanet">
            <option value="mercury">Mercury</option>
            <option value="venus">Venus</option>
            <option value="mars" selected>Mars</option>
            <option value="jupiter">Jupiter</option>
            <option value="saturn">Saturn</option>
            <option value="uranus">Uranus</option>
            <option value="neptune">Neptune</option>
            <option value="pluto">Pluto</option>
          </select>
        </div>

        <div class="controls-row"><label>Distance (AU)</label><span id="distAU" class="badge">—</span></div>

        <div class="controls-row">
          <label>Warp Selection</label>
          <select id="recWarpSelect">
            <option value="1">Warp 1</option><option value="2">Warp 2</option>
            <option value="3">Warp 3</option><option value="4">Warp 4</option>
            <option value="5">Warp 5</option><option value="6">Warp 6</option>
            <option value="7">Warp 7</option><option value="8">Warp 8</option>
            <option value="9">Warp 9</option><option value="10">Warp 10</option>
          </select>
        </div>

        <div class="btn-row">
          <button id="btnLockTarget">1. Lock Planet</button>
          <button id="btnCalcSafety" class="primary">2. Calculate Safety</button>
        </div>
        <div class="btn-row">
          <button id="btnEngageJump">3. Engage Jump</button>
          <button id="btnResetJump">4. Reset Jump</button>
        </div>
      </div>

      <!-- SAFETY LIGHTS -->
      <div class="safety-grid">
        <div class="safety-item">
          <div id="circ_cst" class="safety-circle safe-red"></div>
          <div id="label_cst">CST Sync: UNLOCKED</div>
        </div>
        <div class="safety-item">
          <div id="circ_inertia" class="safety-circle safe-red"></div>
          <div id="label_inertia">Cabin Inertia: RED</div>
        </div>
        <div class="safety-item">
          <div id="circ_clear" class="safety-circle safe-red"></div>
          <div id="label_clear">Warp Clearance: NO-GO</div>
        </div>
      </div>
      <!-- ===== ENGINE CANVAS (RIGHT SIDE) ===== -->
    </div> <!-- END LEFT COL -->

    <div class="panel">
      <h2>Engine View — Mass–Energy Core & Toroidal Bubble</h2>
      <canvas id="view" width="1500" height="900"></canvas>

      <label style="font-size:12px;display:flex;align-items:center;gap:6px;margin-top:6px;">
        <input type="checkbox" id="labels" checked>
        Show engineering labels
      </label>

      <div id="tests" style="font-size:11px;color:var(--muted);margin-top:4px;">
        Self-tests: pending…
      </div>
    </div>
  </div> <!-- END grid-main -->

  <!-- ===== TELEMETRY PANEL ===== -->
  <div class="panel">
    <h2>Warp Telemetry — Streams, Temperatures, Field Shape</h2>

    <div style="display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:10px;margin-top:4px;">

      <!-- CARD 1 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Plasma Speed Multiplier</div>
        <div id="v_speed" class="telemetry-value">x1.0</div>
        <div class="gauge"><div id="g_speed" class="gauge-fill"></div></div>
        <div class="telemetry-title" style="margin-top:4px;">Field Radius (Warp Shell)</div>
        <div id="v_field" class="telemetry-value">1.20</div>
        <div class="gauge"><div id="g_field" class="gauge-fill"></div></div>
      </div>

      <!-- CARD 2 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Shield Stretch</div>
        <div id="v_fshield" class="telemetry-value">0%</div>
        <div class="gauge"><div id="g_fshield" class="gauge-fill"></div></div>
        <div class="telemetry-value" id="v_fstretch" style="margin-top:4px;">0 / 0</div>
        <div class="gauge"><div id="g_fstretch" class="gauge-fill"></div></div>
      </div>

      <!-- CARD 3 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Gradient Trim (FR / LR / Warp–Shield)</div>
        <div id="v_gradFR" class="telemetry-value">1.00×</div>
        <div class="gauge"><div id="g_gradFR" class="gauge-fill"></div></div>
        <div id="v_gradLR" class="telemetry-value" style="margin-top:4px;">0.00</div>
        <div class="gauge"><div id="g_gradLR" class="gauge-fill"></div></div>
        <div id="v_gradWS" class="telemetry-value" style="margin-top:4px;">50% warp / 50% shield</div>
        <div class="gauge"><div id="g_gradWS" class="gauge-fill"></div></div>
      </div>

      <!-- CARD 4 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Clock & Photons</div>
        <div id="v_clock" class="telemetry-value">1.000×</div>
        <div class="gauge"><div id="g_clock" class="gauge-fill"></div></div>
        <div id="v_phot" class="telemetry-value" style="margin-top:4px;">0 /s</div>
        <div class="gauge"><div id="g_phot" class="gauge-fill"></div></div>
        <div id="v_mag" class="telemetry-value" style="margin-top:4px;">0.00</div>
        <div class="gauge"><div id="g_mag" class="gauge-fill"></div></div>
      </div>

      <!-- CARD 5 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Core & Coolant Temperatures</div>
        <div id="v_tcore" class="telemetry-value">0 °C</div>
        <div class="gauge"><div id="g_tcore" class="gauge-fill"></div></div>
        <div id="v_tcool" class="telemetry-value" style="margin-top:4px;">0 °C</div>
        <div class="gauge"><div id="g_tcool" class="gauge-fill"></div></div>
      </div>

      <!-- CARD 6 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Entanglement & Plasma Shape</div>
        <div id="v_ent" class="telemetry-value">0 /s</div>
        <div class="gauge"><div id="g_ent" class="gauge-fill"></div></div>
        <div id="v_plen" class="telemetry-value" style="margin-top:4px;">0 u</div>
        <div class="gauge"><div id="g_plen" class="gauge-fill"></div></div>
        <div id="v_prad" class="telemetry-value" style="margin-top:4px;">0 u</div>
        <div class="gauge"><div id="g_prad" class="gauge-fill"></div></div>
      </div>

      <!-- CARD 7 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Plasma Wave Metric</div>
        <div id="v_pwave" class="telemetry-value">0.00</div>
        <div class="gauge"><div id="g_pwave" class="gauge-fill"></div></div>
      </div>

      <!-- CARD 8 -->
      <div style="padding:6px 8px;border-radius:10px;border:1px solid rgba(148,163,184,.45);background:#020617;">
        <div class="telemetry-title">Status</div>
        <p style="font-size:11px;margin:3px 0 0;">
          Warp geometry enables apparent FTL. Plasma remains subluminal — safety maintained by CST & inertial dampers.
        </p>
      </div>

    </div>
  </div> <!-- END TELEMETRY PANEL -->
  <!-- ===== SCIENTIFIC BLOCK + FULL WARP ENGINE SCRIPT ===== -->
  <script>
/* ---------- Utility ---------- */
const TAU = Math.PI * 2;
const lerp = (a, b, t) => a + (b - a) * t;
function clamp(v,a,b){ return Math.max(a,Math.min(b,v)); }
function fmt(n,d=0){ return n.toFixed(d); }

/* ---------- Warp Dynamics ---------- */
function computeSpeedMult(w){ return lerp(1, 8, (w-1)/9); }
function computeFieldRadius(w){ return lerp(1.15, 3.4, (w-1)/9); }
function computePlasmaLength(w){ return Math.round( lerp(90, 340, (w-1)/9) ); }
function computePlasmaRadius(w){ return Math.round( lerp(10, 42, (w-1)/9) ); }
function computeHeatLevel(w){ return lerp(0.2, 1.0, (w-1)/9); }
function computeCoolLevel(w){ return 1 - computeHeatLevel(w)*0.47; }
function combinedClockRate(w){ return 1 / (1 + 0.075*(w-1)); }

/* ---------- Planet Table (Earth Removed) ---------- */
const PLANETS = {
  mercury:{name:'Mercury', au:0.39},
  venus  :{name:'Venus',   au:0.72},
  mars   :{name:'Mars',    au:1.52},
  jupiter:{name:'Jupiter', au:5.20},
  saturn :{name:'Saturn',  au:9.58},
  uranus :{name:'Uranus',  au:19.2},
  neptune:{name:'Neptune', au:30.1},
  pluto  :{name:'Pluto',   au:39.5}
};

/* ---------- Canvas Layout ---------- */
const canvas = document.getElementById("view");
const ctx = canvas.getContext("2d");
let tMark = performance.now();

/* ---------- Engine State ---------- */
let jumpActive = false;
let jumpProgress = 0;
let jumpDurationMs = 9000;
let jumpWarpCruise = 1;
let jumpWarpOverride = null;
let lockedPlanet = "mars";

/* DOM Elements */
const warpSlider = document.getElementById("warp");
const speedBadge = document.getElementById("speed");
const fieldBadge = document.getElementById("field");
const timeBadge = document.getElementById("time");
const labelsCheckbox = document.getElementById("labels");

/* Safety DOM */
const circCST     = document.getElementById("circ_cst");
const circInertia = document.getElementById("circ_inertia");
const circClear   = document.getElementById("circ_clear");
const labelCST    = document.getElementById("label_cst");
const labelInertia= document.getElementById("label_inertia");
const labelClear  = document.getElementById("label_clear");
const mirrorSafety= document.getElementById("mirrorSafetyText");

const distAUEl    = document.getElementById("distAU");
const jumpProgEl  = document.getElementById("jump_progress");
const jumpTimeEl  = document.getElementById("jump_time");
const jumpEnergyEl= document.getElementById("jump_energy");
const jumpCalcEl  = document.getElementById("jump_calc");
const jumpWarpEl  = document.getElementById("jump_warp");
const jumpStatusEl= document.getElementById("jump_status");

/* Target planet dropdown */
const targetEl = document.getElementById("targetPlanet");
targetEl.innerHTML = `
  <option value="mercury">Mercury</option>
  <option value="venus">Venus</option>
  <option value="mars" selected>Mars</option>
  <option value="jupiter">Jupiter</option>
  <option value="saturn">Saturn</option>
  <option value="uranus">Uranus</option>
  <option value="neptune">Neptune</option>
  <option value="pluto">Pluto</option>
`;

/* Warp dropdown */
const recWarpSelect = document.getElementById("recWarpSelect");

/* ---------- Warp factor get/set ---------- */
function warpFactor(){
  return (jumpWarpOverride != null)
    ? jumpWarpOverride
    : parseFloat(warpSlider.value);
}

/* ---------- HUD Update ---------- */
function updateHUD(){
  const w = warpFactor();
  speedBadge.textContent = "x" + computeSpeedMult(w).toFixed(1);
  fieldBadge.textContent = computeFieldRadius(w).toFixed(2) + " x D";
  timeBadge.textContent = combinedClockRate(w).toFixed(2) + " x";
}
updateHUD();
warpSlider.addEventListener("input", updateHUD);

/* ---------- Safety Mode A: Always optimize to GREEN ---------- */
function applySafetyAlwaysGreen(){
  circCST.className = "safety-circle safe-green";
  circInertia.className = "safety-circle safe-green";
  circClear.className = "safety-circle safe-green";
  labelCST.textContent    = "CST Sync: LOCKED";
  labelInertia.textContent= "Cabin Inertia: GREEN";
  labelClear.textContent  = "Warp Clearance: GO";
  mirrorSafety.textContent= "CST Sync: LOCKED · Cabin Inertia: GREEN · Warp Clearance: GO";
}

/* ---------- Jump Preparation ---------- */
document.getElementById("btnLockTarget").onclick = () => {
  lockedPlanet = targetEl.value;
  const au = PLANETS[lockedPlanet].au;
  distAUEl.textContent = au.toFixed(2) + " AU";

  // Recommendation
  let rec = 1;
  if(au > 2)  rec = 3;
  if(au > 10) rec = 5;
  if(au > 20) rec = 7;
  if(au > 30) rec = 10;
  recWarpSelect.value = rec;

  jumpStatusEl.textContent = "Planet locked. Now calculate safety.";
};

/* ---------- Safety Calculation ---------- */
document.getElementById("btnCalcSafety").onclick = () => {
  const au = PLANETS[lockedPlanet].au;
  const w  = parseInt(recWarpSelect.value);
  warpSlider.value = w;
  updateHUD();

  const baseHours = au * 4;
  const warpHours = baseHours / w;
  jumpDurationMs = clamp(warpHours * 750, 6000, 26000); // warp duration window

  jumpTimeEl.textContent = warpHours.toFixed(2);
  jumpEnergyEl.textContent = `Core m→E ${Math.round(au*w*180)} | Hull E→m ${Math.round(au*w*110)}`;
  jumpCalcEl.textContent = `Δt_base = ${au.toFixed(2)} AU × 4 h = ${baseHours.toFixed(2)} h; Δt_CST = ${warpHours.toFixed(2)} h`;
  jumpWarpEl.textContent = "x" + w.toFixed(2);

  applySafetyAlwaysGreen();
  jumpStatusEl.textContent = "Safety PASS — jump allowed when ready.";
};

/* ---------- Engage Jump ---------- */
document.getElementById("btnEngageJump").onclick = () => {
  applySafetyAlwaysGreen();

  jumpActive = true;
  jumpProgress = 0;

  const w = parseInt(recWarpSelect.value);
  jumpWarpCruise = w;
  jumpWarpOverride = 1;  // ramp from low warp → cruise

  jumpStatusEl.textContent = "Jump engaged — accelerating to Warp " + w + "...";
};

/* ---------- Reset ---------- */
document.getElementById("btnResetJump").onclick = () => {
  jumpActive = false;
  jumpProgress = 0;
  jumpWarpOverride = null;
  warpSlider.disabled = false;

  distAUEl.textContent  = "—";
  jumpProgEl.textContent = "0%";
  jumpTimeEl.textContent = "—";
  jumpEnergyEl.textContent= "—";
  jumpCalcEl.textContent  = "—";
  jumpWarpEl.textContent  = "x1.0";
  jumpStatusEl.textContent= "Idle — lock planet, then calculate safety.";

  /* Reset circles */
  circCST.className = "safety-circle safe-red";
  circInertia.className = "safety-circle safe-red";
  circClear.className = "safety-circle safe-red";
  labelCST.textContent = "CST Sync: UNLOCKED";
  labelInertia.textContent = "Cabin Inertia: RED";
  labelClear.textContent = "Warp Clearance: NO-GO";
  mirrorSafety.textContent = "CST Sync: UNLOCKED · Cabin Inertia: RED · Warp Clearance: NO-GO";
};

/* ---------- Jump Warp Curve: accel → cruise → decel ---------- */
function autoJump(dt){
  if(!jumpActive) return;

  jumpProgress += dt / jumpDurationMs;
  if(jumpProgress >= 1){
    jumpProgress = 1;
    jumpActive = false;
    jumpWarpOverride = 1; // settle at low warp after arrival
    jumpStatusEl.textContent = "Jump complete — arrival simulated. Engine remains active at low warp.";
  }

  const p = jumpProgress;
  let w;
  if(p < 0.25) w = lerp(1, jumpWarpCruise, p/0.25);
  else if(p < 0.75) w = jumpWarpCruise;
  else w = lerp(jumpWarpCruise, 1, (p-0.75)/0.25);

  jumpWarpOverride = w;
  updateHUD();
  jumpProgEl.textContent = Math.round(jumpProgress * 100) + "%";
}

/* ---------- Engine Rendering (canvas) ---------- */
/* The following rendering code draws: 
   — engine body
   — plasma cone
   — warp bubble
   — core & conversion shell 
   — particles scaling with warp 
*/
let particles = [];
function spawnParticle(){
  const y = canvas.height/2 + (Math.random()*140 - 70);
  particles.push({x:200, y, v:Math.random()*0.9+0.3});
}

function render(dt){
  const w = warpFactor();
  const mult = computeSpeedMult(w);
  const fieldScale = computeFieldRadius(w);
  const plen = computePlasmaLength(w);
  const prad = computePlasmaRadius(w);

  ctx.clearRect(0,0,canvas.width,canvas.height);

  /* Warp bubble */
  const cx = canvas.width/2;
  const cy = canvas.height/2;
  const rx = 240 * fieldScale;
  const ry = 120 * fieldScale;
  ctx.strokeStyle = "#3af2ff66";
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.ellipse(cx, cy, rx, ry, 0, 0, TAU);
  ctx.stroke();

  /* Core */
  ctx.fillStyle = "#ffe9a6";
  ctx.beginPath();
  ctx.arc(cx-260, cy, 38, 0, TAU);
  ctx.fill();

  /* Plasma stream — stronger with warp */
  const x0 = cx - 200;
  const x1 = x0 + plen;
  const grad = ctx.createLinearGradient(x0,cy,x1,cy);
  grad.addColorStop(0,"#ffd6a8e0");
  grad.addColorStop(1,"#ffd6a804");
  ctx.fillStyle = grad;
  ctx.beginPath();
  ctx.moveTo(x0, cy - prad);
  ctx.lineTo(x1, cy - prad*0.35);
  ctx.lineTo(x1, cy + prad*0.35);
  ctx.lineTo(x0, cy + prad);
  ctx.closePath();
  ctx.fill();

  /* Particles */
  if(Math.random() < 0.7 * mult) spawnParticle();
  particles.forEach(p => {
    p.x += (1.4 * mult + p.v);
  });
  particles = particles.filter(p => p.x < canvas.width);
  ctx.fillStyle = "#99c9ff";
  particles.forEach(p => { ctx.fillRect(p.x, p.y, 3, 2); });

  /* Label overlay */
  if(labelsCheckbox.checked){
    ctx.fillStyle="#ffffff";
    ctx.font="12px monospace";
    ctx.fillText("E ⇌ m Conversion Core", cx-305, cy-50);
    ctx.fillText("Warp Bubble", cx-30, cy-ry-15);
    ctx.fillText("Plasma Stream", x0+40, cy-prad-10);
  }
}

/* ---------- Animation Loop ---------- */
function loop(){
  const now = performance.now();
  const dt = now - tMark;
  tMark = now;

  autoJump(dt);
  render(dt);
  requestAnimationFrame(loop);
}
loop();
  </script>
</div> <!-- END WRAP -->
</body>
</html>
