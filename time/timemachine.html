<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CST Time-Machine Simulator — 4-Clock Warp Field</title>
<style>
  :root {
    --bg:#0b1020; --ink:#eaf0ff; --mut:#9fb0d0;
    --panel:#121936; --line:#223062; --glow:#67e3ff;
    --intensity:0; --beam-color:rgba(160,255,255,.9);
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial}
  .wrap{max-width:1200px;margin:0 auto;padding:20px}
  h1{margin:0 0 6px;font-weight:900;letter-spacing:.4px}
  .pill{display:inline-block;border:1px solid var(--line);padding:4px 10px;border-radius:999px;font-size:12px;color:#bcd}
  .grid{display:grid;gap:14px}
  .grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:18px;padding:16px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .label{font-size:12px;color:var(--mut)}
  .value{font-weight:800}
  .button{cursor:pointer;font-weight:900;border-radius:14px;border:1px solid var(--line);
          padding:10px 16px;background:#0f1841;color:var(--ink)}
  .button:active{transform:translateY(1px)}
  input[type="datetime-local"]{width:100%;background:#0d1536;border:1px solid #243468;
    border-radius:8px;padding:8px;color:#eaf0ff}
  .clockbox{font-family:monospace;font-size:18px;background:#0d1536;border-radius:10px;padding:10px;
            border:1px solid #2a3a6e;text-align:center}
  .clock-title{font-size:12px;color:#9fb0d0;margin-bottom:3px}
  .ok{color:#7cff9e}
  .bad{color:#ff9090}

  /* Warp chamber */
  .chamber{position:relative;overflow:hidden;min-height:300px;border-radius:18px;margin-top:20px}
  .beam{position:absolute;inset:0;margin:auto;width:50%;height:80%;
         background:radial-gradient(ellipse at center,var(--beam-color),transparent 70%);
         opacity:calc(.4 + .6*var(--intensity));filter:blur(6px);transition:background .5s}
  .floor{position:absolute;bottom:0;left:0;right:0;height:20%;background:linear-gradient(#1b2a5a,#0b1020)}
  .label-bottom{text-align:center;color:var(--mut);font-size:12px;margin-top:4px}
</style>
</head>
<body>
<div class="wrap">
  <h1>CST Time-Machine Simulator — 4-Clock Warp Field</h1>
  <div class="pill">Live UTC • Local • Destination • Δt Counter</div>

  <div class="grid grid-2" style="margin-top:14px">
    <div class="card">
      <div class="row"><strong>Set Destination</strong></div>
      <div style="margin-top:8px">
        <label class="label">Destination (Local calendar)</label>
        <input id="destDT" type="datetime-local">
      </div>
      <div class="row" style="margin-top:12px">
        <button class="button" id="travelBtn">Travel to Destination</button>
        <button class="button" id="resetBtn">Reset</button>
      </div>
      <div class="label" id="status">Status: STABLE</div>
    </div>

    <div class="card">
      <div class="grid grid-2">
        <div class="clockbox">
          <div class="clock-title">UTC Cosmic Clock</div>
          <div id="utcClock">--:--:--</div>
        </div>
        <div class="clockbox">
          <div class="clock-title">Current Local Time</div>
          <div id="localClock">--:--:--</div>
        </div>
        <div class="clockbox">
          <div class="clock-title">Destination Time</div>
          <div id="destClock">--:--:--</div>
        </div>
        <div class="clockbox">
          <div class="clock-title">Δt (Difference)</div>
          <div id="diffClock">--:--:--</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card chamber">
    <div class="beam" id="beam"></div>
    <div class="floor"></div>
    <div class="label-bottom">Beam glows red while traveling and fades to white on arrival.</div>
  </div>
</div>

<script>
(function(){
  const utcClock = document.getElementById("utcClock");
  const localClock = document.getElementById("localClock");
  const destClock = document.getElementById("destClock");
  const diffClock = document.getElementById("diffClock");
  const beam = document.getElementById("beam");
  const travelBtn = document.getElementById("travelBtn");
  const resetBtn = document.getElementById("resetBtn");
  const destDT = document.getElementById("destDT");
  const status = document.getElementById("status");

  let destination = null;
  let traveling = false;
  let travelStart = 0, travelDuration = 8000; // 8s smooth transition
  let initialDiff = 0;

  travelBtn.addEventListener("click",()=>{
    if(!destDT.value){ alert("Please select a destination date and time."); return; }
    destination = new Date(destDT.value);
    initialDiff = destination - new Date();
    if(isNaN(destination)){ alert("Invalid date."); return; }
    traveling = true;
    travelStart = performance.now();
    beam.style.setProperty("--beam-color","rgba(255,80,80,0.9)");
    document.documentElement.style.setProperty("--intensity","1");
    status.innerHTML = "<span class='bad'>TRAVELING...</span>";
  });

  resetBtn.addEventListener("click",()=>{
    destination=null;
    traveling=false;
    document.documentElement.style.setProperty("--intensity","0");
    beam.style.setProperty("--beam-color","rgba(160,255,255,.9)");
    status.innerHTML = "Status: STABLE";
    diffClock.textContent="--:--:--";
  });

  function fmt(t){
    return t.toString().padStart(2,"0");
  }

  function formatClock(date){
    return fmt(date.getHours())+":"+fmt(date.getMinutes())+":"+fmt(date.getSeconds());
  }

  function formatDiff(ms){
    const sign = ms>=0?"+":"−";
    const abs=Math.abs(ms);
    const d=Math.floor(abs/86400000);
    const h=Math.floor((abs%86400000)/3600000);
    const m=Math.floor((abs%3600000)/60000);
    const s=Math.floor((abs%60000)/1000);
    return `${sign}${d}d ${fmt(h)}:${fmt(m)}:${fmt(s)}`;
  }

  function tick(){
    const now = new Date();
    utcClock.textContent = now.toUTCString().split(" ")[4];
    localClock.textContent = formatClock(now);

    if(destination){
      destClock.textContent = formatClock(destination);
      let diff = destination - now;

      // If traveling, interpolate difference to 0 over travelDuration
      if(traveling){
        const elapsed = performance.now() - travelStart;
        const p = Math.min(elapsed/travelDuration,1);
        diff = initialDiff * (1 - p);  // moves toward zero
        // Beam glows red to white
        const r = Math.floor(255*(1-p) + 160*p);
        const g = Math.floor(80 + 175*p);
        const b = Math.floor(80 + 175*p);
        beam.style.setProperty("--beam-color",`rgba(${r},${g},${b},0.9)`);
        document.documentElement.style.setProperty("--intensity",(1-p).toFixed(2));
        if(p>=1){
          traveling=false;
          beam.style.setProperty("--beam-color","rgba(200,255,255,.9)");
          document.documentElement.style.setProperty("--intensity","0");
          status.innerHTML = "<span class='ok'>ARRIVED — STABLE</span>";
        }
      }
      diffClock.textContent = formatDiff(diff);
    } else {
      destClock.textContent="--:--:--";
    }

    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
})();
</script>
</body>
</html>
