<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CST Time-Machine Simulator — 4-Clock Warp Field</title>
<style>
  :root {
    --bg:#0b1020; --ink:#eaf0ff; --mut:#9fb0d0;
    --panel:#121936; --line:#223062;
    --beam-color:rgba(180,240,255,0.8);
    --intensity:0.3; --vibe:1;
    --particle-speed:8s; --photon-speed:3s;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial}
  .wrap{max-width:1200px;margin:0 auto;padding:20px}
  h1{margin:0 0 8px;font-weight:900}
  .pill{display:inline-block;border:1px solid var(--line);padding:4px 10px;border-radius:999px;font-size:12px;color:#bcd}
  .grid{display:grid;gap:14px}
  .grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:18px;padding:16px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .label{font-size:12px;color:var(--mut)}
  .value{font-weight:800}
  .button{cursor:pointer;font-weight:900;border-radius:14px;border:1px solid var(--line);
          padding:10px 16px;background:#0f1841;color:#eaf0ff}
  .clockbox{font-family:monospace;font-size:17px;background:#0d1536;border-radius:10px;padding:8px 10px;
            border:1px solid #2a3a6e;text-align:center}
  .clock-title{font-size:12px;color:#9fb0d0;margin-bottom:3px}

  /* Chamber visuals */
  .chamber{position:relative;overflow:hidden;min-height:360px;border-radius:18px;margin-top:20px}
  .beam{position:absolute;left:50%;top:5%;bottom:10%;transform:translateX(-50%);
    width:20%;background:radial-gradient(ellipse at center,var(--beam-color),transparent 70%);
    opacity:calc(.3 + .7*var(--intensity));filter:blur(8px);transition:background .5s}
  .ring{position:absolute;left:50%;transform:translateX(-50%) scaleX(calc(1 + .03*var(--vibe)));
    width:80%;height:70px;border:2px solid #2aa8ff66;border-radius:999px;
    box-shadow:0 0 20px #6ff6ff33 inset,0 0 25px #2aa8ff55;
    animation:vibe calc(0.5s/var(--vibe)) linear infinite}
  .ring.top{top:6%}
  .ring.bot{bottom:8%}
  .ring::after{content:"";position:absolute;inset:0;border-radius:inherit;border:1px dashed #aef7ff77;animation:dash 8s linear infinite}
  @keyframes dash{to{transform:rotate(360deg)}}
  @keyframes vibe{0%{transform:translateX(-50%) scaleX(1)}
                  50%{transform:translateX(-50%) scaleX(1.04)}
                  100%{transform:translateX(-50%) scaleX(1)}}
  .orbit{position:absolute;inset:0;pointer-events:none}
  .particle{position:absolute;top:50%;left:50%;width:6px;height:6px;border-radius:50%;
    background:#dfffff;box-shadow:0 0 8px #dfffff,0 0 14px #66e1ff}
  .photons{position:absolute;left:50%;top:2%;bottom:12%;width:30%;transform:translateX(-50%);pointer-events:none}
  .photon{position:absolute;left:50%;width:3px;height:12px;background:#bfffff;box-shadow:0 0 8px #bfffff,0 0 16px #66e1ff;opacity:.8}
  .photon.up{animation:rise var(--photon-speed) linear infinite}
  .photon.down{animation:fall var(--photon-speed) linear infinite}
  @keyframes rise{from{transform:translate(-50%,100%)}to{transform:translate(-50%,-10%)}}
  @keyframes fall{from{transform:translate(-50%,-10%)}to{transform:translate(-50%,100%)}}
  .floor{position:absolute;bottom:0;left:5%;right:5%;height:12%;background:linear-gradient(#16244f,#0b1020);border-top:1px solid #2aa8ff33}
  .label-bottom{text-align:center;color:#9fb0d0;font-size:12px;margin-top:6px}
</style>
</head>
<body>
<div class="wrap">
  <h1>CST Time-Machine Simulator</h1>
  <div class="pill">Live UTC • Local • Destination • Δt Counter with full visuals</div>

  <div class="grid grid-2" style="margin-top:14px">
    <div class="card">
      <div class="row"><strong>Destination Control</strong></div>
      <div style="margin-top:8px">
        <label class="label">Destination (Local calendar)</label>
        <input id="destDT" type="datetime-local">
      </div>
      <div class="row" style="margin-top:12px">
        <button class="button" id="travelBtn">Travel to Destination</button>
        <button class="button" id="resetBtn">Reset</button>
      </div>
      <div class="label" id="status">Status: STABLE</div>
    </div>

    <div class="card">
      <div class="grid grid-2">
        <div class="clockbox">
          <div class="clock-title">UTC Cosmic Clock</div>
          <div id="utcClock">--</div>
        </div>
        <div class="clockbox">
          <div class="clock-title">Current Local Time</div>
          <div id="localClock">--</div>
        </div>
        <div class="clockbox">
          <div class="clock-title">Destination Time</div>
          <div id="destClock">--</div>
        </div>
        <div class="clockbox">
          <div class="clock-title">Δt Difference</div>
          <div id="diffClock">--</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card chamber">
    <div class="ring top"></div>
    <div class="ring bot"></div>
    <div class="beam" id="beam"></div>
    <div class="orbit" id="orbitLayer"></div>
    <div class="photons" id="photonsLayer"></div>
    <div class="floor"></div>
    <div class="label-bottom">White = Stable • Red = Traveling • Rings vibrate constantly</div>
  </div>
</div>

<script>
(function(){
  const utcClock=document.getElementById("utcClock");
  const localClock=document.getElementById("localClock");
  const destClock=document.getElementById("destClock");
  const diffClock=document.getElementById("diffClock");
  const beam=document.getElementById("beam");
  const travelBtn=document.getElementById("travelBtn");
  const resetBtn=document.getElementById("resetBtn");
  const destDT=document.getElementById("destDT");
  const status=document.getElementById("status");
  const orbitLayer=document.getElementById("orbitLayer");
  const photonsLayer=document.getElementById("photonsLayer");

  let destination=null, traveling=false, startTime=0, travelDuration=7000;
  let initialDiff=0;

  // Build photons
  function buildPhotons(){
    photonsLayer.innerHTML="";
    for(let i=0;i<26;i++){
      const p=document.createElement("div");
      p.className="photon "+(i%2===0?"up":"down");
      p.style.left=(20+(i%13)*5)+"%";
      p.style.animationDelay=(-i*0.15)+"s";
      photonsLayer.appendChild(p);
    }
  }
  buildPhotons();

  // Build orbiting particles
  function buildParticles(){
    orbitLayer.innerHTML="";
    for(let i=0;i<22;i++){
      const d=document.createElement("div");
      d.className="particle";
      d.dataset.angle0=(i/22)*Math.PI*2;
      d.dataset.radius=40+(i%11)*8;
      orbitLayer.appendChild(d);
    }
  }
  buildParticles();

  travelBtn.onclick=()=>{
    if(!destDT.value){alert("Select destination date and time.");return;}
    destination=new Date(destDT.value);
    initialDiff=destination - new Date();
    if(isNaN(destination)){alert("Invalid date.");return;}
    traveling=true;
    startTime=performance.now();
    beam.style.background="radial-gradient(circle,var(--beam-color),transparent 70%)";
    document.documentElement.style.setProperty("--beam-color","rgba(255,80,80,0.9)");
    document.documentElement.style.setProperty("--intensity","1");
    status.innerHTML="<span style='color:#ff9090'>TRAVELING...</span>";
  };

  resetBtn.onclick=()=>{
    destination=null; traveling=false;
    document.documentElement.style.setProperty("--beam-color","rgba(180,240,255,0.8)");
    document.documentElement.style.setProperty("--intensity","0.3");
    status.textContent="Status: STABLE";
  };

  function fmt(t){return t.toString().padStart(2,"0");}
  function formatFull(d){
    return d.toLocaleDateString()+" "+fmt(d.getHours())+":"+fmt(d.getMinutes())+":"+fmt(d.getSeconds());
  }
  function formatDiff(ms){
    const sign=ms>=0?"+":"−";
    const abs=Math.abs(ms);
    const d=Math.floor(abs/86400000);
    const h=Math.floor((abs%86400000)/3600000);
    const m=Math.floor((abs%3600000)/60000);
    const s=Math.floor((abs%60000)/1000);
    return `${sign}${d}d ${fmt(h)}:${fmt(m)}:${fmt(s)}`;
  }

  function animateParticles(speed){
    const dots=orbitLayer.children;
    const tsec=performance.now()/1000;
    for(let i=0;i<dots.length;i++){
      const el=dots[i];
      const a0=Number(el.dataset.angle0);
      const r=Number(el.dataset.radius);
      const dir=i%2===0?1:-1;
      const ang=a0+dir*(tsec/speed)*Math.PI*2;
      const x=Math.cos(ang)*(r+180);
      const y=Math.sin(ang)*(r/2)*0.8;
      el.style.transform=`translate(${x}px,${y}px)`;
    }
  }

  function tick(){
    const now=new Date();
    utcClock.textContent=formatFull(new Date(now.toISOString())); // UTC string
    localClock.textContent=formatFull(now);

    if(destination){
      destClock.textContent=formatFull(destination);
      let diff=destination - now;
      if(traveling){
        const elapsed=performance.now()-startTime;
        const p=Math.min(elapsed/travelDuration,1);
        diff=initialDiff*(1-p);
        const r=Math.floor(255*(1-p)+200*p);
        const g=Math.floor(80+175*p);
        const b=Math.floor(80+175*p);
        document.documentElement.style.setProperty("--beam-color",`rgba(${r},${g},${b},0.9)`);
        document.documentElement.style.setProperty("--intensity",(1-p).toFixed(2));
        if(p>=1){
          traveling=false;
          status.innerHTML="<span style='color:#7cff9e'>ARRIVED — STABLE</span>";
          document.documentElement.style.setProperty("--beam-color","rgba(180,240,255,0.8)");
          document.documentElement.style.setProperty("--intensity","0.3");
        }
      }
      diffClock.textContent=formatDiff(diff);
    }else{
      destClock.textContent="--";
      diffClock.textContent="--";
    }

    animateParticles(traveling?1.5:6);
    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
})();
</script>
</body>
</html>
