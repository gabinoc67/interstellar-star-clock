<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cosmic Clock (Scaled to Fit)</title>
  <style>
    body { background:#0a0f1f; color:#fff; font-family:Arial; margin:0; display:flex; justify-content:center; align-items:center; height:100vh; }
    #container { display:flex; align-items:flex-start; gap:20px; }
    #infoPanel {
      width: 300px;
      text-align:left;
      margin-right:20px;
      font-size: 14px;
      line-height:1.5em;
    }
    #infoPanel h1 { color:gold; font-size:22px; margin-bottom:12px; }
    label, input, button { margin: 5px 0; font-size: 0.95em; }
    input { width: 95%; padding:5px; font-size:0.95em; }
    button {
      background: #2563eb; color: white; border: none; padding: 7px 14px;
      border-radius: 6px; cursor: pointer; font-size:0.95em;
    }
    button:hover { background: #1d4ed8; }
    canvas { background:#111; border:2px solid #333; }
    .note { font-size: 12px; color:#bbb; margin-top:8px; }
    #clocks { display:flex; flex-direction:row; gap:20px; }
  </style>
</head>
<body>
  <div id="container">
    <div id="infoPanel">
      <h1>ü™ê Cosmic Clock</h1>
      <label for="dateInput">Birthday:</label><br>
      <input type="date" id="dateInput" placeholder="mm/dd/yyyy"><br>
      <label for="latInput">Latitude (¬∞):</label><br>
      <input type="number" id="latInput" step="0.0001" placeholder="e.g. 34.05"><br>
      <label for="lonInput">Longitude (¬∞):</label><br>
      <input type="number" id="lonInput" step="0.0001" placeholder="e.g. -118.25"><br>
      <button onclick="startClock()">Start</button>
      <button onclick="resetClock()">Reset</button>
      <div id="output">Enter either a <b>Birthday</b> OR <b>Latitude/Longitude</b>.</div>
      <div class="note">‚ö†Ô∏è Antikythera-style mechanism.<br>
        Choose ONE mode:<br>
        ‚Äì Birthday ‚Üí Sun, Moon & calendars.<br>
        ‚Äì Latitude/Longitude ‚Üí sky alignment.<br>
        Using both is not possible.</div>
    </div>

    <!-- Top + Bottom clocks -->
    <div id="clocks">
      <canvas id="cosmicClock" width="550" height="550"></canvas>
      <canvas id="bottomClock" width="550" height="550"></canvas>
    </div>
  </div>

  <script>
    // ==== TOP CLOCK ====
    const canvas = document.getElementById("cosmicClock");
    const ctx = canvas.getContext("2d");
    const cx = canvas.width/2, cy = canvas.height/2;

    // üîΩ All radii reduced ~20% for better fit
    const plateR = 110, metonicR = 150, tepeR = 190, mayaR = 230, decanR = 270, chineseR = 310;
    let moonR = 80;

    const zeroEpoch = new Date(-3110, 7, 11);
    const cycles = { Sun:365, Moon:29.53 };

    let sunDial = { angle:0, target:0 };
    let moonDial = { angle:0, target:0 };
    let animating = false;

    const tepeSymbols = ["ü¶Ç","ü¶ä","ü¶Ö","üêÇ","üêç","üêá","üê∫","üêü","üê¶","ü¶å","ü¶É","üê¢"];
    const mayaSigns = ["üêä","üå¨Ô∏è","üåä","üî•","ü¶Ö","üêç","üåΩ","üê¢","üï∑Ô∏è","üêí",
                       "üêï","üåø","üåû","üåë","üåΩ","ü¶å","üå¥","ü¶Ç","üåï","üêü"];
    const zodiacSymbols = ["‚ôà","‚ôâ","‚ôä","‚ôã","‚ôå","‚ôç","‚ôé","‚ôè","‚ôê","‚ôë","‚ôí","‚ôì"];

    function parseLocalDate(input) {
      const [y, m, d] = input.split("-").map(Number);
      return new Date(y, m - 1, d);
    }

    function startClock(){
      let inputDate = document.getElementById("dateInput").value;
      let lonVal = document.getElementById("lonInput").value;

      if (inputDate && lonVal) {
        alert("‚ö†Ô∏è Please enter either Birthday OR Latitude/Longitude, not both.");
        return;
      }
      if (inputDate) {
        let gDate = parseLocalDate(inputDate);
        let daysSinceZero = Math.floor((gDate - zeroEpoch)/86400000);
        setTargets(daysSinceZero,0);
        animating = true; animate();
      }
      else if (lonVal) {
        let longitude = parseFloat(lonVal) || 0;
        let lonShift = -(longitude/360*2*Math.PI);
        setTargets(0,lonShift);
        animating = true; animate();
      }
    }

    function resetClock(){
      sunDial.angle=0; sunDial.target=0;
      moonDial.angle=0; moonDial.target=0;
      animating=false; draw();
    }

    function setTargets(daysSinceZero, lonShift=0){
      sunDial.target = ((daysSinceZero % cycles.Sun) / cycles.Sun)*2*Math.PI + lonShift;
      moonDial.target = ((daysSinceZero % cycles.Moon) / cycles.Moon)*2*Math.PI + lonShift;
    }

    function drawArrow(ctx,x1,y1,x2,y2,color){
      ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2);
      ctx.strokeStyle=color; ctx.lineWidth=2; ctx.stroke();
    }

    function drawTopClock(){
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // Moon Plate
      ctx.beginPath(); ctx.arc(cx,cy,moonR,0,Math.PI*2); ctx.strokeStyle="#666"; ctx.stroke();
      const phases=["üåë","üåí","üåì","üåî","üåï","üåñ","üåó","üåò"];
      phases.forEach((p,i)=>{
        let a=(i*(360/phases.length)-90)*Math.PI/180;
        ctx.font="14px Arial"; ctx.fillText(p,cx+(moonR+12)*Math.cos(a),cy+(moonR+12)*Math.sin(a));
      });

      // Zodiac
      zodiacSymbols.forEach((z,i)=>{
        let a=(i*(360/zodiacSymbols.length)-90)*Math.PI/180;
        ctx.fillStyle="violet"; ctx.font="16px Arial";
        ctx.fillText(z,cx+(metonicR-15)*Math.cos(a),cy+(metonicR-15)*Math.sin(a));
      });

      // Tepe
      tepeSymbols.forEach((t,i)=>{
        let a=(i*(360/tepeSymbols.length)-90)*Math.PI/180;
        ctx.fillStyle="cyan"; ctx.font="14px Arial";
        ctx.fillText(t,cx+(tepeR+12)*Math.cos(a),cy+(tepeR+12)*Math.sin(a));
      });

      // Maya
      mayaSigns.forEach((m,i)=>{
        let a=(i*(360/mayaSigns.length)-90)*Math.PI/180;
        ctx.fillStyle="lime"; ctx.font="13px Arial";
        ctx.fillText(m,cx+(mayaR+12)*Math.cos(a),cy+(mayaR+12)*Math.sin(a));
      });

      // Decans
      for(let i=0;i<36;i++){
        let a=(i*(360/36)-90)*Math.PI/180;
        ctx.fillStyle="red"; ctx.font="10px Arial";
        ctx.fillText(i+1,cx+(decanR+10)*Math.cos(a),cy+(decanR+10)*Math.sin(a));
      }

      // Chinese Mansions
      for(let i=0;i<28;i++){
        let a=(i*(360/28)-90)*Math.PI/180;
        ctx.fillStyle="yellow"; ctx.font="10px Arial";
        ctx.fillText(i+1,cx+(chineseR+10)*Math.cos(a),cy+(chineseR+10)*Math.sin(a));
      }

      // Dials
      drawArrow(ctx,cx,cy,cx+chineseR*Math.cos(sunDial.angle-Math.PI/2),cy+chineseR*Math.sin(sunDial.angle-Math.PI/2),"gold");
      drawArrow(ctx,cx,cy,cx+moonR*Math.cos(moonDial.angle-Math.PI/2),cy+moonR*Math.sin(moonDial.angle-Math.PI/2),"white");
    }

    // ==== BOTTOM CLOCK ====
    const bottomCanvas=document.getElementById("bottomClock");
    const bctx=bottomCanvas.getContext("2d");
    const bcx=bottomCanvas.width/2,bcy=bottomCanvas.height/2;

    const rings=[
      {r:80,label:"Metonic 19y",color:"orange"},
      {r:110,label:"Saros 18y+11d",color:"red"},
      {r:140,label:"Exeligmos 54y",color:"cyan"},
      {r:170,label:"Olympiad 4y",color:"blue"},
      {r:200,label:"Mesoamerican 52y",color:"yellow"},
      {r:230,label:"Native Agricultural",color:"green"}
    ];

    function drawBottomClock(){
      bctx.clearRect(0,0,bottomCanvas.width,bottomCanvas.height);
      rings.forEach(ring=>{
        bctx.beginPath(); bctx.arc(bcx,bcy,ring.r,0,Math.PI*2);
        bctx.strokeStyle=ring.color; bctx.stroke();
        bctx.fillStyle=ring.color; bctx.font="12px Arial";
        bctx.fillText(ring.label,bcx,bcy-ring.r-8);
      });
      let dx=bcx+rings[rings.length-1].r*Math.cos(moonDial.angle-Math.PI/2);
      let dy=bcy+rings[rings.length-1].r*Math.sin(moonDial.angle-Math.PI/2);
      drawArrow(bctx,bcx,bcy,dx,dy,"gold");
    }

    function draw(){ drawTopClock(); drawBottomClock(); }

    function animate(){ if(!animating) return; let still=false;
      let d1=sunDial.target-sunDial.angle; if(Math.abs(d1)>0.001){sunDial.angle+=d1*0.05; still=true;} else{sunDial.angle=sunDial.target;}
      let d2=moonDial.target-moonDial.angle; if(Math.abs(d2)>0.001){moonDial.angle+=d2*0.05; still=true;} else{moonDial.angle=moonDial.target;}
      draw(); if(still) requestAnimationFrame(animate); else animating=false;
    }

    draw();
  </script>
</body>
</html>
