<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>🪐 Cosmic Clock (Dual Panel)</title>
  <style>
    :root{ --gap:22px; }
    body{
      margin:0; background:#0a0f1f; color:#fff; font-family:Arial, Helvetica, sans-serif;
      min-height:100vh; display:flex; align-items:center; justify-content:center;
    }
    #container{
      display:flex; align-items:flex-start; justify-content:center; gap:var(--gap);
      padding:18px; max-width:calc(100vw - 18px); overflow:auto; flex-wrap:wrap;
    }

    /* Left control panel (~20% smaller) */
    #infoPanel{ width:340px; text-align:left; line-height:1.6em; transform:scale(0.8); transform-origin:top left; }
    #infoPanel h1{ color:gold; font-size:26px; margin:0 0 10px 0; }
    label{ display:block; margin:6px 0 2px; font-size:1em; }
    input{ width:95%; padding:6px; font-size:0.95em; border:1px solid #333; background:#0f172a; color:#e5e7eb; border-radius:6px; }
    .btnRow{ margin-top:8px; display:flex; gap:8px; }
    .btn{ background:#2563eb; color:#fff; border:none; border-radius:6px; cursor:pointer; padding:7px 14px; font-size:0.85em; }
    .btn:hover{ background:#1d4ed8; }
    #output{ font-size:0.95em; margin-top:10px; }
    .note{ font-size:0.95em; color:#bbb; margin-top:8px; }

    /* Right clocks column */
    #clocks{ display:flex; flex-direction:column; align-items:center; justify-content:center; gap:var(--gap); }

    /* Canvases (+30% from 550 → 715) */
    canvas{ background:#111; border:2px solid #333; display:block; }
    #cosmicClock, #bottomClock{ width:715px; height:715px; }
  </style>
</head>
<body>
  <div id="container">
    <!-- Left: controls -->
    <div id="infoPanel">
      <h1>🪐 Cosmic Clock</h1>

      <label for="dateInput">Birthday</label>
      <input type="date" id="dateInput" placeholder="mm/dd/yyyy" />

      <label for="latInput">Latitude (°)</label>
      <input type="number" id="latInput" step="0.0001" placeholder="e.g. 34.05" />

      <label for="lonInput">Longitude (°)</label>
      <input type="number" id="lonInput" step="0.0001" placeholder="e.g. -118.25" />

      <div class="btnRow">
        <button class="btn" onclick="startClock()">Start</button>
        <button class="btn" onclick="resetClock()">Reset</button>
      </div>

      <div id="output">Enter either a <b>Birthday</b> OR <b>Latitude/Longitude</b>.</div>
      <div class="note">
        ⚠️ Antikythera-style mechanism.<br>
        Choose ONE mode:<br>
        – Birthday → Sun, Moon & calendars.<br>
        – Latitude/Longitude → sky alignment.<br>
        Not both at once.
      </div>
    </div>

    <!-- Right: stacked clocks -->
    <div id="clocks">
      <canvas id="cosmicClock" width="715" height="715"></canvas>
      <canvas id="bottomClock" width="715" height="715"></canvas>
    </div>
  </div>

  <script>
    // Helpers (auto-fit geometry)
    function dims(canvas){
      const cx = canvas.width/2, cy = canvas.height/2;
      const rMax = Math.min(cx, cy) - 18;      // safety margin
      return { cx, cy, rMax };
    }
    function setTextCenter(ctx){ ctx.textAlign="center"; ctx.textBaseline="middle"; }

    // -------------------- TOP CLOCK --------------------
    const topCanvas = document.getElementById("cosmicClock");
    const tctx = topCanvas.getContext("2d");

    const tepeSymbols = ["🦂","🦊","🦅","🐂","🐍","🐇","🐺","🐟","🐦","🦌","🦃","🐢"];
    const mayaSigns  = ["🐊","🌬️","🌊","🔥","🦅","🐍","🌽","🐢","🕷️","🐒","🐕","🌿","🌞","🌑","🌽","🦌","🌴","🦂","🌕","🐟"];
    const zodiac     = ["♈","♉","♊","♋","♌","♍","♎","♏","♐","♑","♒","♓"];

    function drawCircle(ctx, cx, cy, r, color, lw=1){
      ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2);
      ctx.strokeStyle=color; ctx.lineWidth=lw; ctx.stroke();
      ctx.lineWidth=1;
    }

    function drawTopClock(){
      const {cx, cy, rMax} = dims(topCanvas);
      tctx.clearRect(0,0,topCanvas.width,topCanvas.height);
      setTextCenter(tctx);

      // Proportional radii (outer→inner all inside rMax)
      const R = {
        degRing:  0.96*rMax,  // degree ring (ticks & labels)
        mansions: 0.90*rMax,
        decans :  0.84*rMax,
        maya   :  0.78*rMax,
        tepe   :  0.72*rMax,
        zodiac :  0.61*rMax,
        metonic:  0.47*rMax,
        moonPh :  0.39*rMax
      };

      // Light guide rings so placement is obvious
      drawCircle(tctx, cx, cy, R.mansions, "#333");
      drawCircle(tctx, cx, cy, R.decans,   "#333");
      drawCircle(tctx, cx, cy, R.maya,     "#333");
      drawCircle(tctx, cx, cy, R.tepe,     "#333");
      drawCircle(tctx, cx, cy, R.zodiac,   "#333");
      drawCircle(tctx, cx, cy, R.metonic,  "#333");

      // Degree ring with 5° minor/30° major ticks + 0–330 labels
      tctx.strokeStyle="#666";
      drawCircle(tctx, cx, cy, R.degRing, "#444");
      for(let d=0; d<360; d+=5){
        const a=(d-90)*Math.PI/180;
        const isMajor = d%30===0;
        const len = isMajor ? 14 : 7;
        const x1 = cx + (R.degRing-len)*Math.cos(a);
        const y1 = cy + (R.degRing-len)*Math.sin(a);
        const x2 = cx + (R.degRing)*Math.cos(a);
        const y2 = cy + (R.degRing)*Math.sin(a);
        tctx.beginPath(); tctx.moveTo(x1,y1); tctx.lineTo(x2,y2); tctx.stroke();

        if(isMajor){
          tctx.fillStyle="#9aa7bd"; tctx.font="12px Arial";
          const lx = cx + (R.degRing-28)*Math.cos(a);
          const ly = cy + (R.degRing-28)*Math.sin(a);
          tctx.fillText(String(d), lx, ly);
        }
      }

      // Zodiac 12 signs (every 30°)
      tctx.fillStyle="violet"; tctx.font="22px Arial";
      zodiac.forEach((z,i)=>{
        const a=(i*30-90)*Math.PI/180;
        tctx.fillText(z, cx+R.zodiac*Math.cos(a), cy+R.zodiac*Math.sin(a));
      });

      // Metonic 19 ticks
      tctx.fillStyle="orange";
      for(let i=0;i<19;i++){
        const a=(i*(360/19)-90)*Math.PI/180;
        const x=cx+R.metonic*Math.cos(a), y=cy+R.metonic*Math.sin(a);
        tctx.fillRect(x-2,y-2,4,4);
      }

      // Göbekli Tepe (12)
      tctx.fillStyle="cyan"; tctx.font="18px Arial";
      tepeSymbols.forEach((s,i)=>{
        const a=(i*30-90)*Math.PI/180;
        tctx.fillText(s, cx+R.tepe*Math.cos(a), cy+R.tepe*Math.sin(a));
      });

      // Maya (20)
      tctx.fillStyle="lime"; tctx.font="16px Arial";
      mayaSigns.forEach((s,i)=>{
        const a=(i*(360/20)-90)*Math.PI/180;
        tctx.fillText(s, cx+R.maya*Math.cos(a), cy+R.maya*Math.sin(a));
      });

      // Decans (36)
      tctx.fillStyle="red"; tctx.font="13px Arial";
      for(let i=0;i<36;i++){
        const a=(i*10-90)*Math.PI/180;
        tctx.fillText(String(i+1), cx+R.decans*Math.cos(a), cy+R.decans*Math.sin(a));
      }

      // Chinese Mansions (28)
      tctx.fillStyle="yellow"; tctx.font="13px Arial";
      for(let i=0;i<28;i++){
        const a=(i*(360/28)-90)*Math.PI/180;
        tctx.fillText(String(i+1), cx+R.mansions*Math.cos(a), cy+R.mansions*Math.sin(a));
      }

      // Moon phases (cardinals)
      const phases=["🌑","🌓","🌕","🌗"];
      tctx.fillStyle="white"; tctx.font="18px Arial";
      phases.forEach((p,i)=>{
        const a=(i*90-90)*Math.PI/180;
        tctx.fillText(p, cx+R.moonPh*Math.cos(a), cy+R.moonPh*Math.sin(a));
      });

      // MAIN DIAL/HAND (points to 0°/top; rotate later as needed)
      tctx.beginPath();
      tctx.moveTo(cx,cy);
      tctx.lineTo(cx, cy - R.mansions);     // up to outer data rings
      tctx.strokeStyle="gold"; tctx.lineWidth=2; tctx.stroke();
      tctx.lineWidth=1;
      // hub
      tctx.beginPath(); tctx.arc(cx,cy,6,0,Math.PI*2); tctx.fillStyle="gold"; tctx.fill();
    }

    // -------------------- BOTTOM CLOCK --------------------
    const bottomCanvas = document.getElementById("bottomClock");
    const bctx = bottomCanvas.getContext("2d");

    const bottomRings = [
      {label:"Moon Cycle",          key:"moon",   color:"white",  divisions:8,  symbols:["🌑","🌒","🌓","🌔","🌕","🌖","🌗","🌘"]},
      {label:"Metonic 19y",         key:"meton",  color:"orange", divisions:19},
      {label:"Saros 18y+11d",       key:"saros",  color:"red",    divisions:18},
      {label:"Exeligmos 54y",       key:"exel",   color:"cyan",   divisions:54},
      {label:"Olympiad 4y",         key:"olymp",  color:"blue",   divisions:4},
      {label:"Mesoamerican 52y",    key:"meso",   color:"yellow", divisions:52},
      {label:"Native Agricultural", key:"farm",   color:"green",  divisions:12}
    ];

    function drawBottomClock(){
      const {cx, cy, rMax} = dims(bottomCanvas);
      bctx.clearRect(0,0,bottomCanvas.width,bottomCanvas.height);
      setTextCenter(bctx);

      // Proportional radii for 7 rings (inner → outer)
      const base = [0.20, 0.33, 0.46, 0.59, 0.72, 0.85, 0.98];
      bottomRings.forEach((ring, i)=>ring.r = base[i]*rMax);

      bottomRings.forEach((c)=>{
        // ring
        bctx.beginPath();
        bctx.arc(cx,cy,c.r,0,Math.PI*2);
        bctx.strokeStyle=c.color; bctx.stroke();

        // label
        bctx.fillStyle=c.color; bctx.font="15px Arial";
        bctx.fillText(c.label, cx, cy - c.r - 12);

        // divisions
        for(let i=0;i<c.divisions;i++){
          const a=(i*(360/c.divisions)-90)*Math.PI/180;
          const x=cx+c.r*Math.cos(a), y=cy+c.r*Math.sin(a);
          if(c.symbols){ bctx.fillText(c.symbols[i % c.symbols.length], x, y); }
          else{ bctx.fillRect(x-1,y-1,2,2); }
        }
      });

      // central hand to outermost ring
      bctx.beginPath();
      bctx.moveTo(cx,cy);
      bctx.lineTo(cx, cy - bottomRings[bottomRings.length-1].r);
      bctx.strokeStyle="yellow"; bctx.lineWidth=2; bctx.stroke();

      // hub
      bctx.beginPath(); bctx.arc(cx,cy,6,0,Math.PI*2); bctx.fillStyle="yellow"; bctx.fill();
    }

    // -------------------- Draw --------------------
    function draw(){ drawTopClock(); drawBottomClock(); }
    draw();

    // Hooks (ready for future dynamics)
    function startClock(){ draw(); }
    function resetClock(){ draw(); }
  </script>
</body>
</html>
