<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cosmic Clock (Multi-Calendar)</title>
  <style>
    body { background:#0a0f1f; color:#fff; font-family:Arial; margin:0; display:flex; justify-content:center; align-items:center; height:100vh; }
    #container { display:flex; align-items:center; }
    #infoPanel {
      width: 340px; /* 40% bigger */
      text-align:left;
      margin-right:30px;
      font-size: 18px; /* larger font */
      line-height:1.8em;
    }
    #infoPanel h1 { color:gold; font-size:26px; margin-bottom:12px; }
    label, input, button { margin: 6px 0; font-size: 1em; }
    input { width: 95%; padding:6px; font-size:1em; }
    button {
      background: #2563eb; color: white; border: none; padding: 8px 14px;
      border-radius: 8px; cursor: pointer; font-size:1em;
    }
    button:hover { background: #1d4ed8; }
    canvas { background:#111; border:2px solid #333; }
  </style>
</head>
<body>
  <div id="container">
    <div id="infoPanel">
      <h1>ü™ê Cosmic Clock</h1>
      <label for="dateInput">Birthday:</label><br>
      <input type="date" id="dateInput"><br>
      <button onclick="startClock()">Start</button>
      <button onclick="resetClock()">Reset</button>
      <div id="output">Enter a date to see cosmic alignment.</div>
    </div>
    <canvas id="cosmicClock" width="1250" height="1250"></canvas>
  </div>

  <script>
    const canvas = document.getElementById("cosmicClock");
    const ctx = canvas.getContext("2d");
    const cx = canvas.width/2, cy = canvas.height/2;

    const plateR = 280;
    const metonicR = 340;
    const tepeR = 390;
    const mayaR = 450;
    const decanR = 510;
    const chineseR = 580; 
    let moonR = 220;

    // Zero Epoch: 3111 BCE
    const zeroEpoch = new Date(-3110, 7, 11);

    const cycles = { Sun:365, Moon:29.53, Mercury:116, Venus:584, Mars:780, Jupiter:399, Saturn:378 };

    let hands = [
      {label:"Sun", cycle:"Sun", angle:0, target:0, color:"gold", r:100},
      {label:"Mercury", cycle:"Mercury", angle:0, target:0, color:"orange", r:140},
      {label:"Venus", cycle:"Venus", angle:0, target:0, color:"violet", r:160},
      {label:"Mars", cycle:"Mars", angle:0, target:0, color:"red", r:180},
      {label:"Jupiter", cycle:"Jupiter", angle:0, target:0, color:"cyan", r:200},
      {label:"Saturn", cycle:"Saturn", angle:0, target:0, color:"lightgreen", r:220}
    ];

    let moonDial = { angle:0, target:0 };
    let animating = false;

    // Compass heading
    let compassHeading = 0;
    const declination = 1.9; 
    if (window.DeviceOrientationEvent) {
      window.addEventListener("deviceorientationabsolute", (event) => {
        if (event.alpha !== null) {
          compassHeading = event.alpha + declination;
        }
      }, true);
    }

    function parseLocalDate(input) {
      const [y, m, d] = input.split("-").map(Number);
      return new Date(y, m - 1, d);
    }

    function startClock(){
      let input = document.getElementById("dateInput").value;
      if(!input) return;
      let gDate = parseLocalDate(input);

      let daysSinceZero = Math.floor((gDate - zeroEpoch)/86400000);
      let moonPhase = (daysSinceZero % cycles.Moon).toFixed(1);

      // derive simple calendar markers
      let metonicYear = (daysSinceZero % (19*365.25) / 365.25).toFixed(1);
      let tepeIndex = daysSinceZero % 12;
      let mayaIndex = daysSinceZero % 20;
      let decanIndex = daysSinceZero % 36;
      let chineseIndex = daysSinceZero % 28;

      document.getElementById("output").innerHTML =
        "Cosmic Date (52-Year Cycle): " + gDate.toDateString() + "<br>" +
        "üåô Moon phase: " + moonPhase + " days<br>" +
        "üìú Metonic Year: " + metonicYear + "<br>" +
        "ü¶ä Tepe Symbol: #" + (tepeIndex+1) + "<br>" +
        "üåΩ Maya Day: #" + (mayaIndex+1) + "<br>" +
        "üî¥ Decan: #" + (decanIndex+1) + "<br>" +
        "üü° Chinese Mansion: #" + (chineseIndex+1);

      setTargets(daysSinceZero);
      animating = true;
      animate();
    }

    function resetClock(){
      hands.forEach(h=>{ h.angle=0; h.target=0; });
      moonDial.angle = 0; moonDial.target=0;
      animating=false;
      document.getElementById("dateInput").value = "";
      document.getElementById("output").innerHTML = "Enter a date to see cosmic alignment.";
      draw();
    }

    function setTargets(daysSinceZero){
      let venusPhase = ((daysSinceZero % cycles.Venus) / cycles.Venus) * 2*Math.PI;
      let venusShift = -venusPhase;

      hands.forEach(h=>{
        let rawPhase = ((daysSinceZero % cycles[h.cycle]) / cycles[h.cycle]) * 2*Math.PI;
        h.target = (rawPhase + venusShift) - compassHeading*Math.PI/180;
      });

      let moonPhaseAngle = ((daysSinceZero % cycles.Moon) / cycles.Moon) * 2*Math.PI;
      moonDial.target = (moonPhaseAngle + venusShift) - compassHeading*Math.PI/180;
    }

    // plates unchanged from your version (metonic, tepe, maya, decans, chinese)...

    function drawMoonDial(){
      // extend to Chinese outer ring
      let dx=cx+chineseR*Math.cos(moonDial.angle-Math.PI/2);
      let dy=cy+chineseR*Math.sin(moonDial.angle-Math.PI/2);

      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(dx,dy);
      ctx.strokeStyle="silver"; ctx.lineWidth=4; ctx.stroke();

      // arrowhead at the tip
      let arrowSize=16;
      let angle=moonDial.angle-Math.PI/2;
      ctx.beginPath();
      ctx.moveTo(dx,dy);
      ctx.lineTo(dx - arrowSize*Math.cos(angle-Math.PI/6), dy - arrowSize*Math.sin(angle-Math.PI/6));
      ctx.lineTo(dx - arrowSize*Math.cos(angle+Math.PI/6), dy - arrowSize*Math.sin(angle+Math.PI/6));
      ctx.closePath();
      ctx.fillStyle="silver"; ctx.fill();

      // base circle
      ctx.beginPath();
      ctx.arc(cx,cy,8,0,Math.PI*2);
      ctx.fillStyle="silver"; ctx.fill();
    }

    // rest of draw() just calls all plates, dial, hands, compass...
  </script>
</body>
</html>
