<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Top Clock â€” Sun & Moon</title>
  <style>
    body { background:#0a0f1f; color:#fff; text-align:center; }
    canvas { background:#111; margin-top:20px; }
    h1 { color: gold; }
    label, input, button { margin: 10px; font-size: 1em; }
    button {
      background: #2563eb; color: white; border: none; padding: 6px 12px;
      border-radius: 6px; cursor: pointer;
    }
    button:hover { background: #1d4ed8; }
  </style>
</head>
<body>
  <h1>ðŸŒžðŸŒ™ Top Clock â€” Sun & Moon</h1>

  <label for="dateInput">Enter Your Birthday:</label>
  <input type="date" id="dateInput">
  <button onclick="setDate()">Align</button>

  <div id="output">Your cosmic alignment will appear here.</div>

  <canvas id="topClock" width="600" height="300"></canvas>

  <script>
    const canvas = document.getElementById("topClock");
    const ctx = canvas.getContext("2d");

    // Circles for Sun + Moon
    let circles = [
      {x:200, y:150, r:80, angle:0, color:"gold", label:"Sun (Year)"},
      {x:400, y:150, r:60, angle:0, color:"silver", label:"Moon (Month)"}
    ];

    // Current date (default today)
    let targetDate = new Date();

    function toCosmicDate(date) {
      let corrected = new Date(date);
      corrected.setDate(corrected.getDate() - 12); // subtract 12 days
      return corrected;
    }

    function setDate() {
      let input = document.getElementById("dateInput").value;
      if (!input) return;
      targetDate = new Date(input);

      let cosmic = toCosmicDate(targetDate);

      document.getElementById("output").innerHTML =
        "Gregorian Date: " + targetDate.toDateString() +
        "<br>Cosmic Date (â€“12 days): " + cosmic.toDateString();

      alignCircles(cosmic);
    }

    // Align circles for chosen date
    function alignCircles(date) {
      let startOfYear = new Date(date.getFullYear(), 0, 0);
      let dayOfYear = Math.floor((date - startOfYear) / 86400000);

      // Sun angle = day of year
      circles[0].angle = (dayOfYear / 365) * 2 * Math.PI;

      // Moon angle = days since Jan 1 mod lunar month
      let daysSince = Math.floor((date - new Date(2000,0,6)) / 86400000); // ref new moon 2000-01-06
      let moonPhaseDays = daysSince % 29.53;
      circles[1].angle = (moonPhaseDays / 29.53) * 2 * Math.PI;

      draw();
    }

    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);

      circles.forEach(c => {
        // Draw circle
        ctx.beginPath();
        ctx.arc(c.x, c.y, c.r, 0, Math.PI*2);
        ctx.strokeStyle="#555";
        ctx.stroke();

        // Draw moving dot
        let dx = c.x + c.r * Math.cos(c.angle);
        let dy = c.y + c.r * Math.sin(c.angle);
        ctx.beginPath();
        ctx.arc(dx,dy,8,0,Math.PI*2);
        ctx.fillStyle=c.color;
        ctx.fill();

        // Label
        ctx.fillStyle="white";
        ctx.font="14px Arial";
        ctx.fillText(c.label, c.x-40, c.y-c.r-15);
      });
    }

    // Start aligned to today
    alignCircles(toCosmicDate(new Date()));
  </script>
</body>
</html>
