<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CST Time & 30 Atomic-Clock Satellites ‚Äî Real-Time</title>
<style>
  :root{
    --bg:#0b1020; --panel:#111831; --ink:#eaf0ff; --muted:#a7b0c3;
    --gps:#34d399; --geo:#fbbf24; --accent:#5eead4; --danger:#ef4444; --ok:#22c55e;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:1200px;margin:auto;padding:20px;display:grid;gap:16px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
        border:1px solid rgba(255,255,255,.10);border-radius:16px;padding:16px}
  h1{margin:0 0 4px 0;font-size:20px}
  .muted{color:var(--muted)}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
  .row{display:grid;grid-template-columns:1.2fr 1fr;gap:16px}
  .kvs{display:grid;grid-template-columns:auto 1fr;gap:6px 12px;align-items:center}
  .big{font-size:28px;letter-spacing:.5px}
  .buttons{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  button{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.14);color:var(--ink);
         padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:600}
  button:hover{background:rgba(255,255,255,.12)}
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px 10px;border-bottom:1px solid rgba(255,255,255,.08);text-align:left;font-size:13px}
  thead th{position:sticky;top:0;background:rgba(17,24,49,.9);backdrop-filter:blur(6px)}
  .tag{display:inline-block;padding:.15rem .5rem;border-radius:999px;border:1px solid rgba(255,255,255,.15);font-size:11px}
  .tag-geo{border-color:#fbbf2480;color:#fbbf24}
  .tag-gps{border-color:#34d39980;color:#34d399}
  .status{font-weight:700}
  .ok{color:var(--ok)} .bad{color:var(--danger)}
  .scroll{max-height:480px;overflow:auto;border:1px solid rgba(255,255,255,.08);border-radius:12px}
  .explain li{margin:6px 0}
  .nowrap{white-space:nowrap}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>CST Time & 30 Atomic-Clock Satellites (Real-Time)</h1>
      <div class="muted">
        This demo sets <b>CST ‚â° UTC</b> as a universal cosmic baseline clock. Each satellite shows its
        <b>Atomic UTC</b> (baseline), <b>CST</b> (same as UTC in this baseline), and comparison clocks:
        <span class="tag tag-geo">GEO +45&nbsp;¬µs/day</span>,
        <span class="tag tag-gps">GPS +38&nbsp;¬µs/day (net)</span>.
        A simple 12-hour orbit model updates angle and sub-satellite longitude in real time.
      </div>
    </div>

    <div class="card">
      <div class="row">
        <div>
          <div class="muted">CST (demo baseline = UTC)</div>
          <div id="cstTime" class="big mono">--:--:--.---</div>
          <div class="muted mono" id="cstIso">‚Äî</div>
          <div class="kvs" style="margin-top:10px">
            <div>Elapsed since UTC midnight</div><div class="mono" id="sinceMid">‚Äî</div>
            <div>GEO phase rate</div><div class="mono">+45 ¬µs/day</div>
            <div>GPS phase rate (net)</div><div class="mono">+38 ¬µs/day</div>
            <div>Self-tests</div><div class="mono status" id="tests">(not run)</div>
          </div>
          <div class="buttons">
            <button id="pause">‚è∏ Pause</button>
            <button id="resume">‚ñ∂ Resume</button>
            <button id="reset">üîÑ Reset to now</button>
          </div>
        </div>
        <div class="explain">
          <div class="muted">Why a CST baseline helps</div>
          <ul>
            <li><b>Universal time anchor:</b> All nodes (satellites, ground, deep-space) reference the same cosmic clock (here we use UTC). Local gravity/motion effects become <i>phase terms</i> added to CST.</li>
            <li><b>Cleaner receiver math:</b> Phones derive precise time by comparing CST stamps + phase, rather than patching per-orbit corrections. Same logic works on Earth, Moon, or Mars.</li>
            <li><b>Signal consistency:</b> A CST timestamp in every signal means any receiver can align its local clock <i>and</i> position with fewer system-specific assumptions.</li>
            <li><b>Interoperability:</b> Multiple constellations can interoperate by agreeing on a baseline (CST) and publishing their phase models.</li>
          </ul>
          <div class="muted">Equations</div>
          <div class="mono" style="font-size:13px;line-height:1.5">
            Let Œît be seconds since UTC midnight.<br/>
            GEO phase (sec): œÜ<sub>GEO</sub>(Œît) = (45√ó10‚Åª‚Å∂) √ó (Œît/86400)<br/>
            GPS phase (sec): œÜ<sub>GPS</sub>(Œît) = (38√ó10‚Åª‚Å∂) √ó (Œît/86400)<br/>
            Adjusted: T<sub>GEO</sub> = T<sub>CST</sub> + œÜ<sub>GEO</sub>, T<sub>GPS</sub> = T<sub>CST</sub> + œÜ<sub>GPS</sub>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="muted" style="margin-bottom:8px">30 Satellites ‚Äî Atomic Clocks & Real-Time Adjusted Times</div>
      <div class="scroll">
        <table id="satTable" class="mono">
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Angle&nbsp;(¬∞)</th>
              <th>Sub-Lon&nbsp;(¬∞)</th>
              <th>Atomic&nbsp;UTC</th>
              <th>CST</th>
              <th>GEO&nbsp;(+45 ¬µs/day)</th>
              <th>GPS&nbsp;(+38 ¬µs/day)</th>
            </tr>
          </thead>
          <tbody id="satBody"></tbody>
        </table>
      </div>
      <div class="muted" style="margin-top:8px">
        <b>Note:</b> Orbits here are illustrative (12h period, evenly spaced phases). Real systems use ephemerides; this demo focuses on time standards & phase application.
      </div>
    </div>
  </div>

<script>
(function(){
  // ===== Config (change here to alter the model) =====
  const SAT_COUNT = 30;
  const ORBIT_PERIOD_SEC = 12*3600;     // 12 hours per orbit (typical GPS)
  const RATE_GEO_US_PER_DAY = 45;       // GEO comparison clock drift
  const RATE_GPS_US_PER_DAY = 38;       // GPS net drift
  const SECS_PER_DAY = 86400;

  // If you later define CST != UTC, change this function:
  function getCSTNowMs(){ return Date.now(); }  // CST ‚â° UTC baseline

  // ===== State & DOM =====
  let paused = false;
  let baseNow = () => getCSTNowMs();     // allows "reset to now" without reload

  const elCstTime = document.getElementById('cstTime');
  const elCstIso  = document.getElementById('cstIso');
  const elSince   = document.getElementById('sinceMid');
  const elTests   = document.getElementById('tests');
  const tbody     = document.getElementById('satBody');

  // Generate satellites with evenly spaced phase offsets
  const sats = Array.from({length: SAT_COUNT}, (_,i) => ({
    id: i+1,
    name: `SAT-${String(i+1).padStart(2,'0')}`,
    phaseSec: (i * ORBIT_PERIOD_SEC) / SAT_COUNT   // phase offset
  }));

  // Build table rows once
  function buildRows(){
    const frag = document.createDocumentFragment();
    for(const s of sats){
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="nowrap">${s.id}</td>
        <td>${s.name}</td>
        <td id="ang-${s.id}" class="nowrap">0.0</td>
        <td id="lon-${s.id}" class="nowrap">0.0</td>
        <td id="utc-${s.id}" class="nowrap">--:--:--.---</td>
        <td id="cst-${s.id}" class="nowrap">--:--:--.---</td>
        <td id="geo-${s.id}" class="nowrap">--:--:--.---</td>
        <td id="gps-${s.id}" class="nowrap">--:--:--.---</td>
      `;
      frag.appendChild(tr);
    }
    tbody.appendChild(frag);
  }

  // ===== Helpers =====
  function pad(n, w=2){ return n.toString().padStart(w,'0'); }
  function fmtHMSms(d){
    const hh = pad(d.getUTCHours());
    const mm = pad(d.getUTCMinutes());
    const ss = pad(d.getUTCSeconds());
    const ms = pad(d.getUTCMilliseconds(),3);
    return `${hh}:${mm}:${ss}.${ms}`;
  }
  function secondsSinceUtcMidnight(ms){
    const now = new Date(ms);
    const mid = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(), 0,0,0,0));
    return (now - mid)/1000;
  }
  function isoWithOffset(date, offsetSec){
    const ms = date.getTime() + offsetSec*1000;
    return new Date(ms).toISOString();
  }
  function phaseSecondsGeo(dt){ return (RATE_GEO_US_PER_DAY*1e-6) * (dt/SECS_PER_DAY); }
  function phaseSecondsGps(dt){ return (RATE_GPS_US_PER_DAY*1e-6) * (dt/SECS_PER_DAY); }

  // ===== Update Loop =====
  function tick(){
    if(!paused){
      const nowMs = baseNow();
      const now   = new Date(nowMs);

      // Top panel (CST baseline ‚â° UTC)
      elCstTime.textContent = fmtHMSms(now);
      elCstIso.textContent  = now.toISOString();
      const dt = secondsSinceUtcMidnight(nowMs);
      elSince.textContent = dt.toFixed(3) + ' s';

      // Precompute comparison phase offsets (seconds)
      const phiGeo = phaseSecondsGeo(dt);
      const phiGps = phaseSecondsGps(dt);

      // Update each satellite row
      for(const s of sats){
        // Orbit angle (0..360) with satellite-specific phase
        const tOrbit = (dt + s.phaseSec) % ORBIT_PERIOD_SEC;
        const angle  = (tOrbit / ORBIT_PERIOD_SEC) * 360;   // degrees
        const subLon = ((angle - 180 + 540) % 360) - 180;   // shift to [-180,180]

        const utcStr = fmtHMSms(now);
        const cstStr = utcStr;                              // CST == UTC baseline here
        const geoStr = fmtHMSms(new Date(nowMs + phiGeo*1000));
        const gpsStr = fmtHMSms(new Date(nowMs + phiGps*1000));

        document.getElementById(`ang-${s.id}`).textContent = angle.toFixed(1);
        document.getElementById(`lon-${s.id}`).textContent = subLon.toFixed(1);
        document.getElementById(`utc-${s.id}`).textContent = utcStr;
        document.getElementById(`cst-${s.id}`).textContent = cstStr;
        document.getElementById(`geo-${s.id}`).textContent = geoStr;
        document.getElementById(`gps-${s.id}`).textContent = gpsStr;
      }
    }
    requestAnimationFrame(tick);
  }

  // ===== Controls =====
  document.getElementById('pause').onclick  = () => { paused = true; };
  document.getElementById('resume').onclick = () => { paused = false; };
  document.getElementById('reset').onclick  = () => {
    const offset = getCSTNowMs() - baseNow(); // continuity
    baseNow = () => getCSTNowMs() - offset;
  };

  // ===== Self-tests =====
  function runTestsOnce(){
    let ok = true;
    try{
      // 30 rows exist
      ok = ok && (document.querySelectorAll('#satBody tr').length === SAT_COUNT);
      // A few cells are present
      ok = ok && !!document.getElementById('utc-1');
      ok = ok && !!document.getElementById('gps-30');
      // Times look like HH:MM:SS.mmm after first paint
      const pat = /^\d{2}:\d{2}:\d{2}\.\d{3}$/;
      ok = ok && pat.test(document.getElementById('cstTime').textContent);
    }catch(e){
      console.error('Self-tests error:', e);
      ok = false;
    }
    elTests.textContent = ok ? 'All tests passed' : 'Some tests failed';
    elTests.className = 'mono status ' + (ok ? 'ok' : 'bad');
    console.assert(ok, 'Self-tests should pass');
  }

  // Boot
  buildRows();
  // Paint once before tests
  (function firstPaint(){
    const nowMs = baseNow();
    const now   = new Date(nowMs);
    elCstTime.textContent = fmtHMSms(now);
    elCstIso.textContent  = now.toISOString();
  })();
  runTestsOnce();
  tick();
})();
</script>
</body>
</html>
