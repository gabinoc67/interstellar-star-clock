<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Planet Age Calculator</title>
  <style>
    :root{
      --bg:#0b0f14; --card:#121923; --muted:#95a3b3; --text:#e8eef6;
      --accent:#5aa9ff; --border:#1e2a38;
      --label:14px; --field:14px; --field-h:44px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:24px; min-height:100vh; color:var(--text);
      background: radial-gradient(900px 500px at 10% -10%, #112030 20%, transparent 55%),
                  radial-gradient(700px 400px at 90% 10%, #0f1a28 15%, transparent 60%),
                  var(--bg);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica,Arial;
    }
    h1{margin:0 0 16px; font-weight:700; letter-spacing:.2px}
    .subhead{margin:18px 0 8px; color:var(--muted); font-weight:600; letter-spacing:.2px}
    .wrap{max-width:1280px; margin:0 auto}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:16px; padding:18px;
      box-shadow:0 10px 24px rgba(0,0,0,.25);
    }

    /* Row 1 (date/time inputs) */
    .inputs-grid{
      display:grid;
      grid-template-columns: repeat(7, 1fr);
      gap:12px; align-items:end;
    }

    /* Row 2 (TZ | Lived | Actions | Cosmic Offset in SAME row) */
    .row-two{
      margin-top:12px;
      display:grid;
      grid-template-columns: 2fr 2fr auto 1fr; /* TZ | Lived | Actions | Offset */
      gap:12px; align-items:end;
    }
    .field{display:grid; gap:6px}
    .field label{font-size:var(--label); color:var(--muted); letter-spacing:.3px; line-height:1.2}
    .field input, .field select, .field button{
      width:100%; padding:10px 12px; background:#0e1520; color:var(--text);
      border:1px solid var(--border); border-radius:10px; outline:none;
      font-size:var(--field); height:var(--field-h);
    }
    .btn{cursor:pointer; font-weight:600}
    .btn-primary{background:linear-gradient(180deg,#2e6df6,#184dc4); border-color:#1b4bb4}
    .btn-reset{background:#1d2633; border-color:#2a3a52}

    /* Lived block (label above, value in a box) */
    .lived-wrap{display:grid; gap:6px}
    .lived-title{font-size:var(--label); color:var(--muted)}
    .lived-box{
      background:#0e1520; border:1px solid var(--border); border-radius:10px;
      padding:10px 12px; height:var(--field-h); font-size:var(--field);
      overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
      display:flex; align-items:center;
    }

    /* Row 3 (wide info strip under row 2) */
    .info-strip{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(4, 1fr); /* Now | Birth | Elapsed | Status */
      gap:12px; align-items:end;
    }
    .info-item{display:grid; gap:6px}
    .info-item label{font-size:var(--label); color:var(--muted)}
    .info-item input{font-size:var(--field); height:var(--field-h)}

    table{width:100%; border-collapse:collapse; margin-top:16px}
    thead th{
      text-align:left; font-weight:600; color:var(--muted);
      padding:10px 12px; border-bottom:1px solid var(--border);
    }
    tbody td{padding:12px; border-bottom:1px dashed var(--border)}
    tbody tr:last-child td{border-bottom:none}

    @media (max-width: 1100px){
      .row-two{ grid-template-columns: 1fr 1fr; }
      .info-strip{ grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 980px){
      .inputs-grid{ grid-template-columns: repeat(3, 1fr); }
    }
    @media (max-width: 560px){
      .inputs-grid{ grid-template-columns: 1fr; }
      .row-two{ grid-template-columns: 1fr; }
      .info-strip{ grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Planet Age Calculator</h1>
    <div class="card">

      <!-- Row 1: birth date/time -->
      <div class="inputs-grid" id="row1">
        <div class="field"><label for="year">Birth Year</label><select id="year"></select></div>
        <div class="field">
          <label for="month">Birth Month</label>
          <select id="month">
            <option value="1">January</option><option value="2">February</option>
            <option value="3">March</option><option value="4">April</option>
            <option value="5">May</option><option value="6">June</option>
            <option value="7">July</option><option value="8">August</option>
            <option value="9">September</option><option value="10">October</option>
            <option value="11">November</option><option value="12">December</option>
          </select>
        </div>
        <div class="field"><label for="day">Birth Day</label><select id="day"></select></div>
        <div class="field"><label for="hour">Hour</label><select id="hour"></select></div>
        <div class="field"><label for="minute">Minute</label><select id="minute"></select></div>
        <div class="field"><label for="second">Second</label><select id="second"></select></div>
        <div class="field">
          <label for="ampm">AM / PM</label>
          <select id="ampm"><option value="AM">AM</option><option value="PM">PM</option></select>
        </div>
      </div>

      <!-- Row 2: TZ | Lived | Actions | Cosmic Offset -->
      <div class="row-two" id="row2">
        <div class="field">
          <label for="tz">Birth Time Zone (fixed UTC offset)</label>
          <select id="tz">
            <optgroup label="Americas">
              <option value="-10">HST (UTC−10:00)</option>
              <option value="-9">AKST (UTC−09:00)</option>
              <option value="-8">PST (UTC−08:00)</option>
              <option value="-7">MST (UTC−07:00)</option>
              <option value="-6" selected>CST (UTC−06:00)</option>
              <option value="-5">EST (UTC−05:00)</option>
            </optgroup>
            <optgroup label="Europe/Africa">
              <option value="0">UTC±00:00</option>
              <option value="1">CET (UTC+01:00)</option>
              <option value="2">EET (UTC+02:00)</option>
              <option value="3">MSK (UTC+03:00)</option>
            </optgroup>
            <optgroup label="Asia/Oceania">
              <option value="5.5">IST (UTC+05:30)</option>
              <option value="8">China (UTC+08:00)</option>
              <option value="9">JST (UTC+09:00)</option>
              <option value="10">AEST (UTC+10:00)</option>
            </optgroup>
          </select>
          <div class="hint">Pick the offset that applied at your birthplace on that date (DST not auto-detected).</div>
        </div>

        <div class="lived-wrap">
          <span class="lived-title">How many I have lived</span>
          <span class="lived-box" id="livedInline">I have lived —</span>
        </div>

        <div class="field">
          <label>Actions</label>
          <div style="display:flex; gap:8px;">
            <button class="btn btn-primary" id="calcBtn">Calculate</button>
            <button class="btn btn-reset" id="resetBtn">Reset</button>
          </div>
        </div>

        <div class="field">
          <label for="cosmicOffset">Cosmic Offset (days)</label>
          <input id="cosmicOffset" type="number" step="0.001" value="12" />
        </div>
      </div>

      <!-- Row 3: wide info strip -->
      <div class="info-strip" id="infoStrip">
        <div class="info-item">
          <label for="nowDisplay">Now (UTC)</label>
          <input id="nowDisplay" type="text" readonly />
        </div>
        <div class="info-item">
          <label for="birthDisplay">Birth (UTC)</label>
          <input id="birthDisplay" type="text" readonly />
        </div>
        <div class="info-item">
          <label for="elapsedDisplay">Elapsed Time</label>
          <input id="elapsedDisplay" type="text" readonly />
        </div>
        <div class="info-item">
          <label for="statusDisplay">Status</label>
          <input id="statusDisplay" type="text" readonly />
        </div>
      </div>

      <!-- Results: Astronomical -->
      <div class="subhead">Astronomical Ages (no offset)</div>
      <table id="resultsTable">
        <thead>
          <tr>
            <th>Planet</th>
            <th>Orbital Period (Earth days)</th>
            <th>Your Age on Planet (years)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <!-- Results: Cosmic-Corrected -->
      <div class="subhead">Cosmic-Corrected Ages (elapsed − offset)</div>
      <table id="resultsTableCosmic">
        <thead>
          <tr>
            <th>Planet</th>
            <th>Orbital Period (Earth days)</th>
            <th>Your Age on Planet (years, Cosmic-Corrected)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="status" id="footnote" style="margin-top:10px; color:var(--muted);">
        Years list auto-updates each January 1. Orbital periods use mean sidereal values.
        Cosmic mode subtracts a configurable day-offset (default 12) from elapsed time.
      </div>
    </div>
  </div>

  <script>
    const PLANETS = [
      { name: 'Mercury', days: 87.969 },
      { name: 'Venus',   days: 224.701 },
      { name: 'Earth',   days: 365.256 },   // sidereal Earth year for consistency
      { name: 'Mars',    days: 686.980 },
      { name: 'Jupiter', days: 4332.589 },
      { name: 'Saturn',  days: 10759.22 },
      { name: 'Uranus',  days: 30685.4 },
      { name: 'Neptune', days: 60190.03 },
      { name: 'Pluto',   days: 90560 }
    ];

    const yearSel   = document.getElementById('year');
    const monthSel  = document.getElementById('month');
    const daySel    = document.getElementById('day');
    const hourSel   = document.getElementById('hour');
    const minuteSel = document.getElementById('minute');
    const secondSel = document.getElementById('second');
    const ampmSel   = document.getElementById('ampm');
    const tzSel     = document.getElementById('tz');

    const nowDisplay     = document.getElementById('nowDisplay');
    const birthDisplay   = document.getElementById('birthDisplay');
    const elapsedDisplay = document.getElementById('elapsedDisplay');
    const statusDisplay  = document.getElementById('statusDisplay');
    const livedInline    = document.getElementById('livedInline');

    const cosmicOffsetInput = document.getElementById('cosmicOffset');

    const resultsBody       = document.querySelector('#resultsTable tbody');
    const resultsBodyCosmic = document.querySelector('#resultsTableCosmic tbody');

    const pad = n => String(n).padStart(2,'0');

    function populateYears(){
      const now = new Date();
      const currentYear = now.getUTCFullYear();
      const prevValue = yearSel.value || '';
      yearSel.innerHTML = '';
      for (let y=1900; y<=currentYear; y++){
        const opt = document.createElement('option');
        opt.value = String(y); opt.textContent = String(y);
        yearSel.appendChild(opt);
      }
      if (prevValue && +prevValue >= 1900 && +prevValue <= currentYear){
        yearSel.value = prevValue;
      } else {
        yearSel.value = String(currentYear - 20);
      }
    }

    function populateDays(){
      const y = parseInt(yearSel.value,10);
      const m = parseInt(monthSel.value,10);
      const daysInMonth = new Date(y, m, 0).getDate();
      const prev = daySel.value || '1';
      daySel.innerHTML = '';
      for (let d=1; d<=daysInMonth; d++){
        const opt = document.createElement('option');
        opt.value = String(d); opt.textContent = String(d).padStart(2,'0');
        daySel.appendChild(opt);
      }
      daySel.value = String(Math.min(parseInt(prev,10)||1, daysInMonth));
    }

    function populateTime(){
      hourSel.innerHTML = '';
      for (let h=1; h<=12; h++){
        const opt = document.createElement('option');
        opt.value = String(h);
        opt.textContent = pad(h);
        hourSel.appendChild(opt);
      }
      minuteSel.innerHTML = '';
      secondSel.innerHTML = '';
      for (let m=0; m<60; m++){
        const optM = document.createElement('option');
        optM.value = String(m);
        optM.textContent = pad(m);
        minuteSel.appendChild(optM);

        const optS = document.createElement('option');
        optS.value = String(m);
        optS.textContent = pad(m);
        secondSel.appendChild(optS);
      }
      hourSel.value = '12';
      minuteSel.value = '00';
      secondSel.value = '00';
      ampmSel.value  = 'AM';
    }

    function birthToUTC(){
      const y  = parseInt(yearSel.value,10);
      const mo = parseInt(monthSel.value,10);
      const d  = parseInt(daySel.value,10);
      let h    = parseInt(hourSel.value,10) % 12;
      const min = parseInt(minuteSel.value,10);
      const sec = parseInt(secondSel.value,10);
      if (ampmSel.value === 'PM') h += 12;
      const offsetHours = parseFloat(tzSel.value);
      const utcMillis = Date.UTC(y, mo-1, d, h - offsetHours, min, sec);
      return new Date(utcMillis);
    }

    const fmtUTC = dt => dt.toISOString().replace('T',' ').replace('Z',' UTC');

    function fmtElapsed(ms){
      const secAll = Math.floor(ms/1000);
      const days = Math.floor(secAll/86400);
      const years = (days / 365.2425).toFixed(6);
      return `${String(days)} days (~${years} Earth years)`;
    }
    function fmtElapsedDHMS(ms){
      const totalSec = Math.max(0, Math.floor(ms/1000));
      const days = Math.floor(totalSec / 86400);
      let rem = totalSec % 86400;
      const hours = Math.floor(rem / 3600);
      rem %= 3600;
      const minutes = Math.floor(rem / 60);
      const seconds = rem % 60;
      return `I have lived ${days} days ${hours} hours ${minutes} minutes ${seconds} seconds`;
    }

    function calculate(){
      try{
        const birthUTC = birthToUTC();
        const now = new Date();
        const nowUTC = new Date(now.getTime() + now.getTimezoneOffset()*60000);

        if (isNaN(birthUTC.getTime())) throw new Error('Invalid birth date/time.');
        if (birthUTC > nowUTC) throw new Error('Birth moment is in the future.');

        nowDisplay.value = fmtUTC(nowUTC);
        birthDisplay.value = fmtUTC(birthUTC);

        // Raw astronomical elapsed time
        const elapsedMs = nowUTC - birthUTC;
        elapsedDisplay.value = fmtElapsed(elapsedMs);
        livedInline.textContent = fmtElapsedDHMS(elapsedMs);
        statusDisplay.value = 'OK';

        // Clear tables
        resultsBody.innerHTML = '';
        resultsBodyCosmic.innerHTML = '';

        // Convert to days
        const elapsedDays = elapsedMs / 86400000;

        // COSMIC offset (days); allow negative/zero; clamp so we never go < 0 days lived
        const offsetDays = parseFloat(cosmicOffsetInput.value || '0');
        const cosmicDays = Math.max(0, elapsedDays - offsetDays);

        // Fill Astronomical table
        PLANETS.forEach(p=>{
          const planetYears = elapsedDays / p.days;
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${p.name}</td>
                          <td>${p.days.toLocaleString(undefined,{maximumFractionDigits:3})}</td>
                          <td>${planetYears.toFixed(6)}</td>`;
          resultsBody.appendChild(tr);
        });

        // Fill Cosmic-corrected table
        PLANETS.forEach(p=>{
          const planetYearsCosmic = cosmicDays / p.days;
          const trC = document.createElement('tr');
          trC.innerHTML = `<td>${p.name}</td>
                           <td>${p.days.toLocaleString(undefined,{maximumFractionDigits:3})}</td>
                           <td>${planetYearsCosmic.toFixed(6)}</td>`;
          resultsBodyCosmic.appendChild(trC);
        });

      }catch(err){
        statusDisplay.value = 'Error: ' + err.message;
        livedInline.textContent = 'I have lived —';
        resultsBody.innerHTML = '';
        resultsBodyCosmic.innerHTML = '';
      }
    }

    function resetAll(){
      yearSel.value = '1900';
      monthSel.value = '1';
      populateDays();
      daySel.value = '1';
      ampmSel.value = 'AM';
      hourSel.value = '1';
      minuteSel.value = '1';
      secondSel.value = '0';
      tzSel.value = '-6';
      cosmicOffsetInput.value = '12';

      nowDisplay.value = '';
      birthDisplay.value = '';
      elapsedDisplay.value = '';
      statusDisplay.value = '';
      livedInline.textContent = 'I have lived —';
      resultsBody.innerHTML = '';
      resultsBodyCosmic.innerHTML = '';
    }

    populateYears(); populateDays(); populateTime();
    yearSel.addEventListener('change', populateDays);
    monthSel.addEventListener('change', populateDays);
    document.getElementById('calcBtn').addEventListener('click', calculate);
    document.getElementById('resetBtn').addEventListener('click', resetAll);

    (function tickOnce(){
      const now = new Date();
      const nowUTC = new Date(now.getTime() + now.getTimezoneOffset()*60000);
      nowDisplay.value = fmtUTC(nowUTC);
    })();

    (function scheduleYearRefresh(){
      const refresh = () => {
        const before = yearSel.options.length;
        const prev = yearSel.value;
        populateYears();
        if ([...yearSel.options].some(o=>o.value===prev)) yearSel.value = prev;
        if (yearSel.options.length !== before) populateDays();
      };
      setInterval(refresh, 24*3600*1000);
    })();

    resetAll();
  </script>
</body>
</html>
