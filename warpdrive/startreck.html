<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LCARS Warp Console (Single‑File, Offline)</title>
  <style>
    :root{
      --bg:#0b0c10; /* space black */
      --fg:#e8e6e3; /* warm white */
      --lcars-1:#ff9e4a; --lcars-2:#f26d7d; --lcars-3:#6dc5d1; --lcars-4:#b9e769; --lcars-5:#cba6f7;
      --panel:#151821; --muted:#a7aab3; --ok:#39d98a; --warn:#ffd166; --err:#ff5d5d;
      --accent:#58a6ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .app{display:grid;grid-template-columns:260px 1fr;grid-template-rows:auto 1fr;min-height:100vh}
    header{grid-column:1/3;display:flex;align-items:center;gap:14px;padding:14px 16px;background:linear-gradient(90deg,var(--lcars-1),var(--lcars-2));position:sticky;top:0;z-index:10}
    header h1{margin:0;font-size:20px;letter-spacing:.08em;text-transform:uppercase}
    header .chip{margin-left:auto;background:#00000030;border:1px solid #00000050;padding:6px 10px;border-radius:999px}
    nav{padding:16px;background:var(--panel);border-right:2px solid #00000040;position:sticky;top:56px;height:calc(100vh - 56px);overflow:auto}
    nav .btn{display:block;margin:8px 0;padding:10px 12px;border-radius:18px;border:none;color:#000;background:var(--lcars-3);font-weight:700;text-align:left;cursor:pointer}
    nav .btn.secondary{background:var(--lcars-5)}
    nav .btn.ghost{background:#00000020;color:var(--fg);font-weight:600}
    nav .group{margin:18px 0 8px;color:var(--muted);font-weight:700;letter-spacing:.08em;text-transform:uppercase;font-size:12px}
    main{padding:18px;overflow:auto}

    /* LCARS cards */
    .card{background:var(--panel);border:1px solid #ffffff14;border-radius:22px;padding:16px;margin:0 0 16px 0;box-shadow:0 8px 20px #00000050}
    .row{display:grid;gap:16px}
    .row.cols-2{grid-template-columns:1fr 1fr}
    .row.cols-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:980px){.app{grid-template-columns:1fr}.row.cols-2,.row.cols-3{grid-template-columns:1fr}}

    h2{margin:6px 0 10px;font-size:18px;letter-spacing:.06em;text-transform:uppercase}
    h3{margin:8px 0 8px;font-size:16px}
    .muted{color:var(--muted)}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#ffffff12;border:1px solid #ffffff28;font-size:12px}
    .tag{display:inline-block;margin:2px 6px 2px 0;padding:5px 8px;border-radius:999px;background:#ffffff12;border:1px solid #ffffff28;font-size:12px}

    /* meters */
    .meter{height:12px;background:#ffffff12;border:1px solid #ffffff28;border-radius:999px;overflow:hidden}
    .meter>span{display:block;height:100%;background:linear-gradient(90deg,var(--lcars-3),var(--lcars-1))}

    /* forms */
    label{display:block;font-weight:700;margin:10px 0 6px}
    input,select,textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #ffffff30;background:#0f121a;color:var(--fg)}
    input[type="number"]{appearance:textfield}
    button{cursor:pointer}
    .btn{padding:10px 14px;border-radius:12px;border:1px solid #ffffff28;background:#ffffff14;color:var(--fg)}
    .btn.primary{background:var(--lcars-1);color:#000;font-weight:800}
    .btn.good{background:var(--ok);color:#000;font-weight:800}
    .btn.warn{background:var(--warn);color:#000;font-weight:800}

    /* table */
    table{width:100%;border-collapse:separate;border-spacing:0 8px}
    th,td{text-align:left;padding:10px 12px;background:#0f121a;border:1px solid #ffffff20}
    th{background:#171b26}
    td:first-child,th:first-child{border-top-left-radius:12px;border-bottom-left-radius:12px}
    td:last-child,th:last-child{border-top-right-radius:12px;border-bottom-right-radius:12px}

    /* starfield */
    #starfield{position:fixed;inset:0;z-index:-1;opacity:0.45}

    /* footer */
    footer{margin:40px 0 20px;color:#7d818c;text-align:center}

    /* modal */
    dialog{border:none;border-radius:18px;padding:0;background:transparent}
    .modal{background:var(--panel);border:1px solid #ffffff20;border-radius:18px;padding:16px;min-width:min(720px,96vw)}
    .modal header{position:unset;background:none;display:flex;gap:10px;padding:0;margin:0}
  </style>
</head>
<body>
  <canvas id="starfield"></canvas>
  <div class="app">
    <header>
      <h1>LCARS Warp Console</h1>
      <span class="pill">Single‑file • Offline • No servers</span>
      <span class="chip" id="statusChip">Data: volatile</span>
    </header>

    <nav>
      <div class="group">sections</div>
      <button class="btn" data-goto="#overview">Overview</button>
      <button class="btn" data-goto="#theory">Warp Theory</button>
      <button class="btn" data-goto="#calc">Performance Calculator</button>
      <button class="btn" data-goto="#designs">Drive Concepts</button>
      <button class="btn" data-goto="#sources">Sources & Notes</button>
      <button class="btn secondary" id="openEditor">Quick Editor</button>
      <div class="group">data</div>
      <button class="btn ghost" id="seedDemo">Load Demo</button>
      <button class="btn ghost" id="saveData">Save to file</button>
      <input id="loadFile" type="file" accept="application/json" style="display:none" />
      <button class="btn ghost" id="loadData">Load from file</button>
      <button class="btn ghost" id="clearData">Reset</button>
      <div class="group">display</div>
      <button class="btn ghost" id="print">Print / PDF</button>
    </nav>

    <main>
      <section id="overview" class="card">
        <h2>Overview</h2>
        <p class="muted">A Star Trek–inspired LCARS console for compiling research on warp/FTL concepts and running simple estimates — all in a single HTML file. No network calls, no backend. Your inputs stay in your browser (localStorage / downloadable JSON).</p>
        <div class="row cols-3">
          <div class="card">
            <h3>Mission</h3>
            <p id="mission">Show a credible path to <b>0.28c</b> (28% of light speed) with intermediate milestones, while tracking feasibility across theory, energy, engineering, and materials.</p>
            <div class="meter"><span id="readinessBar" style="width:12%"></span></div>
            <small class="muted">Overall readiness (weighted)</small>
          </div>
          <div class="card">
            <h3>Key Milestones</h3>
            <ul id="milestones" style="margin:0;padding-left:18px">
              <li>Demonstrate sustained fusion+electric propulsion at ≥0.01c equivalent Δv</li>
              <li>Validate lab‑scale spacetime metric engineering signatures</li>
              <li>Closed-loop power at MW‑GW for deep‑space propulsion</li>
            </ul>
          </div>
          <div class="card">
            <h3>Quick Facts</h3>
            <div class="row">
              <span class="tag">c = 299,792,458 m/s</span>
              <span class="tag">1 ly ≈ 9.461e12 km</span>
              <span class="tag">1 AU ≈ 1.496e8 km</span>
              <span class="tag">Warp (TNG approx): v ≈ W^(10/3)·c</span>
            </div>
          </div>
        </div>
      </section>

      <section id="theory" class="card">
        <h2>Warp Theory</h2>
        <p class="muted">Summaries you compile from papers, articles, and lectures. Use the Quick Editor or the Sources table to add items. You can tag items (e.g., Alcubierre, Negative Energy, QI, Casimir, Metric Engineering).</p>
        <div id="theoryList"></div>
      </section>

      <section id="calc" class="card">
        <h2>Performance Calculator</h2>
        <div class="row cols-2">
          <div class="card">
            <h3>Sublight (fraction of c)</h3>
            <label>Target speed (% of c)</label>
            <input id="pctC" type="number" value="28" min="0" max="99.999" step="0.001" />
            <label>Trip distance</label>
            <div class="row">
              <input id="distVal" type="number" value="4.367" step="0.001" />
              <select id="distUnit">
                <option value="ly">light‑years</option>
                <option value="au">AU</option>
                <option value="km">km</option>
              </select>
            </div>
            <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
              <button class="btn primary" id="calcSublight">Compute</button>
              <span id="subResult" class="pill">—</span>
            </div>
            <small class="muted">Ignores relativistic time dilation for simplicity (add with “Relativistic mode”).</small>
            <div style="margin-top:10px">
              <label><input type="checkbox" id="relMode" /> Relativistic mode (γ and ship time)</label>
            </div>
          </div>
          <div class="card">
            <h3>FTL (Warp scale, TNG approximation)</h3>
            <label>Warp factor (≥1 for FTL)</label>
            <input id="warpFactor" type="number" value="1.2" min="1" step="0.01" />
            <label>Trip distance (ly)</label>
            <input id="warpDist" type="number" value="4.367" step="0.001" />
            <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
              <button class="btn primary" id="calcWarp">Compute</button>
              <span id="warpResult" class="pill">—</span>
            </div>
            <small class="muted">TNG fan scale: v ≈ W^(10/3)·c until ~Warp 9; this is a convenience estimate only.</small>
          </div>
        </div>
      </section>

      <section id="designs" class="card">
        <h2>Drive Concepts</h2>
        <div class="row cols-3" id="designGrid"></div>
      </section>

      <section id="sources" class="card">
        <h2>Sources & Notes</h2>
        <p class="muted">Add items with title, URL (optional), tags, and your summary. Everything is stored locally. Export/Import to move between machines.</p>
        <div class="row cols-2">
          <div class="card">
            <label>Title</label>
            <input id="srcTitle" placeholder="e.g., Alcubierre (1994)" />
            <label>URL (optional, kept local)</label>
            <input id="srcUrl" placeholder="https://..." />
            <label>Tags (comma‑sep)</label>
            <input id="srcTags" placeholder="warp, negative energy, casimir" />
            <label>Summary / key takeaways</label>
            <textarea id="srcSummary" rows="6" placeholder="Your distilled notes…"></textarea>
            <div style="margin-top:10px;display:flex;gap:10px;align-items:center">
              <button class="btn good" id="addSource">Add</button>
              <button class="btn warn" id="clearForm">Clear</button>
            </div>
          </div>
          <div class="card">
            <table>
              <thead>
                <tr><th>Title</th><th>Tags</th><th>Notes</th><th>Link</th><th></th></tr>
              </thead>
              <tbody id="srcTable"></tbody>
            </table>
          </div>
        </div>
      </section>

      <footer>
        <p>⚠️ This console is an educational sandbox. It does <i>not</i> prove feasibility. Numbers are back‑of‑envelope; always verify with primary literature.</p>
      </footer>
    </main>
  </div>

  <dialog id="editorDlg">
    <div class="modal">
      <header>
        <h3 style="margin:0">Quick Editor</h3>
        <div style="margin-left:auto"></div>
        <button class="btn" id="closeEditor">Close</button>
      </header>
      <div class="row cols-2">
        <div class="card">
          <h3>Theory Items</h3>
          <div class="row">
            <input id="thTitle" placeholder="Title" />
            <input id="thTags" placeholder="Tags (comma)" />
          </div>
          <textarea id="thBody" rows="8" placeholder="Bullet notes or a short summary"></textarea>
          <button class="btn good" id="addTheory">Add to Theory</button>
          <div id="theoryPreview" style="margin-top:10px"></div>
        </div>
        <div class="card">
          <h3>Feasibility Weights</h3>
          <p class="muted">Adjust perceived readiness (0–100) for each domain. The Overview bar is the weighted average.</p>
          <label>Theory</label>
          <input type="range" id="wTheory" min="0" max="100" value="15" />
          <label>Energy</label>
          <input type="range" id="wEnergy" min="0" max="100" value="8" />
          <label>Engineering</label>
          <input type="range" id="wEng" min="0" max="100" value="12" />
          <label>Materials</label>
          <input type="range" id="wMat" min="0" max="100" value="10" />
          <div class="row">
            <button class="btn primary" id="applyWeights">Apply</button>
            <span class="pill" id="weightsReadout">T15 • E8 • Eng12 • M10</span>
          </div>
        </div>
      </div>
    </div>
  </dialog>

  <script>
  /***** Persistence *****/
  const KEY = 'warpConsoleData.v1';
  const $ = (sel, el=document) => el.querySelector(sel);
  const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
  const state = {
    theory: [],
    sources: [],
    weights: {theory:15, energy:8, eng:12, mat:10}
  };

  function load(){
    try{
      const raw = localStorage.getItem(KEY);
      if(raw){ Object.assign(state, JSON.parse(raw)); $('#statusChip').textContent = 'Data: localStorage'; }
      render();
    }catch(e){ console.warn(e); }
  }
  function save(){ localStorage.setItem(KEY, JSON.stringify(state)); $('#statusChip').textContent = 'Data: localStorage'; }
  function reset(){ localStorage.removeItem(KEY); Object.assign(state,{theory:[],sources:[],weights:{theory:15,energy:8,eng:12,mat:10}}); render(); $('#statusChip').textContent='Data: reset'; }

  /***** Rendering *****/
  function render(){
    // Theory list
    const tl = $('#theoryList');
    tl.innerHTML = '';
    if(state.theory.length===0){ tl.innerHTML = '<p class="muted">No items yet. Open the Quick Editor to add your first theory summary.</p>'; }
    state.theory.forEach((t,i)=>{
      const div = document.createElement('div');
      div.className='card';
      div.innerHTML = `<h3>${esc(t.title)} <span class="tag">${esc(t.tags||'')}</span></h3><p>${nl2br(esc(t.body))}</p><div style="display:flex;gap:6px"><button class="btn" data-del-theory="${i}">Delete</button></div>`;
      tl.appendChild(div);
    });

    // Sources table
    const tb = $('#srcTable');
    tb.innerHTML = '';
    state.sources.forEach((s,i)=>{
      const tr = document.createElement('tr');
      const linkCell = s.url? `<a href="${esc(s.url)}" target="_blank" rel="noopener">open</a>` : '<span class="muted">—</span>';
      tr.innerHTML = `<td>${esc(s.title)}</td><td>${(s.tags||[]).map(x=>`<span class='tag'>${esc(x)}</span>`).join('')}</td><td>${esc(s.summary)}</td><td>${linkCell}</td><td><button class="btn" data-del-src="${i}">Delete</button></td>`;
      tb.appendChild(tr);
    });

    // Design cards (derived from sources tagged 'concept')
    const grid = $('#designGrid'); grid.innerHTML='';
    const concepts = state.sources.filter(s=> (s.tags||[]).map(x=>x.toLowerCase().trim()).includes('concept'));
    if(concepts.length===0){ grid.innerHTML = '<div class="card"><p class="muted">Add source items with the <b>concept</b> tag to populate this grid (e.g., Alcubierre warp, Natário bubble, QI thrust, beamed propulsion).</p></div>'; }
    concepts.forEach(s=>{
      const d = document.createElement('div'); d.className='card';
      d.innerHTML = `<h3>${esc(s.title)}</h3><p>${esc(s.summary)}</p><div class="row"><span class="tag">${(s.tags||[]).join('</span><span class="tag">')}</span></div>`;
      grid.appendChild(d);
    });

    // Weights readout + readiness
    $('#weightsReadout').textContent = `T${state.weights.theory} • E${state.weights.energy} • Eng${state.weights.eng} • M${state.weights.mat}`;
    const readiness = clamp((state.weights.theory + state.weights.energy + state.weights.eng + state.weights.mat)/4, 0, 100);
    $('#readinessBar').style.width = readiness + '%';
  }

  /***** Utilities *****/
  const esc = s=> String(s).replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]));
  const nl2br = s=> s.replace(/\n/g,'<br/>');
  const clamp = (v,a,b)=> Math.min(Math.max(v,a),b);

  /***** Calculators *****/
  function kmFrom(val, unit){
    if(unit==='km') return val;
    if(unit==='au') return val * 1.496e8;
    if(unit==='ly') return val * 9.4607e12;
    return val;
  }
  function yearsAtFractionC(distanceKm, fractionC){
    const c = 299792.458; // km/s
    const seconds = distanceKm / (fractionC * c);
    return seconds / (60*60*24*365.25);
  }
  function gammaForFractionC(f){
    const v2 = (f*299792458)**2; const c2 = (299792458**2);
    return 1/Math.sqrt(1 - v2/c2);
  }
  function tngWarpToC(W){
    if(W<1) return W; // sublight fallback
    return Math.pow(W, 10/3); // fan approximation
  }

  /***** Starfield *****/
  function starfield(){
    const c = document.getElementById('starfield');
    const ctx = c.getContext('2d');
    let w,h,stars; const N=250;
    function resize(){ w= c.width = innerWidth; h = c.height = innerHeight; stars = new Array(N).fill(0).map(()=>({x:Math.random()*w,y:Math.random()*h,z:Math.random()})); }
    function tick(){
      ctx.clearRect(0,0,w,h);
      stars.forEach(s=>{
        s.x += (s.x - w/2)*0.0008; s.y += (s.y - h/2)*0.0008; // drift outward
        if(s.x<0||s.x>w||s.y<0||s.y>h){ s.x=Math.random()*w; s.y=Math.random()*h; }
        ctx.fillStyle = `rgba(255,255,255,${0.2+0.8*s.z})`;
        ctx.fillRect(s.x, s.y, 2, 2);
      });
      requestAnimationFrame(tick);
    }
    addEventListener('resize', resize); resize(); tick();
  }

  /***** Event wiring *****/
  function wire(){
    $$('#calc button, nav button, #sources button, dialog button').forEach(b=> b.addEventListener('click', ev=> ev.blur()));

    // nav
    $$('nav [data-goto]').forEach(b=> b.addEventListener('click', e=>{
      const target = $(b.getAttribute('data-goto'));
      target?.scrollIntoView({behavior:'smooth',block:'start'});
    }));

    // editor dialog
    $('#openEditor').onclick = ()=> $('#editorDlg').showModal();
    $('#closeEditor').onclick = ()=> $('#editorDlg').close();

    // add theory
    $('#addTheory').onclick = ()=>{
      const t = {title: $('#thTitle').value.trim()||'Untitled', tags: $('#thTags').value.trim(), body: $('#thBody').value.trim()};
      state.theory.unshift(t); save(); render(); $('#thTitle').value=$('#thTags').value=$('#thBody').value='';
    }

    // delete handlers (event delegation)
    $('#theoryList').addEventListener('click', e=>{
      const idx = e.target.getAttribute('data-del-theory');
      if(idx!=null){ state.theory.splice(Number(idx),1); save(); render(); }
    })
    $('#srcTable').addEventListener('click', e=>{
      const idx = e.target.getAttribute('data-del-src');
      if(idx!=null){ state.sources.splice(Number(idx),1); save(); render(); }
    })

    // weights
    $('#applyWeights').onclick = ()=>{
      state.weights.theory = Number($('#wTheory').value);
      state.weights.energy = Number($('#wEnergy').value);
      state.weights.eng = Number($('#wEng').value);
      state.weights.mat = Number($('#wMat').value);
      save(); render();
    }

    // sources add
    $('#addSource').onclick = ()=>{
      const title = $('#srcTitle').value.trim();
      const url = $('#srcUrl').value.trim();
      const tags = $('#srcTags').value.split(',').map(s=>s.trim()).filter(Boolean);
      const summary = $('#srcSummary').value.trim();
      if(!title && !summary){ alert('Please add a title or some notes.'); return; }
      state.sources.unshift({title,url,tags,summary}); save(); render();
      $('#srcTitle').value=$('#srcUrl').value=$('#srcTags').value=$('#srcSummary').value='';
    }
    $('#clearForm').onclick = ()=>{ $('#srcTitle').value=$('#srcUrl').value=$('#srcTags').value=$('#srcSummary').value=''; }

    // persistence buttons
    $('#saveData').onclick = ()=>{
      const blob = new Blob([JSON.stringify(state,null,2)], {type:'application/json'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'warp-console-data.json'; a.click(); URL.revokeObjectURL(a.href);
    }
    $('#loadData').onclick = ()=> $('#loadFile').click();
    $('#loadFile').addEventListener('change', async (e)=>{
      const file = e.target.files[0]; if(!file) return;
      try{ const text = await file.text(); const obj = JSON.parse(text); Object.assign(state,obj); save(); render(); }
      catch(err){ alert('Invalid JSON file.'); console.error(err); }
      e.target.value='';
    })
    $('#clearData').onclick = ()=>{ if(confirm('Reset all local data?')) reset(); }

    // print
    $('#print').onclick = ()=> window.print();

    // calculators
    $('#calcSublight').onclick = ()=>{
      const pct = Math.max(0, Math.min(99.999, Number($('#pctC').value)));
      const f = pct/100;
      const d = Number($('#distVal').value); const u = $('#distUnit').value;
      const km = kmFrom(d,u);
      const years = yearsAtFractionC(km,f);
      const rel = $('#relMode').checked;
      let text = `${(years).toFixed(3)} years (observer frame)`;
      if(rel){
        const gamma = gammaForFractionC(f);
        const shipYears = years/gamma;
        text += ` • γ=${gamma.toFixed(3)} • ship time ≈ ${shipYears.toFixed(3)} years`;
      }
      $('#subResult').textContent = text;
    }

    $('#calcWarp').onclick = ()=>{
      const W = Math.max(1, Number($('#warpFactor').value));
      const vC = tngWarpToC(W);
      const dly = Number($('#warpDist').value);
      const years = dly / vC;
      $('#warpResult').textContent = `Effective speed ≈ ${vC.toFixed(3)}c • travel time ≈ ${years.toFixed(3)} years`;
    }

    // demo seed
    $('#seedDemo').onclick = ()=>{
      const demo = {
        theory: [
          {title:'Alcubierre Metric (1994)', tags:'warp, negative energy, concept', body:'Expands spacetime behind and contracts ahead to move a bubble effectively FTL. Requires regions of negative energy density (exotic matter). Classical energy demands are astronomical; newer proposals aim to reduce them via modified metrics or boundary conditions.'},
          {title:'Quantized Inertia (controversial)', tags:'inertia, hypothesis', body:'Attempts to explain inertia via Unruh radiation horizons; proposes thrust via asymmetric horizons. Highly debated; experimental evidence is inconclusive.'},
          {title:'Beamed Sail to 0.2–0.3c', tags:'laser sail, concept, engineering', body:'High‑power phased laser arrays push ultra‑light sails. Power requirements in multi‑GW to TW range; materials and beam control are key risks.'}
        ],
        sources: [
          {title:'Alcubierre warp drive', url:'', tags:['concept','warp','negative energy'], summary:'Foundational metric-warp concept; motivates searches for Casimir and quantum vacuum engineering.'},
          {title:'Laser Sail Roadmap', url:'', tags:['concept','beamed propulsion'], summary:'Phased-array beaming for relativistic probes; scaling challenges in atmosphere, pointing, and sail thermals.'},
          {title:'Fusion‑Electric Drive', url:'', tags:['engineering','propulsion'], summary:'High‑Isp fusion paired with electric thrusters; staging path to high Δv for interstellar precursors.'}
        ],
        weights: {theory:18, energy:9, eng:14, mat:12}
      };
      Object.assign(state, demo); save(); render();
    }
  }

  /***** Init *****/
  window.addEventListener('DOMContentLoaded', ()=>{ load(); wire(); starfield(); });
  </script>
</body>
</html>
