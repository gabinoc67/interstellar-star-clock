<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Interstellar Time ‚Äî Vector HTML (Live Stardate Toggle)</title>
<style>
  :root{
    --scale:1.10; /* +10% */
    --bg:#0b1320;
    --panel:#111a2b;
    --ink:#e9eef9;
    --muted:#a9b6d3;
    --accent:#7dd3fc;
    --grid:#1b2740;
    --stroke:#274061;
    --radius:20px;
  }
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#081020,#0c1730 50%,#0a1427);
    color:var(--ink);
    font: calc(16px * var(--scale))/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
    display:grid; place-items:start center; padding:32px;
  }
  .wrap{width:min(1200px,95vw); display:grid; gap:20px}
  .title{font-size:clamp(22px,3.2vw,34px); font-weight:800; letter-spacing:.4px; display:flex; align-items:center; gap:.6rem}
  .title .rocket{font-size:1.2em}
  .grid{display:grid; grid-template-columns:repeat(12,1fr); gap:20px}
  .card{
    grid-column:span 12; background:var(--panel); border:1px solid var(--stroke);
    border-radius:var(--radius); overflow:hidden
  }
  @media (min-width:860px){
    .span6{grid-column:span 6}
    .span4{grid-column:span 4}
    .span8{grid-column:span 8}
  }
  .card header{
    padding:14px 18px; border-bottom:1px solid var(--stroke);
    display:flex; align-items:center; justify-content:space-between;
    background:radial-gradient(1200px 300px at 20% -20%, rgba(125,211,252,.08), transparent 60%);
  }
  .card header h2{margin:0; font-size:1.05rem; letter-spacing:.35px; font-weight:800}
  .body{padding:18px; display:grid; gap:14px}
  .muted{color:var(--muted)}
  .pill{font-variant-numeric:tabular-nums; background:#0c1a30; border:1px solid var(--stroke); padding:.35rem .6rem; border-radius:10px}
  .row{display:flex; flex-wrap:wrap; gap:12px; align-items:center}
  .kvs{display:grid; grid-template-columns:1fr auto; gap:8px 16px; align-items:center}
  .right{justify-self:end}
  .big{font-size:clamp(26px,4.2vw,40px); font-weight:800; letter-spacing:.5px; font-variant-numeric:tabular-nums}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace}
  .small{font-size:.92rem}
  .badge{padding:.25rem .5rem; border-radius:999px; border:1px solid var(--stroke); color:var(--muted); background:#0a182c}
  label{display:flex; gap:.5rem; align-items:center}
  input, select{
    background:#0b152a; border:1px solid var(--stroke); color:var(--ink);
    padding:.45rem .55rem; border-radius:10px; font:inherit;
  }
  input[type="number"]{width:10ch}
  input[type="datetime-local"]{width:22ch}
  a{color:var(--accent); text-decoration:none}
  a:hover{text-decoration:underline}

  /* Vector frame styling */
  svg{width:100%; height:auto; display:block}
  .frame{background:conic-gradient(from 90deg at 50% 50%, #0f1c33, #0b1324); border-top:1px solid var(--grid)}
  .caption{fill:var(--muted); font-size:12px}
  .tick{stroke:#244; stroke-width:.8}
  .orbit{stroke:#2b486f; fill:none}
  .node{fill:#7dd3fc}
  .glow{filter:url(#glow)}
  .foot{color:var(--muted); text-align:center; margin-top:6px; font-size:.88rem}
</style>
</head>
<body>
<div class="wrap">
  <div class="title">Interstellar Time Dashboard (Live) <span class="rocket">üöÄ</span></div>

  <!-- Interstellar Time + Stardate -->
  <div class="grid">
    <section class="card span6" aria-labelledby="hdr-itime">
      <header>
        <h2 id="hdr-itime">Interstellar Time</h2>
        <span class="badge">demo</span>
      </header>
      <div class="body">
        <div class="row">
          <span class="muted">Interstellar Year</span>
          <span class="pill mono" id="interstellarYear">57,889,169.3</span>
        </div>
        <div class="row">
          <span class="muted">Stardate Year</span>
          <span class="pill mono" id="stardateYear">57,805,561.33</span>
        </div>

        <!-- Decorative vector ring -->
        <svg viewBox="0 0 600 180" class="frame" role="img" aria-label="Vector time ring">
          <defs>
            <filter id="glow" x="-40%" y="-40%" width="180%" height="180%">
              <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
              <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
          </defs>
          <g transform="translate(300,90)">
            <circle r="72" class="orbit"/>
            <circle r="52" class="orbit" opacity=".6"/>
            <g id="ticks">
              <script type="application/ecmascript"><![CDATA[
                (function(){
                  const g = document.currentScript.parentNode;
                  for(let i=0;i<60;i++){
                    const a=(i/60)*Math.PI*2;
                    const x1=Math.cos(a)*72, y1=Math.sin(a)*72;
                    const x2=Math.cos(a)*(i%5?66:60), y2=Math.sin(a)*(i%5?66:60);
                    const ln=document.createElementNS('http://www.w3.org/2000/svg','line');
                    ln.setAttribute('x1',x1); ln.setAttribute('y1',y1);
                    ln.setAttribute('x2',x2); ln.setAttribute('y2',y2);
                    ln.setAttribute('class','tick'); ln.setAttribute('opacity', i%5? .45: .8);
                    g.appendChild(ln);
                  }
                })()
              ]]></script>
            </g>
            <circle r="4" class="node glow">
              <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="40s" repeatCount="indefinite"/>
            </circle>
          </g>
          <text x="20" y="160" class="caption">Vector SVG ‚Ä¢ crisp at any zoom</text>
        </svg>
      </div>
    </section>

    <section class="card span6" aria-labelledby="hdr-stardate">
      <header>
        <h2 id="hdr-stardate">Stardate (live)</h2>
        <span class="badge" id="sdBadge">TNG/Okuda (fan)</span>
      </header>
      <div class="body">
        <div class="row" style="gap:10px">
          <label>Convention
            <select id="sdMode">
              <option value="tng">TNG/Okuda (fan mapping)</option>
              <option value="custom">Custom Linear</option>
              <option value="verbatim">Verbatim / Pinned (demo)</option>
            </select>
          </label>
          <span class="pill">updates every second</span>
        </div>

        <!-- Display block -->
        <div class="kvs">
          <div class="label">Stardate</div>
          <div class="big mono" id="sdLive">--</div>
          <div class="label">Formula</div>
          <div class="mono" id="sdFormula">SD = 1000¬∑(Y‚àí2323) + 1000¬∑DOY/365 + fraction</div>
        </div>

        <!-- TNG help text -->
        <div id="tngHelp" class="small muted">
          TNG/Okuda fan formula: year 2364 maps near 41000. We compute with actual DOY and leap years (366).
        </div>

        <!-- Custom Linear controls -->
        <div id="customBox" style="display:none; gap:10px">
          <div class="row">
            <label>Anchor date/time (t‚ÇÄ)
              <input type="datetime-local" id="cAnchor">
            </label>
            <label>Stardate at t‚ÇÄ (SD‚ÇÄ)
              <input type="number" id="cSD0" step="0.0001" value="65614.7">
            </label>
            <label>Rate (stardates/day)
              <input type="number" id="cRate" step="0.0001" value="1000">
            </label>
          </div>
          <div class="small muted">
            Computes SD(t) = SD‚ÇÄ + rate √ó (t ‚àí t‚ÇÄ) in days. Defaults let you reproduce/extend your 65,614.7 example.
          </div>
        </div>

        <!-- Verbatim/pinned values -->
        <div id="verbatimBox" style="display:none">
          <div class="kvs">
            <div class="label">Pinned ‚ÄúActual star date‚Äù</div><div class="mono">‚àí29,737.8</div>
            <div class="label">Pinned ‚ÄúFrom planet_clock.html‚Äù</div><div class="mono">65,614.7</div>
          </div>
          <div class="small muted">These values are displayed verbatim (no math). Use the other modes for live computation.</div>
        </div>
      </div>
    </section>
  </div>

  <!-- Expansion & Uncertainty -->
  <section class="card" aria-labelledby="hdr-expansion">
    <header>
      <h2 id="hdr-expansion">Expansion &amp; Uncertainty</h2>
      <span class="badge">Hubble flow for stars/galaxies</span>
    </header>
    <div class="body">
      <div class="small muted">
        Hubble flow for stars/galaxies; planets/moons are bound but we still show cosmological ‚ÄúDistance‚Äù and ‚ÄúRec. Vel.‚Äù from their live Earth-range (tiny but non-zero).
      </div>

      <div class="row">
        <label>H‚ÇÄ (km/s/Mpc)<input type="number" id="H0" value="70" step="0.1"></label>
        <label>Seed star distance (pc)<input type="number" id="seedStarPc" value="10" step="0.01"></label>
        <label>Seed galaxy distance (Mpc)<input type="number" id="seedGalMpc" value="1.00" step="0.01"></label>
        <span class="pill">c = 299,792.458 km/s</span>
      </div>

      <div class="grid">
        <div class="card span6">
          <header><h2>Star (demo)</h2><span class="badge">seed: <span id="seedStarLabel">10 pc</span></span></header>
          <div class="body kvs">
            <div class="label">Distance</div><div class="mono" id="starDistMpc">0.0000100 Mpc</div>
            <div class="label">Recession velocity</div><div class="mono" id="starVel">0.0007 km/s</div>
            <div class="label">z ‚âà v/c</div><div class="mono" id="starZ">2.335√ó10‚Åª‚Åπ</div>
          </div>
        </div>
        <div class="card span6">
          <header><h2>Galaxy (demo)</h2><span class="badge">seed: <span id="seedGalLabel">1.00 Mpc</span></span></header>
          <div class="body kvs">
            <div class="label">Distance</div><div class="mono" id="galDistMpc">1.0000 Mpc</div>
            <div class="label">Recession velocity</div><div class="mono" id="galVel">70.0 km/s</div>
            <div class="label">z ‚âà v/c</div><div class="mono" id="galZ">0.0002335</div>
          </div>
        </div>
      </div>

      <div class="small muted">
        Computation uses the linear Hubble law v = H‚ÇÄ¬∑D for small redshift (z ‚â™ 1). For larger z, use ŒõCDM‚Äîthis demo intentionally stays first-order.
      </div>
    </div>
  </section>

  <!-- Local time & clocks -->
  <section class="card" aria-labelledby="hdr-local">
    <header>
      <h2 id="hdr-local">Local Time (America/Chicago)</h2>
      <span class="badge" id="tzBadge"></span>
    </header>
    <div class="body row">
      <div class="big mono" id="localClock">--:--:--</div>
      <span class="muted">updates every second</span>
    </div>
    <svg viewBox="0 0 900 140" class="frame" aria-hidden="true">
      <g transform="translate(20,20)">
        <rect width="860" height="100" rx="14" fill="#0b1428" stroke="#274061"/>
        <g id="ticks2">
          <script type="application/ecmascript"><![CDATA[
            (function(){
              const g = document.currentScript.parentNode;
              for(let i=0;i<=60;i++){
                const x=20+i*(820/60);
                const ln=document.createElementNS('http://www.w3.org/2000/svg','line');
                ln.setAttribute('x1',x); ln.setAttribute('x2',x);
                ln.setAttribute('y1',10); ln.setAttribute('y2',i%5?30:38);
                ln.setAttribute('class','tick'); ln.setAttribute('opacity', i%5? .45: .8);
                g.appendChild(ln);
              }
            })()
          ]]></script>
        </g>
        <text x="30" y="95" class="caption">Second marks (SVG)</text>
      </g>
    </svg>
  </section>

  <div class="foot">
    Built as a single-file vector HTML demo. ‚ÄúStardate‚Äù has multiple incompatible definitions; this page lets you switch among a pinned display, a common TNG/Okuda fan mapping, and a fully tunable linear mapping. Your referenced page: <a href="https://gabinoc67.github.io/interstellar-star-clock/planet_clock.html" target="_blank" rel="noopener">planet_clock.html</a>.
  </div>
</div>

<script>
/* ---------- Utilities ---------- */
const fmt = (n, frac=1)=> new Intl.NumberFormat(undefined,
  {maximumFractionDigits:frac, minimumFractionDigits:frac}).format(n);
const sci = (n)=> {
  if(n===0) return "0";
  const e=Math.floor(Math.log10(Math.abs(n))), m=n/10**e;
  const sup = s=>[...s].map(d=>"‚Å∞¬π¬≤¬≥‚Å¥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ"[d]).join("");
  return `${fmt(m,4)}√ó10${e>=0?"":"\u207B"}${sup(String(Math.abs(e)))}`;
};
const pad2 = n => String(n).padStart(2,'0');

/* ---------- Provided static values ---------- */
document.getElementById('interstellarYear').textContent = "57,889,169.3";
document.getElementById('stardateYear').textContent = "57,805,561.33";

/* ---------- Local time (America/Chicago shown via system tz) ---------- */
const tzBadge = document.getElementById('tzBadge');
try { tzBadge.textContent = Intl.DateTimeFormat().resolvedOptions().timeZone || "Local"; }
catch(e){ tzBadge.textContent = "Local"; }
const clock = document.getElementById('localClock');
function tickClock(){
  const d = new Date();
  clock.textContent = d.toLocaleTimeString([], {hour12:false});
}
setInterval(tickClock, 1000); tickClock();

/* ---------- Hubble first-order calculator ---------- */
const H0 = document.getElementById('H0');
const seedStarPc = document.getElementById('seedStarPc');
const seedGalMpc = document.getElementById('seedGalMpc');
const starDistMpc = document.getElementById('starDistMpc');
const starVel = document.getElementById('starVel');
const starZ = document.getElementById('starZ');
const galDistMpc = document.getElementById('galDistMpc');
const galVel = document.getElementById('galVel');
const galZ = document.getElementById('galZ');
const seedStarLabel = document.getElementById('seedStarLabel');
const seedGalLabel = document.getElementById('seedGalLabel');
const C_KM_S = 299792.458;

function recomputeHubble(){
  const H = parseFloat(H0.value)||70;
  const dStarPc = Math.max(0, parseFloat(seedStarPc.value)||0);
  const dGalMpc = Math.max(0, parseFloat(seedGalMpc.value)||0);
  seedStarLabel.textContent = `${fmt(dStarPc,2)} pc`;
  seedGalLabel.textContent = `${fmt(dGalMpc,2)} Mpc`;
  const dStarMpc = dStarPc / 1e6;
  const vStar = H * dStarMpc;
  const vGal  = H * dGalMpc;
  const zStar = vStar / C_KM_S;
  const zGal  = vGal  / C_KM_S;
  starDistMpc.textContent = `${dStarMpc.toFixed(7)} Mpc`;
  starVel.textContent = `${fmt(vStar,4)} km/s`;
  starZ.textContent = zStar < 1e-6 ? `${sci(zStar)}` : fmt(zStar,7);
  galDistMpc.textContent = `${fmt(dGalMpc,4)} Mpc`;
  galVel.textContent = `${fmt(vGal,2)} km/s`;
  galZ.textContent = zGal < 1e-6 ? `${sci(zGal)}` : fmt(zGal,7);
}
['input','change'].forEach(ev=>{
  H0.addEventListener(ev,recomputeHubble);
  seedStarPc.addEventListener(ev,recomputeHubble);
  seedGalMpc.addEventListener(ev,recomputeHubble);
});
recomputeHubble();

/* ---------- Stardate (live) ---------- */
const sdModeSel = document.getElementById('sdMode');
const sdBadge = document.getElementById('sdBadge');
const sdLive = document.getElementById('sdLive');
const sdFormulaEl = document.getElementById('sdFormula');
const tngHelp = document.getElementById('tngHelp');
const customBox = document.getElementById('customBox');
const verbatimBox = document.getElementById('verbatimBox');

const cAnchor = document.getElementById('cAnchor');
const cSD0 = document.getElementById('cSD0');
const cRate = document.getElementById('cRate');

/* seed Custom with now as t0 */
(function seedCustom(){
  const now = new Date();
  const iso = new Date(now.getTime()-now.getTimezoneOffset()*60000)
              .toISOString().slice(0,16); // yyyy-mm-ddThh:mm
  cAnchor.value = iso;
})();

/* Helpers for TNG/Okuda fan mapping */
function dayOfYearUTC(date){
  const start = Date.UTC(date.getUTCFullYear(),0,1);
  const diff = (date.getTime() - start);
  const doy = Math.floor(diff / 86400000) + 1;
  return doy;
}
function daysInYearUTC(y){
  const d = new Date(Date.UTC(y,0,1));
  const nd = new Date(Date.UTC(y+1,0,1));
  return Math.round((nd - d)/86400000);
}

/* Compute Stardate based on current mode */
function computeStardate(){
  const now = new Date();
  const mode = sdModeSel.value;

  tngHelp.style.display = (mode==='tng') ? '' : 'none';
  customBox.style.display = (mode==='custom') ? 'grid' : 'none';
  verbatimBox.style.display = (mode==='verbatim') ? 'block' : 'none';

  if(mode === 'verbatim'){
    sdBadge.textContent = 'Pinned (demo)';
    sdLive.textContent = '‚Äî (pinned values below)';
    sdFormulaEl.textContent = 'No computation ‚Äî shows your provided numbers.';
    return;
  }

  if(mode === 'tng'){
    // SD = 1000*(Y - 2323) + 1000 * (DOY / daysInYear) + fractionOfDay* (1000/daysInYear)
    const Y = now.getUTCFullYear();
    const doy = dayOfYearUTC(now);
    const diy = daysInYearUTC(Y);
    const fracDay = (now.getUTCHours()/24) + (now.getUTCMinutes()/(24*60)) + (now.getUTCSeconds()/(24*3600)) + (now.getUTCMilliseconds()/(24*3600*1000));
    const base = 1000*(Y - 2323);
    const sd = base + 1000*( (doy-1 + fracDay) / diy );
    sdLive.textContent = fmt(sd, 4);
    sdBadge.textContent = 'TNG/Okuda (fan)';
    sdFormulaEl.textContent = `SD = 1000¬∑(Y‚àí2323) + 1000¬∑((DOY‚àí1 + fraction)/${diy})`;
    return;
  }

  if(mode === 'custom'){
    // SD(t) = SD0 + rate * (t - t0) [days]
    let t0 = new Date(cAnchor.value);
    if(isNaN(t0.getTime())) t0 = new Date();
    const SD0 = parseFloat(cSD0.value) || 0;
    const ratePerDay = parseFloat(cRate.value) || 1000;
    const days = (now - t0) / 86400000;
    const sd = SD0 + ratePerDay * days;
    sdLive.textContent = fmt(sd, 4);
    sdBadge.textContent = 'Custom Linear';
    sdFormulaEl.textContent = `SD = SD‚ÇÄ + rate √ó (t ‚àí t‚ÇÄ) [days], SD‚ÇÄ=${SD0}, rate=${ratePerDay}/day`;
    return;
  }
}

/* Wire controls + live updates */
['change','input'].forEach(ev=>{
  sdModeSel.addEventListener(ev, computeStardate);
  cAnchor.addEventListener(ev, computeStardate);
  cSD0.addEventListener(ev, computeStardate);
  cRate.addEventListener(ev, computeStardate);
});
setInterval(computeStardate, 1000);
computeStardate();

/* Nice: also mirror your two pinned demo numbers in the sidebar (static) */
document.getElementById('interstellarYear').textContent = "57,889,169.3";
document.getElementById('stardateYear').textContent = "57,805,561.33";
</script>
</body>
</html>
