<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Warp Control Center</title>
  <!-- Link existing stylesheet -->
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Warp Controls Layout */
    #warp-controls {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    #warp-controls label {
      font-size: 0.9rem;
    }
    #warp-controls select,
    #warp-controls input[type="range"] {
      margin-left: 0.25rem;
    }
    .engage-warp {
      transform-origin: center;
      transition: transform 0.3s ease;
    }

    /* Rear & Front Panels */
    .center-panels {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      width: 60%;
      margin: 1rem auto;
      justify-items: center;
    }
    .view-panel {
      background: rgba(255,255,255,0.05);
      padding: 1rem;
      border-radius: 0.5rem;
      text-align: center;
      transition: transform 0.6s ease;
    }
    .view-panel canvas {
      width: 100%;
      height: auto;
      display: block;
      margin-top: 0.5rem;
      background: #000;
      border-radius: 50%;
    }

    /* Trajectory & Vectors Panel */
    #trajectory-panel {
      width: 80%;
      margin: 1.5rem auto;
      background: rgba(0,0,20,0.75);
      padding: 1rem;
      border-radius: 0.75rem;
      color: #fff;
      font-family: sans-serif;
    }
    #trajectory-panel h2 {
      margin-bottom: 0.25rem;
      font-size: 1.5rem;
      text-align: center;
    }
    #trajectory-panel .vector-stats {
      text-align: center;
      margin-bottom: 1rem;
      font-size: 1rem;
      opacity: 0.85;
    }
    .planet-panels {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin-bottom: 1rem;
    }
    .planet-item {
      text-align: center;
    }
    .planet-item canvas {
      width: 120px;
      height: 120px;
      background: #001;
      border: 1px solid #444;
      border-radius: 50%;
    }
    #trajectory-canvas {
      display: block;
      width: 100%;
      height: 200px;
      background: #020;
      border: 1px solid #555;
      margin: 0 auto 1rem;
    }
    .trajectory-info {
      display: flex;
      justify-content: space-around;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>Warp Control Center</h1>
    <div id="warp-controls">
      <button class="engage-warp">Engage Warp</button>
      <label for="planet-select">Destination:</label>
      <select id="planet-select">
        <option value="">--Select--</option>
        <option value="mercury">Mercury</option>
        <option value="venus">Venus</option>
        <option value="earth">Earth</option>
        <option value="mars">Mars</option>
        <option value="jupiter">Jupiter</option>
        <option value="saturn">Saturn</option>
        <option value="uranus">Uranus</option>
        <option value="neptune">Neptune</option>
        <option value="pluto">Pluto</option>
        <option value="moon">Moon</option>
      </select>
      <label for="warp-speed">Speed:</label>
      <input type="range" id="warp-speed" min="1" max="10" value="1">
    </div>
  </header>

  <!-- Rear & Front View Panels -->
  <section id="central-warp-panels">
    <div class="center-panels">
      <div id="rear-view" class="view-panel">
        <h3>Rear View (Earth)</h3>
        <canvas id="rear-canvas" width="200" height="200"></canvas>
      </div>
      <div id="front-view" class="view-panel">
        <h3 id="front-title">Front View</h3>
        <canvas id="front-canvas" width="200" height="200"></canvas>
      </div>
    </div>
  </section>

  <!-- Trajectory & Field Vectors -->
  <section id="trajectory-panel">
    <h2>Trajectory & Field Vectors</h2>
    <div class="vector-stats">
      Rear <span id="stat-rear">65%</span> • Front <span id="stat-front">35%</span> • LR <span id="stat-lr">0%</span> • UD <span id="stat-ud">0%</span>
    </div>
    <div class="planet-panels">
      <div class="planet-item">
        <h3>Earth</h3>
        <canvas id="earth-canvas" width="120" height="120"></canvas>
      </div>
      <div class="planet-item">
        <h3 id="dest-label">Destination</h3>
        <canvas id="dest-canvas" width="120" height="120"></canvas>
      </div>
    </div>
    <canvas id="trajectory-canvas" width="600" height="200"></canvas>
    <div class="trajectory-info">
      <div>ΔX Angle: <span id="vector-x">0°</span></div>
      <div>ΔY Angle: <span id="vector-y">0°</span></div>
      <div>Trajectory: <span id="trajectory-angle">0°</span></div>
    </div>
  </section>

  <script src="scripts.js"></script>
  <script>
    // Element references
    const engageBtn    = document.querySelector('.engage-warp');
    const speedInput   = document.getElementById('warp-speed');
    const planetSelect = document.getElementById('planet-select');
    const rearCanvas   = document.getElementById('rear-canvas');
    const frontCanvas  = document.getElementById('front-canvas');
    const rearCtx      = rearCanvas.getContext('2d');
    const frontCtx     = frontCanvas.getContext('2d');
    const trajCanvas   = document.getElementById('trajectory-canvas');
    const tCtx         = trajCanvas.getContext('2d');
    const earthMini    = document.getElementById('earth-canvas').getContext('2d');
    const destMini     = document.getElementById('dest-canvas').getContext('2d');

    // Load planet images
    const planetNames = ['mercury','venus','earth','mars','jupiter','saturn','uranus','neptune','pluto','moon'];
    const images = {};
    planetNames.forEach(name => {
      const img = new Image();
      img.src = name + '.png';
      images[name] = img;
    });

    // Draw helper
    function drawPlanet(ctx, img, scale) {
      const cw = ctx.canvas.width, ch = ctx.canvas.height;
      const iw = img.width, ih = img.height;
      const w = iw * scale, h = ih * scale;
      ctx.clearRect(0, 0, cw, ch);
      ctx.drawImage(img, (cw - w)/2, (ch - h)/2, w, h);
    }

    // Initial small mini-panels
    planetNames.includes('earth') && images['earth'].onload = () => {
      drawPlanet(earthMini, images['earth'], 0.5);
    };

    function drawMiniDest(name) {
      const img = images[name];
      img.onload = () => drawPlanet(destMini, img, 0.5);
      if (img.complete) drawPlanet(destMini, img, 0.5);
    }

    // Trajectory drawing
    function drawTrajectory() {
      const w = trajCanvas.width, h = trajCanvas.height;
      tCtx.clearRect(0, 0, w, h);
      const start = { x: 60, y: h/2 };
      const end   = { x: w - 60, y: h/2 };
      const speed = +speedInput.value;
      const cp    = { x: w/2, y: h/2 - (speed/10)*(h/3) };

      tCtx.strokeStyle = '#0f0';
      tCtx.lineWidth   = 2;
      tCtx.beginPath();
      tCtx.moveTo(start.x, start.y);
      tCtx.quadraticCurveTo(cp.x, cp.y, end.x, end.y);
      tCtx.stroke();

      // spaceship marker
      tCtx.fillStyle = '#f00';
      tCtx.beginPath();
      tCtx.arc(end.x, end.y, 6, 0, Math.PI*2);
      tCtx.fill();

      // angles
      const dx    = end.x - start.x;
      const dy    = end.y - start.y;
      const angle = Math.atan2(dy, dx) * 180/Math.PI;
      document.getElementById('vector-x').innerText = angle.toFixed(1) + '°';
      document.getElementById('vector-y').innerText = (90 - angle).toFixed(1) + '°';
      document.getElementById('trajectory-angle').innerText = angle.toFixed(1) + '°';
    }

    // Engage Warp behavior
    engageBtn.addEventListener('click', () => {
      const speed = +speedInput.value;
      const dest  = planetSelect.value;
      // compute zoom scales
      const rearScale  = Math.max(0, 1 - speed/10);
      const frontScale = speed / 10;
      // redraw panels
      images['earth'].complete && drawPlanet(rearCtx, images['earth'], rearScale);
      if (dest && images[dest]) {
        document.getElementById('front-title').innerText = dest.charAt(0).toUpperCase() + dest.slice(1);
        images[dest].complete && drawPlanet(frontCtx, images[dest], frontScale);
      }
      // scale button
      engageBtn.style.transform = 'scale(1.57)';
      // update stats bar
      document.getElementById('stat-rear').innerText  = Math.round((rearScale*100)) + '%';
      document.getElementById('stat-front').innerText = Math.round((frontScale*100)) + '%';
      // redraw trajectory
      drawTrajectory();
    });

    // On speed change: if engaged, update visuals
    speedInput.addEventListener('input', () => {
      drawTrajectory();
    });

    // Initial trajectory
    window.addEventListener('load', drawTrajectory);
  </script>
</body>
</html>
