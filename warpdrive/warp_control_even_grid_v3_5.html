<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Warp Control Center</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Warp Controls Layout */
    #warp-controls {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    #warp-controls label {
      font-size: 0.9rem;
      white-space: nowrap;
    }
    #warp-controls select,
    #warp-controls input[type="range"] {
      margin-left: 0.25rem;
    }
    /* Make speed slider wider */
    #warp-speed { width: 60%; }
    .engage-warp,
    #reset-btn {
      transform-origin: center;
      transition: transform 0.3s ease;
      padding: 0.5rem 1rem;
      font-size: 1rem;
    }

    /* Rear & Front Panels */
    .center-panels {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      width: 60%;
      margin: 1rem auto;
      justify-items: center;
    }
    .view-panel {
      background: rgba(255,255,255,0.05);
      padding: 1rem;
      border-radius: 0.5rem;
      text-align: center;
      transition: transform 0.6s ease;
    }
    .view-panel canvas {
      width: 100%;
      height: auto;
      display: block;
      margin-top: 0.5rem;
      background: #000;
      border-radius: 50%;
    }

    /* Trajectory & Vectors Panel */
    #trajectory-panel {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 35%;
      background: rgba(0,0,20,0.85);
      padding: 1rem;
      border-radius: 0.75rem;
      color: #fff;
      font-family: sans-serif;
      margin: 0;
    }
    #trajectory-panel h2 {
      margin: 0 0 0.5rem 0;
      font-size: 1.3rem;
      text-align: center;
    }
    #trajectory-panel .vector-stats {
      text-align: center;
      margin-bottom: 1rem;
      font-size: 0.9rem;
      opacity: 0.85;
    }
    .planet-panels {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin-bottom: 1rem;
    }
    .planet-item canvas {
      width: 80px;
      height: 80px;
      background: #001;
      border: 1px solid #444;
      border-radius: 50%;
    }
    #trajectory-canvas {
      width: 100% !important;
      height: 150px !important;
      background: #020;
      border: 1px solid #555;
      display: block;
      margin: 0 auto;
    }
    .trajectory-info {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      margin-top: 0.25rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>Warp Control Center</h1>
    <div id="warp-controls">
      <button class="engage-warp">Engage Warp</button>
      <button id="reset-btn">Reset</button>
      <label for="planet-select">Destination:</label>
      <select id="planet-select">
        <option value="mercury">Mercury</option>
        <option value="venus">Venus</option>
        <option value="earth">Earth</option>
        <option value="mars">Mars</option>
        <option value="jupiter">Jupiter</option>
        <option value="saturn">Saturn</option>
        <option value="uranus">Uranus</option>
        <option value="neptune">Neptune</option>
        <option value="pluto">Pluto</option>
        <option value="moon">Moon</option>
      </select>
      <label for="warp-speed">Speed:</label>
      <input type="range" id="warp-speed" min="1" max="10" value="1">
    </div>
  </header>

  <!-- Rear & Front View Panels -->
  <section id="central-warp-panels">
    <div class="center-panels">
      <div id="rear-view" class="view-panel">
        <h3>Rear View (Earth)</h3>
        <canvas id="rear-canvas" width="200" height="200"></canvas>
      </div>
      <div id="front-view" class="view-panel">
        <h3 id="front-title">Front View</h3>
        <canvas id="front-canvas" width="200" height="200"></canvas>
      </div>
    </div>
  </section>

  <!-- Trajectory & Field Vectors -->
  <section id="trajectory-panel">
    <h2>Trajectory & Field Vectors</h2>
    <div class="vector-stats">
      Rear <span id="stat-rear">90%</span> • Front <span id="stat-front">10%</span> • LR <span id="stat-lr">0%</span> • UD <span id="stat-ud">0%</span>
    </div>
    <div class="planet-panels">
      <div class="planet-item">
        <h3>Earth</h3>
        <canvas id="earth-canvas" width="80" height="80"></canvas>
      </div>
      <div class="planet-item">
        <h3 id="dest-label">Destination</h3>
        <canvas id="dest-canvas" width="80" height="80"></canvas>
      </div>
    </div>
    <canvas id="trajectory-canvas" width="600" height="150"></canvas>
    <div class="trajectory-info">
      <div>ΔX Angle: <span id="vector-x">0°</span></div>
      <div>ΔY Angle: <span id="vector-y">0°</span></div>
      <div>Trajectory: <span id="trajectory-angle">0°</span></div>
    </div>
  </section>

  <script>
    // References
    const engageBtn    = document.querySelector('.engage-warp');
    const resetBtn     = document.getElementById('reset-btn');
    const speedInput   = document.getElementById('warp-speed');
    const planetSelect = document.getElementById('planet-select');
    const rearCanvas   = document.getElementById('rear-canvas');
    const frontCanvas  = document.getElementById('front-canvas');
    const rearCtx      = rearCanvas.getContext('2d');
    const frontCtx     = frontCanvas.getContext('2d');
    const trajCanvas   = document.getElementById('trajectory-canvas');
    const tCtx         = trajCanvas.getContext('2d');
    const earthMiniCtx = document.getElementById('earth-canvas').getContext('2d');
    const destMiniCtx  = document.getElementById('dest-canvas').getContext('2d');

    // Load planet images
    const names = ['mercury','venus','earth','mars','jupiter','saturn','uranus','neptune','pluto','moon'];
    const images = {};
    names.forEach(n => { images[n] = new Image(); images[n].src = n + '.png'; });

    // Draw planet helper
    function drawPlanet(ctx, img, scale) {
      const cw=ctx.canvas.width, ch=ctx.canvas.height;
      const w=img.width*scale, h=img.height*scale;
      ctx.clearRect(0,0,cw,ch);
      ctx.drawImage(img,(cw-w)/2,(ch-h)/2,w,h);
    }

    // Static minis
    images['earth'].onload = () => drawPlanet(earthMiniCtx, images['earth'], 0.5);
    if (images['earth'].complete) drawPlanet(earthMiniCtx, images['earth'], 0.5);

    // Draw static trajectory
    function drawStaticPath(speed) {
      const w=trajCanvas.width, h=trajCanvas.height;
      const start={x:60,y:h/2}, end={x:w-60,y:h/2};
      const cp={x:w/2,y:h/2 - (speed/10)*(h/3)};
      tCtx.clearRect(0,0,w,h);
      tCtx.strokeStyle='#0f0'; tCtx.lineWidth=2;
      tCtx.beginPath(); tCtx.moveTo(start.x,start.y);
      tCtx.quadraticCurveTo(cp.x,cp.y,end.x,end.y);
      tCtx.stroke();
      return {start,cp,end};
    }

    // Animate ship along curve
    function animateTravel(path) {
      const {start,cp,end} = path;
      const speed = +speedInput.value;
      const duration = 2000/speed;
      const startTime = performance.now();
      function frame(now) {
        const t = Math.min((now-startTime)/duration,1);
        const w=trajCanvas.width, h=trajCanvas.height;
        tCtx.clearRect(0,0,w,h);
        // static path
        tCtx.strokeStyle='#0f0'; tCtx.lineWidth=2;
        tCtx.beginPath(); tCtx.moveTo(start.x,start.y);
        tCtx.quadraticCurveTo(cp.x,cp.y,end.x,end.y);
        tCtx.stroke();
        // ship dot
        const x = (1-t)*(1-t)*start.x + 2*(1-t)*t*cp.x + t*t*end.x;
        const y = (1-t)*(1-t)*start.y + 2*(1-t)*t*cp.y + t*t*end.y;
        tCtx.fillStyle='#f00'; tCtx.beginPath(); tCtx.arc(x,y,6,0,Math.PI*2); tCtx.fill();
        if (t<1) requestAnimationFrame(frame);
      }
      requestAnimationFrame(frame);
    }

    // Update stats
    function updateStats(rearScale, frontScale) {
      document.getElementById('stat-rear').innerText = Math.round(rearScale*100) + '%';
      document.getElementById('stat-front').innerText = Math.round(frontScale*100) + '%';
    }

    // Engage warp
    engageBtn.addEventListener('click', () => {
      const speed = +speedInput.value;
      const dest  = planetSelect.value;
      const rearScale  = 1 - speed/10;
      const frontScale = speed/10;
      // zoom panels
      drawPlanet(rearCtx, images['earth'], rearScale);
      if (dest && images[dest]) {
        drawPlanet(frontCtx, images[dest], frontScale);
        document.getElementById('front-title').innerText = dest.charAt(0).toUpperCase() + dest.slice(1);
      }
      // animate ship
      const path = drawStaticPath(speed);
      animateTravel(path);
      // update stats & button
      updateStats(rearScale, frontScale);
      engageBtn.style.transform = 'scale(1.57)';
    });

    // Reset
    resetBtn.addEventListener('click', () => {
      planetSelect.value = 'mercury';
      speedInput.value = 1;
      document.getElementById('dest-label').innerText = 'Destination';
      document.getElementById('front-title').innerText = 'Front View';
      updateStats(0.9, 0.1);
      drawPlanet(rearCtx, images['earth'], 0.9);
      earthMiniCtx.clearRect(0,0,earthMiniCtx.canvas.width, earthMiniCtx.canvas.height);
      drawPlanet(earthMiniCtx, images['earth'], 0.5);
      destMiniCtx.clearRect(0,0,destMiniCtx.canvas.width, destMiniCtx.canvas.height);
      const staticPath = drawStaticPath(1);
      animateTravel(staticPath);
      engageBtn.style.transform = 'scale(1)';
    });

    // Initial draw
    window.addEventListener('load', () => {
      drawPlanet(rearCtx, images['earth'], 0.9);
      const initialPath = drawStaticPath(1);
      // no auto animation
      updateStats(0.9, 0.1);
    });
  </script>
</body>
</html>
