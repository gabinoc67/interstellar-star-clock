<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Warp Control Center</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
    background-color: #05080f;
    font-family: Arial, sans-serif;
    color: #eaf2ff;
    margin: 0;
    padding: 0;
}
#mainContainer {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    grid-gap: 10px;
    padding: 10px;
}
.panel {
    background-color: #0c1424;
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.7);
}
.panel h2 {
    margin: 0 0 8px;
    font-size: 1.1em;
    color: #3ad5ff;
    text-shadow: 0 0 5px #3ad5ff;
}
.center-image {
    grid-column: span 2;
    display: flex;
    justify-content: center;
    align-items: center;
}
.center-img {
    max-width: 100%;
    border: 2px solid #3ad5ff;
    border-radius: 8px;
}
.top-bar {
    grid-column: span 3;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #121b2e;
    padding: 10px;
    border-radius: 8px;
    font-size: 1.1em;
}
.controls label {
    display: block;
    margin-top: 5px;
}
.controls select {
    width: 100%;
    margin-bottom: 8px;
}
.buttons {
    display: flex;
    gap: 5px;
    margin-top: 5px;
}
button {
    background-color: #1b273d;
    color: white;
    border: 1px solid #3ad5ff;
    border-radius: 4px;
    padding: 5px;
    cursor: pointer;
}
button:hover {
    background-color: #3ad5ff;
    color: black;
}
.compass {
    text-align: center;
}
#compassCircle {
    width: 150px;
    height: 150px;
    border: 3px solid #3ad5ff;
    border-radius: 50%;
    margin: 0 auto;
    position: relative;
}
#compassNeedle {
    width: 2px;
    height: 70px;
    background-color: red;
    position: absolute;
    top: 5px;
    left: 50%;
    transform-origin: bottom center;
}
.gauges div {
    margin: 3px 0;
}
.trip-gauge {
    color: #facc15;
}
.log-box {
    height: 150px;
    overflow-y: auto;
    background: rgba(0,0,0,0.3);
    border: 1px solid #3ad5ff;
    padding: 5px;
    font-size: 0.9em;
}
/* Starfield window */
#starfieldCanvas {
    background-color: black;
    border: 1px solid #3ad5ff;
}
/* Tensor canvas */
#tensorCanvas {
    background-color: black;
    border: 1px solid #3ad5ff;
}
</style>
</head>
<body>

<div id="mainContainer">

    <!-- Center Main Schematic -->
    <div class="panel center-image">
        <img src="ScreenHunter-102.png" alt="Warp Drive Schematic" class="center-img">
    </div>

    <!-- Top Status Bar -->
    <div class="top-bar">
        <h1>ðŸš€ Warp Control Center</h1>
        <div id="clockSync">CST / IST Sync: --:--:--</div>
    </div>

    <!-- Flight Controls -->
    <div class="panel controls">
        <h2>Flight Plan</h2>
        <label>Warp Factor:</label>
        <select id="warpFactor">
            <option value="1">Warp 1</option>
            <option value="2">Warp 2</option>
            <option value="5">Warp 5</option>
            <option value="9">Warp 9</option>
        </select>
        <label>Destination:</label>
        <select id="destination">
            <option value="Mars">Mars</option>
            <option value="Jupiter">Jupiter</option>
            <option value="Proxima">Proxima Centauri</option>
        </select>
        <div class="buttons">
            <button id="engageWarp">Engage Warp</button>
            <button id="stopWarp">Stop</button>
            <button id="muteSound">ðŸ”Š Mute</button>
        </div>
    </div>

    <!-- Navigation Compass -->
    <div class="panel compass">
        <h2>Navigation Compass</h2>
        <div id="compassCircle">
            <div id="compassNeedle"></div>
        </div>
        <div id="headingDisplay">Heading: 0Â°</div>
    </div>

    <!-- Einstein Tensor -->
    <div class="panel tensor">
        <h2>Einstein Tensor Mini</h2>
        <canvas id="tensorCanvas" width="200" height="50"></canvas>
    </div>

    <!-- Clock Sync -->
    <div class="panel clocks">
        <h2>Clock Sync</h2>
        <div>C1: <span id="clock1">--:--:--</span></div>
        <div>C2: <span id="clock2">--:--:--</span></div>
        <div>C3: <span id="clock3">--:--:--</span></div>
        <div>C4: <span id="clock4">--:--:--</span></div>
        <div>C5: <span id="clock5">--:--:--</span></div>
    </div>

    <!-- Warp Starfield -->
    <div class="panel starfield">
        <h2>Warp Starfield Window</h2>
        <canvas id="starfieldCanvas" width="300" height="150"></canvas>
    </div>

    <!-- Debris Defense -->
    <div class="panel defense">
        <h2>Debris Defense Field</h2>
        <div id="defenseStatus">Defense MW: 0</div>
    </div>

    <!-- Safety Gauges -->
    <div class="panel gauges">
        <h2>Trip Safety Gauges</h2>
        <div>Front Bias: <span class="trip-gauge" data-value="0">0</span></div>
        <div>Rear Bias: <span class="trip-gauge" data-value="0">0</span></div>
        <div>Left/Right Bias: <span class="trip-gauge" data-value="0">0</span></div>
        <div>Up/Down Bias: <span class="trip-gauge" data-value="0">0</span></div>
    </div>

    <!-- Status Log -->
    <div class="panel log">
        <h2>Status & Log</h2>
        <div id="statusLog" class="log-box"></div>
    </div>

</div>

<script>
// === Sound Setup ===
const humSound = new Audio("https://gabinoc67.github.io/interstellar-star-clock/warpdrive/hum.mp3");
const warpSound = new Audio("https://gabinoc67.github.io/interstellar-star-clock/warpdrive/warp.mp3");
const arriveSound = new Audio("https://gabinoc67.github.io/interstellar-star-clock/warpdrive/arrive.mp3");

humSound.loop = true;
warpSound.loop = true;
arriveSound.loop = false;

let soundEnabled = true;
let warpActive = false;
let tripInterval;

// === UI Elements ===
const engageBtn = document.getElementById("engageWarp");
const stopBtn = document.getElementById("stopWarp");
const muteBtn = document.getElementById("muteSound");
const statusLog = document.getElementById("statusLog");
const headingDisplay = document.getElementById("headingDisplay");
const tripGauges = document.querySelectorAll(".trip-gauge");

// === Utility ===
function logStatus(msg, isWarning = false) {
    const entry = document.createElement("div");
    entry.textContent = msg;
    entry.style.color = isWarning ? "#ff5555" : "#00ffcc";
    statusLog.prepend(entry);
}

// === Sound Control ===
function playHum() { if (soundEnabled) { humSound.currentTime = 0; humSound.play(); } }
function playWarp() { if (soundEnabled) { humSound.pause(); warpSound.currentTime = 0; warpSound.play(); } }
function playArrival() { if (soundEnabled) { warpSound.pause(); arriveSound.currentTime = 0; arriveSound.play(); } }

// === Safety Check ===
function checkSafety(values) {
    for (let val of values) {
        if (val < -5 || val > 5) {
            logStatus("âš  Safety limit exceeded! Warp disengaged.", true);
            stopWarp();
            return false;
        }
    }
    return true;
}

// === Warp Control ===
function startWarp() {
    if (warpActive) return;
    warpActive = true;
    logStatus("Warp engaged. Calculating trajectory...");
    playWarp();

    tripInterval = setInterval(() => {
        let vals = [];
        tripGauges.forEach(g => {
            let newVal = (parseFloat(g.dataset.value) || 0) + (Math.random() * 2 - 1);
            g.dataset.value = newVal.toFixed(2);
            g.textContent = newVal.toFixed(2);
            vals.push(newVal);
        });
        checkSafety(vals);
    }, 1000);
}
function stopWarp() {
    if (!warpActive) return;
    warpActive = false;
    clearInterval(tripInterval);
    logStatus("Warp stopped. Engines idle.");
    playHum();
}
function arriveWarp() {
    warpActive = false;
    clearInterval(tripInterval);
    logStatus("Destination reached. Engines idle.");
    playArrival();
    setTimeout(playHum, 5000);
}

// === Compass Animation ===
let compassAngle = 0;
function updateCompass() {
    compassAngle = (compassAngle + 1) % 360;
    headingDisplay.textContent = `Heading: ${compassAngle}Â°`;
    document.getElementById("compassNeedle").style.transform = `rotate(${compassAngle}deg)`;
    requestAnimationFrame(updateCompass);
}

// === Clock Sync ===
function updateClocks() {
    const now = new Date();
    for (let i = 1; i <= 5; i++) {
        document.getElementById(`clock${i}`).textContent = now.toLocaleTimeString();
    }
}
setInterval(updateClocks, 1000);

// === Einstein Tensor Canvas ===
function animateTensor() {
    const canvas = document.getElementById("tensorCanvas");
    const ctx = canvas.getContext("2d");
    let t = 0;
    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        for (let x = 0; x < canvas.width; x++) {
            let y = canvas.height / 2 + Math.sin((x + t) / 10) * 20;
            ctx.lineTo(x, y);
        }
        ctx.strokeStyle = "#3ad5ff";
        ctx.stroke();
        t += 2;
        requestAnimationFrame(draw);
    }
    draw();
}
animateTensor();

// === Warp Starfield ===
function animateStarfield() {
    const canvas = document.getElementById("starfieldCanvas");
    const ctx = canvas.getContext("2d");
    let stars = Array.from({ length: 50 }, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 2,
        speed: Math.random() * 4 + 1
    }));
    function draw() {
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "white";
        stars.forEach(s => {
            ctx.beginPath();
            ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
            ctx.fill();
            s.y += s.speed;
            if (s.y > canvas.height) {
                s.x = Math.random() * canvas.width;
                s.y = 0;
            }
        });
        requestAnimationFrame(draw);
    }
    draw();
}
animateStarfield();

// === Event Listeners ===
engageBtn.addEventListener("click", startWarp);
stopBtn.addEventListener("click", stopWarp);
muteBtn.addEventListener("click", () => {
    soundEnabled = !soundEnabled;
    muteBtn.textContent = soundEnabled ? "ðŸ”Š Mute" : "ðŸ”‡ Unmute";
    if (!soundEnabled) { humSound.pause(); warpSound.pause(); arriveSound.pause(); }
    else if (!warpActive) { playHum(); }
});

// === Init ===
playHum();
logStatus("System initialized. Ready to engage warp.");
updateCompass();
</script>
</body>
</html>
