<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>üåå Warp Simulator ‚Äì CST Time Synced</title>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: 'Courier New', monospace;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      height: 100vh;
    }
    .info-panel {
      width: 300px;
      padding: 20px;
    }
    canvas {
      background: black;
      border-left: 2px solid #333;
      flex-grow: 1;
    }
    .box {
      background: #111;
      border: 1px solid #555;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 15px;
    }
    select, button {
      width: 100%;
      margin-top: 5px;
      padding: 8px;
      background: black;
      color: white;
      border: 1px solid #666;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <div class="info-panel">
    <div class="box" id="earthTime">üåç CST Time: --:--:--</div>
    <div class="box">
      Destination:
      <select id="targetPlanet">
        <option value="199">Mercury</option>
        <option value="299">Venus</option>
        <option value="499">Mars</option>
        <option value="599">Jupiter</option>
        <option value="699">Saturn</option>
        <option value="799">Uranus</option>
        <option value="899">Neptune</option>
        <option value="999">Pluto</option>
      </select>
      Warp:
      <select id="warpSpeed">
        <option value="1">Warp 1</option>
        <option value="2">Warp 2</option>
        <option value="3">Warp 3</option>
        <option value="4">Warp 4</option>
        <option value="5" selected>Warp 5</option>
        <option value="6">Warp 6</option>
        <option value="7">Warp 7</option>
        <option value="8">Warp 8</option>
        <option value="9">Warp 9</option>
        <option value="10">Warp 10</option>
      </select>
      <button onclick="engageWarp()">üöÄ Engage</button>
      <button onclick="resetScene()">üîÅ Reset</button>
      <button onclick="screenshotMap()">üì∏ Screenshot</button>
    </div>
    <div class="box">
      üì° Distance: <span id="vector">-- AU</span><br>
      üß≠ Angle: <span id="angle">--¬∞</span><br>
      üïì Departure: <span id="cstTime">--</span><br>
      üõ¨ Arrival: <span id="arrival">--</span>
    </div>
  </div>
  <canvas id="orbitCanvas" width="1000" height="1000"></canvas>
  <audio id="warpSound">
    <source src="data:audio/ogg;base64,T2dnUwACAAAAAAAAAAA+qWAAAAAAABjYXRhdgAAAA8AAAAA//tAxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" type="audio/ogg">
  </audio>
  <script>
    const canvas = document.getElementById("orbitCanvas");
    const ctx = canvas.getContext("2d");
    const warpSound = document.getElementById("warpSound");

    const AU_SCALE = 20; // scale to fit Pluto in view
    const SUN_X = canvas.width / 2;
    const SUN_Y = canvas.height / 2;
    let animationId = null;

    const ORBIT_RADIUS = {
      "199": 0.39, "299": 0.72, "499": 1.52, "599": 5.20,
      "699": 9.58, "799": 19.2, "899": 30.1, "999": 39.5
    };

    const planetColors = ["#ccc", "#ffb6c1", "#f00", "#ff0", "#f90", "#0ff", "#88f", "#bbb"];

    function updateCST() {
      const now = new Date();
      const options = { timeZone: 'America/Chicago', hour12: true };
      document.getElementById("earthTime").textContent = "üåç CST Time: " + now.toLocaleTimeString('en-US', options);
    }
    setInterval(updateCST, 1000);
    updateCST();

    function drawSystem(angle = 45, dist = 1, warp = 5, drawShip = false, t = 0) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Sun
      ctx.beginPath(); ctx.arc(SUN_X, SUN_Y, 10, 0, 2 * Math.PI);
      ctx.fillStyle = "yellow"; ctx.fill();

      // Earth
      const earthX = SUN_X + AU_SCALE;
      const earthY = SUN_Y;
      ctx.beginPath(); ctx.arc(earthX, earthY, 6, 0, 2 * Math.PI);
      ctx.fillStyle = "#0ff"; ctx.fill();

      // Orbits
      let i = 0;
      for (const r of Object.values(ORBIT_RADIUS)) {
        const rr = r * AU_SCALE;
        ctx.beginPath();
        ctx.arc(SUN_X, SUN_Y, rr, 0, 2 * Math.PI);
        ctx.strokeStyle = "#333";
        ctx.stroke();
        ctx.beginPath();
        ctx.arc(SUN_X + rr, SUN_Y, 3, 0, 2 * Math.PI);
        ctx.fillStyle = planetColors[i++ % planetColors.length];
        ctx.fill();
      }

      // Target Planet
      const rad = angle * (Math.PI / 180);
      const targetX = SUN_X + dist * AU_SCALE * Math.cos(rad);
      const targetY = SUN_Y + dist * AU_SCALE * Math.sin(rad);
      ctx.beginPath(); ctx.arc(targetX, targetY, 6, 0, 2 * Math.PI);
      ctx.fillStyle = "#f00"; ctx.fill();

      // Warp curve
      const midX = (earthX + targetX) / 2;
      const midY = (earthY + targetY) / 2 - (100 * (1 - warp / 10));
      ctx.beginPath();
      ctx.moveTo(earthX, earthY);
      ctx.quadraticCurveTo(midX, midY, targetX, targetY);
      ctx.setLineDash([5, 5]);
      ctx.strokeStyle = "lime";
      ctx.stroke();
      ctx.setLineDash([]);

      // Ship animation
      if (drawShip) {
        const x = (1 - t) ** 2 * earthX + 2 * (1 - t) * t * midX + t ** 2 * targetX;
        const y = (1 - t) ** 2 * earthY + 2 * (1 - t) * t * midY + t ** 2 * targetY;
        ctx.fillStyle = "white";
        ctx.beginPath();
        ctx.arc(x, y, 5, 0, 2 * Math.PI);
        ctx.fill();
      }
    }

    async function engageWarp() {
      const id = document.getElementById("targetPlanet").value;
      const warp = parseInt(document.getElementById("warpSpeed").value);
      const dist = ORBIT_RADIUS[id];
      const angle = Math.random() * 360;

      document.getElementById("vector").textContent = dist + " AU";
      document.getElementById("angle").textContent = angle.toFixed(1) + "¬∞";
      const now = new Date();
      document.getElementById("cstTime").textContent = now.toLocaleTimeString('en-US', { timeZone: 'America/Chicago' });

      const sec = dist * 600 / warp;
      const arrival = new Date(now.getTime() + sec * 1000);
      document.getElementById("arrival").textContent = arrival.toLocaleTimeString('en-US', { timeZone: 'America/Chicago' });

      if (animationId) cancelAnimationFrame(animationId);
      warpSound.currentTime = 0;
      warpSound.play();
      const start = performance.now();

      function animate(now) {
        const t = Math.min((now - start) / (sec * 1000), 1);
        drawSystem(angle, dist, warp, true, t);
        if (t < 1) animationId = requestAnimationFrame(animate);
      }
      requestAnimationFrame(animate);
    }

    function resetScene() {
      if (animationId) cancelAnimationFrame(animationId);
      drawSystem();
      document.getElementById("vector").textContent = "-- AU";
      document.getElementById("angle").textContent = "--¬∞";
      document.getElementById("arrival").textContent = "--";
      document.getElementById("cstTime").textContent = "--";
    }

    function screenshotMap() {
      const link = document.createElement("a");
      link.download = "warp_map.png";
      link.href = canvas.toDataURL("image/png");
      link.click();
    }

    drawSystem();
  </script>
</body>
</html>
