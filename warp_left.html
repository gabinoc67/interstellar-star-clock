<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Warp Left Panel</title>
  <style>
    body {
      background-color: #000;
      color: #00ffff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .panel-box {
      background: #111;
      border: 1px solid #00ffff;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
      width: 95%;
      max-width: 460px;
    }

    .panel-box h2 {
      margin-top: 0;
      color: #00ffff;
      font-size: 18px;
    }

    .curve-bar {
      height: 40px;
      background: linear-gradient(to right, blue, red);
      border-radius: 4px;
      margin: 10px 0;
    }

    .slider-row {
      margin: 6px 0;
    }

    .slider-label {
      font-size: 14px;
    }

    .slider {
      width: 100%;
    }

    canvas {
      width: 100%;
      height: 200px;
      background: #00081A;
      border: 1px solid #00ffff;
      border-radius: 6px;
    }

    .power-bars {
      margin-top: 8px;
    }

    .power-bars div {
      height: 8px;
      background: #00ffff88;
      margin-bottom: 4px;
      border-radius: 4px;
    }
  </style>
</head>
<body>

  <!-- Einstein Tensor Mini -->
  <div class="panel-box" id="einsteinPanel">
    <h2>Einstein Tensor Mini</h2>
    <div class="curve-bar"></div>
    <p>Gμν ≈ (curvature proxies) • EM energy density used for Tμν (NEC/WEC/SEC OK unless gtt≤0)</p>
    <p id="tensorGtt">gtt min: 1.000000</p>
    <p id="tensorRho">ρem min/max: 6.827e-17 / 8.825e-9</p>
    <p id="tensorEC">EC: ✅ NEC • ✅ WEC • ✅ SEC</p>
    <p id="tensorHorizon">Horizons: None</p>
  </div>

  <!-- Gravity Vectoring Engine -->
  <div class="panel-box" id="gravityPanel">
    <h2>Gravity Vectoring Engine</h2>
    <div class="slider-row">
      <label class="slider-label">Reactor Output (MW): <span id="reactorOutput">5000</span></label>
    </div>
    <div class="slider-row">
      <label class="slider-label">Front Contraction %: <span id="frontContraction">35</span>%</label>
    </div>
    <div class="slider-row">
      <label class="slider-label">Rear Expansion %: <span id="rearExpansion">65</span>%</label>
    </div>
    <div class="slider-row">
      <label class="slider-label">Left / Right Bias %: 0%</label>
    </div>
    <div class="slider-row">
      <label class="slider-label">Up / Down Bias %: 0%</label>
    </div>
    <p>Intake Mode: Balanced (±)</p>
    <p>Power Allocation:</p>
    <div class="power-bars">
      <div id="powerCoils" style="width: 40%"></div>
      <div id="powerVanes" style="width: 35%"></div>
      <div id="powerContainment" style="width: 25%"></div>
    </div>
  </div>

  <!-- Trajectory & Field Vectors -->
  <div class="panel-box">
    <h2>Trajectory & Field Vectors</h2>
    <canvas id="trajectoryCanvas" width="400" height="200"></canvas>
    <p id="vectorStats">Rear 65% • Front 35% • LR 0% • UD 0%</p>
  </div>

  <script>
    window.addEventListener("message", (event) => {
      const { action, warp, planet } = event.data;
      if (action === "engage") {
        updatePanels(warp, planet);
      } else if (action === "reset") {
        resetPanels();
      }
    });

    function updatePanels(warp, planet) {
      // Einstein Tensor Update
      const gtt = (1.0 - warp * 0.01).toFixed(6);
      const rhoMin = (6.827e-17 * warp).toExponential(3);
      const rhoMax = (8.825e-9 * warp).toExponential(3);
      const ec = warp >= 8 ? "⚠️ WEC Violated" : "✅ NEC • ✅ WEC • ✅ SEC";
      const horizon = gtt <= 0.01 ? "Possible" : "None";
      document.getElementById("tensorGtt").innerText = `gtt min: ${gtt}`;
      document.getElementById("tensorRho").innerText = `ρem min/max: ${rhoMin} / ${rhoMax}`;
      document.getElementById("tensorEC").innerText = `EC: ${ec}`;
      document.getElementById("tensorHorizon").innerText = `Horizons: ${horizon}`;

      // Gravity Vector Engine Update
      const output = 1000 + warp * 400;
      const contraction = 30 + warp;
      const expansion = 70 - warp;
      const fieldCoils = Math.round(output * 0.4);
      const vanes = Math.round(output * 0.35);
      const containment = output - fieldCoils - vanes;

      document.getElementById("reactorOutput").innerText = output;
      document.getElementById("frontContraction").innerText = contraction;
      document.getElementById("rearExpansion").innerText = expansion;

      document.getElementById("powerCoils").style.width = `${(fieldCoils / output) * 100}%`;
      document.getElementById("powerVanes").style.width = `${(vanes / output) * 100}%`;
      document.getElementById("powerContainment").style.width = `${(containment / output) * 100}%`;

      // Trajectory Arc
      drawTrajectory(contraction, expansion);
      document.getElementById("vectorStats").innerText = `Rear ${expansion}% • Front ${contraction}% • LR 0% • UD 0%`;
    }

    function resetPanels() {
      updatePanels(1, 'mercury');
    }

    function drawTrajectory(frontPercent, rearPercent) {
      const canvas = document.getElementById("trajectoryCanvas");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const centerY = canvas.height / 2;
      const earthX = 60;
      const marsX = canvas.width - 60;

      ctx.beginPath();
      ctx.moveTo(earthX, centerY);
      ctx.quadraticCurveTo(canvas.width / 2, 10 + (100 - frontPercent), marsX, centerY);
      ctx.strokeStyle = "red";
      ctx.lineWidth = 2;
      ctx.stroke();

      // Earth
      ctx.fillStyle = "#00ffff";
      ctx.beginPath();
      ctx.arc(earthX, centerY, 8, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillText("Earth", earthX - 20, centerY + 20);

      // Mars
      ctx.fillStyle = "#ff9900";
      ctx.beginPath();
      ctx.arc(marsX, centerY, 8, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillText("Mars", marsX - 20, centerY + 20);

      // Direction Vector
      ctx.beginPath();
      ctx.moveTo(earthX, centerY);
      ctx.lineTo(earthX, centerY - 40);
      ctx.strokeStyle = "lime";
      ctx.stroke();
    }

    window.onload = () => {
      resetPanels();
    };
  </script>
</body>
</html>
