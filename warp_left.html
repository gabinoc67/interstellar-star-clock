<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Warp Left Panel</title>
  <style>
    body {
      background-color: #000;
      color: #00ffff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .panel-box {
      background: #111;
      border: 1px solid #00ffff;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 16px;
      width: 100%;
      transform: scale(1.4); /* 40% size increase */
    }

    .panel-box h2 {
      margin-top: 0;
      color: #00ffff;
      font-size: 16px;
    }

    .curve-bar {
      height: 16px;
      position: relative;
      background: #00081A;
      border-radius: 4px;
      overflow: hidden;
    }

    .red-bar, .blue-bar {
      position: absolute;
      height: 100%;
      width: 0%;
      top: 0;
      transition: width 0.5s ease-in-out;
    }

    .red-bar {
      background: red;
      left: 0;
    }

    .blue-bar {
      background: blue;
      right: 0;
    }

    .power-bars div {
      height: 6px;
      background: #00ffff88;
      margin-bottom: 4px;
      border-radius: 3px;
      transition: width 0.5s ease-in-out;
    }

    canvas {
      background: #00081A;
      border: 1px solid #00ffff;
      border-radius: 6px;
    }

    p {
      font-size: 12px;
      margin: 4px 0;
    }

    .slider-label {
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="panel-box">
    <h2>Einstein Tensor Mini</h2>
    <div class="curve-bar">
      <div class="red-bar" id="redBar"></div>
      <div class="blue-bar" id="blueBar"></div>
    </div>
    <p>Gμν ≈ curvature • EM energy used for Tμν</p>
    <p id="tensorGtt">gtt min: 1.000000</p>
    <p id="tensorRho">ρem min/max: 6.827e-17 / 8.825e-9</p>
    <p id="tensorEC">EC: ✅ NEC • ✅ WEC • ✅ SEC</p>
    <p id="tensorHorizon">Horizons: None</p>
  </div>

  <div class="panel-box">
    <h2>Gravity Vectoring Engine</h2>
    <p>Reactor Output (MW): <input type="number" id="reactorOutputInput" value="1400" style="width: 100%; font-size: 12px;" /></p>
    <p>Front Contraction %: <input type="range" id="frontContractionSlider" min="0" max="100" value="35" /> <span id="frontContractionVal">35</span>%</p>
    <p>Rear Expansion %: <input type="range" id="rearExpansionSlider" min="0" max="100" value="65" /> <span id="rearExpansionVal">65</span>%</p>
    <p>Left / Right Bias %: 0%</p>
    <p>Up / Down Bias %: 0%</p>
    <p>Intake Mode: Balanced (±)</p>
    <p><strong>Power Allocation</strong></p>
    <div class="slider-label">Field Coils <span id="powerCoilsVal" style="float: right;">560 MW</span></div>
    <div class="power-bars"><div id="powerCoils"></div></div>
    <div class="slider-label">Vectoring Vanes <span id="powerVanesVal" style="float: right;">490 MW</span></div>
    <div class="power-bars"><div id="powerVanes"></div></div>
    <div class="slider-label">Containment <span id="powerContainmentVal" style="float: right;">350 MW</span></div>
    <div class="power-bars"><div id="powerContainment"></div></div>
  </div>

  <div class="panel-box">
    <h2>Trajectory & Field Vectors</h2>
    <canvas id="trajectoryCanvas" width="220" height="120"></canvas>
    <p id="vectorStats">Rear 65% • Front 35% • LR 0% • UD 0%</p>
  </div>

  <script>
    let currentWarp = 5;
    let selectedPlanet = "Mars";

    window.addEventListener("message", (event) => {
      if (!event.data || !event.data.action) return;
      if (event.data.warp) currentWarp = event.data.warp;
      if (event.data.planet) selectedPlanet = event.data.planet;

      if (event.data.action === "engage") updatePanels(currentWarp);
      if (event.data.action === "reset") resetPanels();
    });

    function updatePanels(warp) {
      const gtt = (1.0 - warp * 0.01).toFixed(6);
      const rhoMin = (6.827e-17 * warp).toExponential(3);
      const rhoMax = (8.825e-9 * warp).toExponential(3);
      const ec = warp >= 8 ? "⚠️ WEC Violated" : "✅ NEC • ✅ WEC • ✅ SEC";
      const horizon = gtt <= 0.01 ? "Possible" : "None";

      document.getElementById("tensorGtt").innerText = `gtt min: ${gtt}`;
      document.getElementById("tensorRho").innerText = `ρem min/max: ${rhoMin} / ${rhoMax}`;
      document.getElementById("tensorEC").innerText = `EC: ${ec}`;
      document.getElementById("tensorHorizon").innerText = `Horizons: ${horizon}`;

      const output = 1000 + warp * 400;
      const contraction = 30 + warp;
      const expansion = 70 - warp;

      document.getElementById("reactorOutputInput").value = output;
      document.getElementById("frontContractionSlider").value = contraction;
      document.getElementById("rearExpansionSlider").value = expansion;
      document.getElementById("frontContractionVal").innerText = contraction;
      document.getElementById("rearExpansionVal").innerText = expansion;

      updateFromSliders(output, contraction, expansion);
      drawTrajectory(contraction, expansion, warp);
    }

    function resetPanels() {
      updatePanels(1);
    }

    function updateFromSliders(output, contraction, expansion) {
      const fieldCoils = Math.round(output * 0.4);
      const vanes = Math.round(output * 0.35);
      const containment = output - fieldCoils - vanes;

      document.getElementById("powerCoils").style.width = `${(fieldCoils / output) * 100}%`;
      document.getElementById("powerVanes").style.width = `${(vanes / output) * 100}%`;
      document.getElementById("powerContainment").style.width = `${(containment / output) * 100}%`;

      document.getElementById("powerCoilsVal").innerText = `${fieldCoils} MW`;
      document.getElementById("powerVanesVal").innerText = `${vanes} MW`;
      document.getElementById("powerContainmentVal").innerText = `${containment} MW`;

      document.getElementById("redBar").style.width = `${contraction}%`;
      document.getElementById("blueBar").style.width = `${expansion}%`;
      document.getElementById("vectorStats").innerText = `Rear ${expansion}% • Front ${contraction}% • LR 0% • UD 0%`;
    }

    function drawTrajectory(frontPercent, rearPercent, warp) {
      const canvas = document.getElementById("trajectoryCanvas");
      const ctx = canvas.getContext("2d");
      const earthX = 30, destX = canvas.width - 30;
      const centerY = canvas.height / 2;
      const cpX = canvas.width / 2;
      const curveHeight = 90 - warp * 8;
      const cpY = centerY - curveHeight;

      let t = 0;
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // curve line
        ctx.beginPath();
        ctx.moveTo(earthX, centerY);
        ctx.quadraticCurveTo(cpX, cpY, destX, centerY);
        ctx.strokeStyle = "red";
        ctx.lineWidth = 2;
        ctx.stroke();

        // planet labels
        ctx.fillStyle = "#00f";
        ctx.beginPath();
        ctx.arc(earthX, centerY, 5, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillText("Earth", earthX - 10, centerY + 20);

        ctx.fillStyle = "#0f0";
        ctx.beginPath();
        ctx.arc(destX, centerY, 5, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillText(selectedPlanet, destX - 15, centerY + 20);

        // ship ball
        const x = (1 - t) ** 2 * earthX + 2 * (1 - t) * t * cpX + t ** 2 * destX;
        const y = (1 - t) ** 2 * centerY + 2 * (1 - t) * t * cpY + t ** 2 * centerY;
        ctx.fillStyle = "lime";
        ctx.beginPath();
        ctx.arc(x, y, 4, 0, Math.PI * 2);
        ctx.fill();

        t += 0.004;
        if (t <= 1.0) requestAnimationFrame(animate);
      }
      animate();
    }

    window.onload = resetPanels;
  </script>
</body>
</html>
