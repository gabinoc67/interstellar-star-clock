<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Warp-Tunnel Horizon Calculator — Time-on-Target Planner</title>
<meta name="description" content="Plan FTL warp-tunnel trips to galaxies beyond the cosmological event horizon. Compute reachability, time-on-target, required warp speed, and arrival date." />
<style>
  :root {
    --bg: #0b1020;
    --card: #121833;
    --ink: #e8ecff;
    --muted: #aab4ff;
    --accent: #7aa2ff;
    --danger: #ff7a9c;
    --ok: #7affc1;
    --warn: #ffd27a;
    --shadow: 0 10px 30px rgba(0,0,0,0.35);
    --radius: 18px;
  }
  * { box-sizing: border-box; }
  body {
    margin: 0; padding: 24px;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    color: var(--ink); background: radial-gradient(1200px 600px at 15% -10%, #1a2456 0%, var(--bg) 55%);
  }
  h1 { margin: 0 0 8px; font-size: clamp(26px, 3.2vw, 38px); letter-spacing: 0.2px; }
  p.lead { margin: 0 0 22px; color: var(--muted); max-width: 72ch; }
  .grid { display: grid; gap: 18px; grid-template-columns: repeat(12, 1fr); }
  .card {
    grid-column: span 12; background: linear-gradient(180deg, rgba(255,255,255,0.035), rgba(255,255,255,0.02));
    border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius); box-shadow: var(--shadow);
    padding: 18px 18px 16px;
  }
  @media (min-width: 980px) {
    .card.left { grid-column: span 7; }
    .card.right { grid-column: span 5; }
  }
  label { display: block; font-size: 13px; color: var(--muted); margin: 10px 0 6px; }
  input, select {
    width: 100%; padding: 10px 12px; border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.15); background: rgba(10,14,32,0.6); color: var(--ink);
    outline: none; font-size: 15px;
  }
  input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(122,162,255,0.25); }
  .row { display: grid; gap: 12px; grid-template-columns: 1fr; }
  @media (min-width: 620px) { .row.two { grid-template-columns: repeat(2, 1fr); } }
  .btnbar { display:flex; gap:10px; flex-wrap:wrap; margin-top: 14px; }
  button {
    appearance: none; border: none; cursor: pointer; border-radius: 12px; padding: 11px 14px; font-weight: 600;
    background: linear-gradient(180deg, #2a3b86, #1d295c); color: white; box-shadow: var(--shadow);
  }
  button.secondary { background: linear-gradient(180deg, #39415c, #2b3146); }
  button:active { transform: translateY(1px); }
  .pill { display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid rgba(255,255,255,0.15); }
  .pill.ok { border-color: rgba(122,255,193,0.5); color: var(--ok); }
  .pill.warn { border-color: rgba(255,210,122,0.5); color: var(--warn); }
  .pill.danger { border-color: rgba(255,122,156,0.5); color: var(--danger); }
  .results { display:grid; gap:10px; grid-template-columns: 1fr; margin-top: 12px; }
  .kv {
    background: rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08); border-radius: 14px; padding: 10px 12px;
    display:flex; justify-content:space-between; gap:10px; align-items: center;
  }
  .kv .k { color: var(--muted); font-size: 13px; }
  .kv .v { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size: 15px; }
  details { margin-top: 12px; }
  summary { cursor: pointer; user-select: none; color: var(--accent); }
  .foot { margin-top: 22px; font-size: 12px; color: var(--muted); }
  .hl { color: var(--accent); }
</style>
</head>
<body>
  <h1>Warp-Tunnel Horizon Calculator</h1>
  <p class="lead">Plan FTL tunnel missions to galaxies whose recession is faster than light. Choose a target, pick either your effective warp speed or a desired time-on-target, and compute reachability, travel time, and arrival date. (<span class="hl">c = 1 ly/yr</span>)</p>

  <div class="grid">
    <div class="card left">
      <h2 style="margin-top:4px;">Mission Inputs</h2>

      <div class="row two">
        <div>
          <label>Preset target (comoving distance)</label>
          <select id="preset">
            <option value="custom">— Custom distance —</option>
            <option value="18">GH-18 (18 Gly) — just beyond horizon (~> c)</option>
            <option value="25">GH-25 (25 Gly)</option>
            <option value="35">GH-35 (35 Gly)</option>
            <option value="45">GH-45 (45 Gly)</option>
          </select>
        </div>
        <div>
          <label>Custom distance if needed (Gly)</label>
          <input id="D_gly" type="number" step="0.1" min="0" placeholder="e.g., 22.5" />
        </div>
      </div>

      <div class="row two" style="margin-top:6px;">
        <div>
          <label>Cosmology H<sub>0</sub> (km/s/Mpc)</label>
          <input id="H0_kmsmpc" type="number" step="0.1" min="40" max="100" value="70" />
        </div>
        <div>
          <label>Input mode</label>
          <select id="mode">
            <option value="speed">I know my effective warp speed (ly/yr)</option>
            <option value="time">I want to arrive in a set time (years)</option>
          </select>
        </div>
      </div>

      <div class="row two" id="speedRow" style="margin-top:6px;">
        <div>
          <label>Effective warp speed v<sub>eff</sub> (ly/yr)</label>
          <input id="v_eff" type="number" step="0.01" min="0.01" placeholder="e.g., 5 (≈5c)" />
        </div>
        <div>
          <label>—</label>
          <div class="pill warn">Tip: c = 1 ly/yr. Enter 3 for ~3c, 10 for ~10c.</div>
        </div>
      </div>

      <div class="row two" id="timeRow" style="display:none; margin-top:6px;">
        <div>
          <label>Desired time-on-target T (years)</label>
          <input id="T_years" type="number" step="0.1" min="0.1" placeholder="e.g., 5" />
        </div>
        <div>
          <label>—</label>
          <div class="pill warn">We’ll compute the required v<sub>eff</sub> to make this T.</div>
        </div>
      </div>

      <div class="btnbar">
        <button id="calcBtn">Calculate</button>
        <button class="secondary" id="nowBtn">Set departure = now</button>
        <div id="reachPill" class="pill">Status: —</div>
      </div>

      <details>
        <summary>How it works (tap to expand)</summary>
        <div style="margin-top:8px; color:#cfd6ff; font-size:14px; line-height:1.45;">
          We model the comoving separation <em>D</em>(t) under Hubble expansion with a constant Hubble rate <em>H</em><sub>0</sub>.
          The recession rate is <em>v</em><sub>rec</sub> = <em>H</em><sub>0</sub> D. Your warp-tunnel provides an effective closing speed
          <em>v</em><sub>eff</sub> (in ly/yr; note c = 1 ly/yr). The separation evolves by:
          <div class="kv" style="margin-top:8px;"><div class="k">Dynamics</div><div class="v">dD/dt = − v_eff + H0 · D</div></div>
          <div class="kv"><div class="k">Reachability</div><div class="v">v_eff &gt; H0 · D0</div></div>
          <div class="kv"><div class="k">Time (if speed known)</div><div class="v">t = (1/H0) · ln( v_eff / (v_eff − H0·D0) )</div></div>
          <div class="kv"><div class="k">Speed (if time known)</div><div class="v">v_eff = (H0·D0) / (1 − e<sup>−H0·T</sup>)</div></div>
          Where D0 is today’s comoving distance. If H0·D0 &gt; 1, the target’s recession exceeds c (outside the event horizon); you can still
          intercept if your <em>v</em><sub>eff</sub> is greater than that recession rate, or if your tunnel shortens the effective D0.
        </div>
      </details>
    </div>

    <div class="card right">
      <h2 style="margin-top:4px;">Results</h2>
      <div class="results" id="results">
        <div class="kv"><div class="k">Comoving distance D0</div><div class="v" id="out_D0">—</div></div>
        <div class="kv"><div class="k">Hubble rate H0 (yr⁻¹)</div><div class="v" id="out_H0yr">—</div></div>
        <div class="kv"><div class="k">Recession v_rec = H0·D0 (ly/yr)</div><div class="v" id="out_vrec">—</div></div>
        <div class="kv"><div class="k">Mode</div><div class="v" id="out_mode">—</div></div>
        <div class="kv"><div class="k">Effective warp speed v_eff (ly/yr)</div><div class="v" id="out_veff">—</div></div>
        <div class="kv"><div class="k">Travel time t (years)</div><div class="v" id="out_time">—</div></div>
        <div class="kv"><div class="k">Departure (local)</div><div class="v" id="out_depart">—</div></div>
        <div class="kv"><div class="k">Arrival (local)</div><div class="v" id="out_arrive">—</div></div>
      </div>
      <div class="foot">
        Outside-horizon examples (choose a preset or set D0 so that H0·D0 &gt; 1). Matching local flow at arrival keeps you comoving with the target galaxy.
      </div>
    </div>
  </div>

<script>
(function(){
  const preset = document.getElementById('preset');
  const D_gly = document.getElementById('D_gly');
  const H0_kmsmpc = document.getElementById('H0_kmsmpc');
  const mode = document.getElementById('mode');
  const speedRow = document.getElementById('speedRow');
  const timeRow = document.getElementById('timeRow');
  const v_eff = document.getElementById('v_eff');
  const T_years = document.getElementById('T_years');
  const calcBtn = document.getElementById('calcBtn');
  const nowBtn = document.getElementById('nowBtn');
  const reachPill = document.getElementById('reachPill');

  const out = {
    D0: document.getElementById('out_D0'),
    H0yr: document.getElementById('out_H0yr'),
    vrec: document.getElementById('out_vrec'),
    mode: document.getElementById('out_mode'),
    veff: document.getElementById('out_veff'),
    time: document.getElementById('out_time'),
    depart: document.getElementById('out_depart'),
    arrive: document.getElementById('out_arrive')
  };

  let departureDate = new Date(); // default is "now"

  preset.addEventListener('change', () => {
    if (preset.value === 'custom') return;
    D_gly.value = preset.value;
  });

  mode.addEventListener('change', () => {
    if (mode.value === 'speed') {
      speedRow.style.display = '';
      timeRow.style.display = 'none';
    } else {
      speedRow.style.display = 'none';
      timeRow.style.display = '';
    }
  });

  nowBtn.addEventListener('click', () => {
    departureDate = new Date();
    renderDeparture();
  });

  function renderDeparture(){
    out.depart.textContent = fmtDate(departureDate);
  }

  function fmt(x, digits=3) {
    if (!isFinite(x)) return '—';
    return Number(x).toLocaleString(undefined, {maximumFractionDigits: digits});
  }

  function fmtDate(d){
    return d.toLocaleString(undefined, {year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit'});
  }

  function yearsToMs(y){
    // 1 Julian year = 365.25 days
    return y * 365.25 * 24 * 3600 * 1000;
  }

  function compute(){
    // Inputs
    const D0_gly = Number(D_gly.value || (preset.value !== 'custom' ? preset.value : NaN));
    const H0_input = Number(H0_kmsmpc.value);
    const MODE = mode.value;

    if (!isFinite(D0_gly) || D0_gly <= 0) { alert('Please provide a valid comoving distance D0 (Gly).'); return; }
    if (!isFinite(H0_input) || H0_input <= 0) { alert('Please provide a valid H0 (km/s/Mpc).'); return; }

    // Convert H0 from (km/s)/Mpc to 1/yr
    const Mpc_in_km = 3.085677581491367e19; // km
    const seconds_per_year = 365.25 * 24 * 3600;
    const H0_per_sec = H0_input / Mpc_in_km; // s^-1
    const H0_per_year = H0_per_sec * seconds_per_year; // yr^-1

    // Distances: convert Gly -> ly
    const D0_ly = D0_gly * 1e9;

    // Recession speed v_rec = H0 * D0 (ly/yr)
    const v_rec = H0_per_year * D0_ly; // ly/yr (since D in ly, H0 in 1/yr)

    let vEff, tYears;

    if (MODE === 'speed') {
      const v = Number(v_eff.value);
      if (!isFinite(v) || v <= 0) { alert('Please enter your effective warp speed v_eff (ly/yr).'); return; }
      vEff = v;

      // Reachability
      if (vEff <= v_rec) {
        tYears = Infinity; // cannot reach under constant H and constant v_eff
      } else {
        // t = (1/H0) * ln( v_eff / (v_eff - H0*D0) )
        tYears = (1 / H0_per_year) * Math.log(vEff / (vEff - v_rec));
      }

    } else { // MODE === 'time'
      const T = Number(T_years.value);
      if (!isFinite(T) || T <= 0) { alert('Please enter desired time-on-target T (years).'); return; }
      tYears = T;

      // v_eff = (H0*D0) / (1 - exp(-H0*T))
      const denom = 1 - Math.exp(-H0_per_year * T);
      if (denom <= 0) { alert('Numerical issue: try a larger T.'); return; }
      vEff = v_rec / denom;
    }

    // Arrival time
    let arrivalStr = '—';
    if (isFinite(tYears)) {
      const arrival = new Date(departureDate.getTime() + yearsToMs(tYears));
      arrivalStr = fmtDate(arrival);
    }

    // Status pill
    reachPill.textContent = (vEff > v_rec) ? 'Reachable: v_eff > H0·D0' : 'Unreachable at this v_eff (increase speed or shorten path)';
    reachPill.className = 'pill ' + ((vEff > v_rec) ? 'ok' : 'danger');

    // Render outputs
    out.D0.textContent = `${fmt(D0_gly,3)} Gly`;
    out.H0yr.textContent = `${fmt(H0_per_year,6)} yr⁻¹`;
    out.vrec.textContent = isFinite(v_rec) ? `${fmt(v_rec,3)} ly/yr` : '—';
    out.mode.textContent = (MODE === 'speed') ? 'Given speed → solve time' : 'Given time → solve required speed';
    out.veff.textContent = isFinite(vEff) ? `${fmt(vEff,3)} ly/yr` : '—';
    out.time.textContent = isFinite(tYears) ? `${fmt(tYears,3)} years` : '∞ (not reachable at this speed)';
    renderDeparture();
    out.arrive.textContent = arrivalStr;
  }

  calcBtn.addEventListener('click', compute);

  // Initialize
  renderDeparture();
})();
</script>
</body>
</html>
