<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CST Warp-Core Simulation — E≪MC² Ship</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  html,body{
    margin:0;
    height:100%;
    background:#020619;
    overflow:hidden;
    font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;
    color:#dfe9ff;
  }
  #sim{
    position:fixed;
    inset:0;
    display:block;
  }
  #hud{
    position:fixed;
    top:16px;
    left:16px;
    padding:10px 14px;
    background:rgba(3,10,40,0.72);
    border:1px solid rgba(130,190,255,0.6);
    border-radius:10px;
    backdrop-filter:blur(8px);
  }
  #hud h1{
    margin:0 0 4px;
    font-size:16px;
    letter-spacing:0.08em;
    text-transform:uppercase;
  }
  #hud .label{
    font-size:11px;
    text-transform:uppercase;
    color:#9fb5ff;
    letter-spacing:0.18em;
  }
  #hud .time{
    font-size:20px;
    font-weight:600;
  }
  #hud .status{
    margin-top:4px;
    font-size:12px;
    color:#8fe6ff;
  }
</style>
</head>
<body>
<canvas id="sim"></canvas>

<div id="hud">
  <h1>CST Synchronization</h1>
  <div class="label">Cosmic Synchronized Time (CST)</div>
  <div class="time" id="cstTime">--:--:--</div>
  <div class="status" id="cstStatus">Warp Field: Initializing…</div>
</div>

<script>
(function(){
  const canvas = document.getElementById('sim');
  const ctx    = canvas.getContext('2d');
  let w = 0, h = 0, cx = 0, cy = 0;
  let lastT = 0;

  // resize canvas to full window
  function resize(){
    w = canvas.width  = window.innerWidth;
    h = canvas.height = window.innerHeight;
    cx = w / 2;
    cy = h / 2;
  }
  window.addEventListener('resize', resize);
  resize();

  // load ship blueprint as background
  const bg = new Image();
  bg.src = "ship.png";

  // particle system near core
  const particles = [];
  const PCOUNT = 220;
  function initParticles(){
    particles.length = 0;
    for(let i=0;i<PCOUNT;i++){
      particles.push(makeParticle());
    }
  }
  function makeParticle(){
    const angle = Math.random()*Math.PI*2;
    const speed = 0.04 + Math.random()*0.12;
    const maxR  = 80 + Math.random()*60;
    return {
      angle,
      radius: Math.random()*maxR*0.1,
      maxR,
      speed,
      life: Math.random(),
      size: 1+Math.random()*2
    };
  }

  function updateParticles(dt){
    const dr = dt * 120; // radial velocity scaling
    for(let p of particles){
      p.radius += p.speed * dr;
      p.life   += dt * 0.6;
      if(p.radius > p.maxR || p.life>1){
        Object.assign(p, makeParticle());
      }
    }
  }

  function drawParticles(){
    ctx.save();
    ctx.translate(cx, cy+20); // slight offset to ship center
    for(let p of particles){
      const x = Math.cos(p.angle)*p.radius;
      const y = Math.sin(p.angle)*p.radius*0.8; // slight elliptic
      const alpha = 1 - (p.radius / p.maxR);
      ctx.globalAlpha = alpha * 0.9;
      ctx.beginPath();
      ctx.arc(x, y, p.size, 0, Math.PI*2);
      ctx.fillStyle = "rgba(190,245,255,1)";
      ctx.fill();
    }
    ctx.restore();
  }

  // main animation loop
  let start = null;
  function frame(timestamp){
    if(!start) start = timestamp;
    const t  = (timestamp-start)/1000;
    const dt = (timestamp-lastT)/1000 || 0;
    lastT = timestamp;

    // background
    ctx.clearRect(0,0,w,h);

    // draw ship background centered
    if(bg.complete){
      const scale = Math.min(w/bg.width, h/bg.height)*0.85;
      const bw = bg.width * scale;
      const bh = bg.height* scale;
      const bx = cx - bw/2;
      const by = cy - bh/2;
      ctx.globalAlpha = 0.9;
      ctx.drawImage(bg, bx, by, bw, bh);
      ctx.globalAlpha = 1;
    }

    // warp field circle
    const pulse = 0.15*Math.sin(t*2.3)+0.85; // 0.7..1.0
    const fieldR = 170 * pulse;
    ctx.save();
    ctx.translate(cx, cy+20);
    const grd = ctx.createRadialGradient(0,0,fieldR*0.1, 0,0,fieldR);
    grd.addColorStop(0, "rgba(200,250,255,0.7)");
    grd.addColorStop(0.35,"rgba(140,210,255,0.35)");
    grd.addColorStop(1, "rgba(20,40,90,0)");
    ctx.fillStyle = grd;
    ctx.beginPath();
    ctx.arc(0,0,fieldR,0,Math.PI*2);
    ctx.fill();
    ctx.restore();

    // core pulse (fission conversion region)
    ctx.save();
    ctx.translate(cx, cy+20);
    const coreR = 16 + 6*Math.sin(t*6.0);
    // inner bright core
    ctx.beginPath();
    ctx.fillStyle = "rgba(255,255,255,0.95)";
    ctx.arc(0,0,coreR*0.55,0,Math.PI*2);
    ctx.fill();
    // hot corona
    const coronaR = coreR*1.8;
    const cgrad = ctx.createRadialGradient(0,0,coreR*0.2,0,0,coronaR);
    cgrad.addColorStop(0,"rgba(255,255,255,0.9)");
    cgrad.addColorStop(0.4,"rgba(255,210,160,0.7)");
    cgrad.addColorStop(1,"rgba(255,120,80,0)");
    ctx.fillStyle = cgrad;
    ctx.beginPath();
    ctx.arc(0,0,coronaR,0,Math.PI*2);
    ctx.fill();

    // radial energy beams (toward warp coils)
    const beamCount = 6;
    for(let i=0;i<beamCount;i++){
      const a = (i/beamCount)*Math.PI*2 + t*0.8;
      const len = 140 + 30*Math.sin(t*3+i);
      const x = Math.cos(a)*len;
      const y = Math.sin(a)*len*0.8;
      ctx.strokeStyle = "rgba(255,200,140,0.9)";
      ctx.lineWidth = 1.2;
      ctx.beginPath();
      ctx.moveTo(0,0);
      ctx.lineTo(x,y);
      ctx.stroke();
    }

    ctx.restore();

    // update and draw particles
    updateParticles(dt);
    drawParticles();

    // CST time display
    updateCSThud(t);

    requestAnimationFrame(frame);
  }

  function pad(n){ return n<10 ? "0"+n : ""+n; }

  function updateCSThud(t){
    const el = document.getElementById('cstTime');
    const st = document.getElementById('cstStatus');

    // treat real clock as CST base, add slight phase offset from animation time
    const now = new Date();
    // simple: CST = UTC-6; adjust without worrying about DST
    const utc = now.getTime() + now.getTimezoneOffset()*60000;
    const cstDate = new Date(utc - 6*3600000);

    const hrs = pad(cstDate.getHours());
    const min = pad(cstDate.getMinutes());
    const sec = pad(cstDate.getSeconds());
    el.textContent = `${hrs}:${min}:${sec}`;

    const phase = (Math.sin(t*0.7)+1)/2; // 0..1
    if(phase<0.33){
      st.textContent = "Warp Field: Charging • Fission banks warming";
    }else if(phase<0.66){
      st.textContent = "Warp Field: Stable • CST phase-locked";
    }else{
      st.textContent = "Warp Field: Gradient Trim • Mass flux balancing";
    }
  }

  initParticles();
  requestAnimationFrame(frame);
})();
</script>
</body>
</html>
