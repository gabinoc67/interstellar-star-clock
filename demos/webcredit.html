<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Facts-Only Live RSS Monitor</title>

<style>
:root{
  --bg:#070b14;
  --panel:#0f172a;
  --ink:#e5e7eb;
  --muted:#9aa4c7;
  --accent:#60a5fa;
  --good:#34d399;
  --warn:#fbbf24;
  --bad:#fb7185;
  --line:rgba(148,163,184,.25);
  --radius:16px;
  --mono: ui-monospace, Consolas, monospace;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font-family:system-ui,Segoe UI,Roboto,Arial;
}
.wrap{max-width:1200px;margin:20px auto;padding:14px}
.card{
  background:var(--panel);
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:14px;
  margin-bottom:14px;
}
h1{margin:0 0 8px;font-size:22px}
.row{display:flex;gap:10px;flex-wrap:wrap}
input,textarea,select,button{
  background:#020617;
  color:var(--ink);
  border:1px solid var(--line);
  border-radius:10px;
  padding:8px 10px;
}
textarea{min-height:130px;width:100%;font-family:var(--mono)}
button{
  background:linear-gradient(180deg,#60a5fa,#3b82f6);
  color:#020617;
  font-weight:800;
  cursor:pointer;
}
button.secondary{
  background:#111827;
  color:var(--ink);
}
table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}
th,td{
  border-bottom:1px solid var(--line);
  padding:8px;
  vertical-align:top;
}
th{color:var(--muted);font-size:11px;text-transform:uppercase}
.status{
  font-family:var(--mono);
  font-size:12px;
  white-space:pre-wrap;
  color:var(--muted);
}
.tag{
  padding:3px 8px;
  border-radius:999px;
  font-size:11px;
  border:1px solid var(--line);
}
.good{color:var(--good)}
.warn{color:var(--warn)}
.bad{color:var(--bad)}
</style>
</head>
<body>

<div class="wrap">
  <h1>Facts-Only Live RSS Monitor</h1>

  <div class="card">
    <div class="row">
      <input id="query" placeholder='keywords / hashtags (earthquake #tsunami nasa)' style="flex:1"/>
      <select id="mode">
        <option value="proxy">CORS Proxy</option>
        <option value="direct">Direct</option>
      </select>
    </div>

    <div class="row" style="margin-top:10px">
      <button id="btnStart">Start</button>
      <button id="btnPause" class="secondary">Pause</button>
      <button id="btnStop" class="secondary">Stop</button>
      <button id="btnReset" class="secondary">Reset</button>
    </div>
  </div>
  <div class="card">
    <h3>RSS Feeds (one per line)</h3>
    <textarea id="feeds"></textarea>
  </div>

  <div class="card">
    <h3>Articles (live)</h3>
    <table>
      <thead>
        <tr>
          <th>Status</th>
          <th>Article</th>
          <th>Source</th>
        </tr>
      </thead>
      <tbody id="results">
        <tr><td colspan="3" class="muted">Waitingâ€¦</td></tr>
      </tbody>
    </table>
  </div>

  <div class="card status" id="status">Idle.</div>
</div>

<script>
const DEFAULT_FEEDS = [
 "https://feeds.bbci.co.uk/news/world/rss.xml",
 "https://feeds.npr.org/1004/rss.xml",
 "https://www.usgs.gov/feeds/earthquakes/feed",
 "https://www.noaa.gov/rss.xml",
 "https://www.nasa.gov/rss/dyn/breaking_news.rss"
].join("\n");

const TRUST = {
 "usgs.gov":95,"noaa.gov":95,"nasa.gov":95,
 "bbc.co.uk":85,"npr.org":85
};

let timer = null;
let paused = false;

const $ = id => document.getElementById(id);

function setStatus(t){ $("status").textContent = t; }
function host(u){ try{return new URL(u).host}catch{return""} }
function norm(s){ return (s||"").toLowerCase(); }

function scoreItem(item, keys){
 let score = 0;
 keys.forEach(k=>{
  if(norm(item.title).includes(k)) score+=3;
  if(norm(item.desc).includes(k)) score+=2;
  if(k.startsWith("#") && norm(item.desc).includes(k.slice(1))) score+=2;
  if(norm(item.host).includes(k)) score+=1;
 });
 const trust = TRUST[item.host]||50;
 return {score, trust, final: score*(trust/100)};
}

async function fetchFeed(url){
 const u = $("mode").value==="proxy"
 ? "https://api.allorigins.win/raw?url="+encodeURIComponent(url)
 : url;
 const r = await fetch(u);
 const t = await r.text();
 const d = new DOMParser().parseFromString(t,"text/xml");
 return [...d.querySelectorAll("item")].map(it=>({
  title: it.querySelector("title")?.textContent||"",
  link: it.querySelector("link")?.textContent||"",
  desc: it.querySelector("description")?.textContent||"",
 }));
}
async function runCycle(){
 if(paused) return;
 const keys = norm($("query").value).split(/\s+/).filter(Boolean);
 const feeds = $("feeds").value.split("\n").map(s=>s.trim()).filter(Boolean);
 let rows = [];
 let fetched = 0;

 for(const f of feeds){
  try{
   const items = await fetchFeed(f);
   fetched += items.length;
   items.forEach(it=>{
    const h = host(it.link)||host(f);
    const s = scoreItem({...it,host:h}, keys);
    if(s.score>0){
     rows.push({...it,host:h,...s});
    }
   });
  }catch(e){}
 }

 rows.sort((a,b)=>b.final-a.final);
 const tb = $("results");
 tb.innerHTML = rows.slice(0,50).map(r=>`
  <tr>
   <td class="${r.trust>=85?"good":"warn"}">${r.trust>=85?"Verified":"Likely"}</td>
   <td><a href="${r.link}" target="_blank">${r.title}</a></td>
   <td>${r.host}</td>
  </tr>
 `).join("") || `<tr><td colspan="3">No matches</td></tr>`;

 setStatus(`Live search running
Feeds: ${feeds.length}
Fetched: ${fetched}
Shown: ${rows.length}`);
}

$("btnStart").onclick=()=>{
 if(timer) return;
 paused=false;
 runCycle();
 timer=setInterval(runCycle,15000);
 setStatus("Started live search.");
};

$("btnPause").onclick=()=>{
 paused=!paused;
 setStatus(paused?"Paused.":"Resumed.");
};

$("btnStop").onclick=()=>{
 clearInterval(timer);
 timer=null;
 setStatus("Stopped.");
};

$("btnReset").onclick=()=>{
 clearInterval(timer);
 timer=null;
 paused=false;
 $("feeds").value=DEFAULT_FEEDS;
 $("results").innerHTML=`<tr><td colspan="3">Reset.</td></tr>`;
 setStatus("Reset complete. Default feeds restored.");
};

(function init(){
 $("feeds").value=DEFAULT_FEEDS;
})();
</script>

</body>
</html>
