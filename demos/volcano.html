<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Volcano Impact Cosmic Clock Simulator</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #020617;
      color: #e5e7eb;
    }

    header {
      padding: 16px 24px;
      border-bottom: 1px solid rgba(148,163,184,0.4);
      background: radial-gradient(circle at top left, #dc2626 0, #020617 45%, #000 100%);
      color: #e5e7eb;
    }

    header h1 {
      margin: 0 0 4px;
      font-size: 24px;
      letter-spacing: 0.04em;
    }

    header p {
      margin: 2px 0;
      font-size: 13px;
      color: #fecaca;
    }

    .muted {
      color: #9ca3af;
      font-size: 11px;
    }

    .mini {
      font-size: 11px;
    }

    .container {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.7fr);
      gap: 16px;
      padding: 16px 20px 20px;
    }

    .panel {
      background: radial-gradient(circle at top, rgba(239,68,68,0.15), rgba(15,23,42,0.98));
      border-radius: 16px;
      border: 1px solid rgba(148,163,184,0.35);
      box-shadow: 0 18px 45px rgba(15,23,42,0.9);
      padding: 14px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .panel h2 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #e5e7eb;
    }

    .panel h2 span {
      font-size: 18px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      font-size: 12px;
    }

    .controls label {
      font-size: 12px;
      color: #fecaca;
    }

    select, input[type="text"] {
      background: rgba(15,23,42,0.9);
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
      padding: 4px 10px;
      font-size: 12px;
      outline: none;
    }

    select:focus, input[type="text"]:focus {
      border-color: #fb7185;
      box-shadow: 0 0 0 1px rgba(248,113,113,0.7);
    }

    input[type="text"] {
      min-width: 150px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 6px;
      font-size: 12px;
    }

    thead {
      position: sticky;
      top: 0;
      background: linear-gradient(to right, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
      z-index: 1;
    }

    th, td {
      padding: 6px 6px;
      text-align: left;
      border-bottom: 1px solid rgba(127,29,29,0.6);
    }

    th {
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #9ca3af;
    }

    tbody tr {
      cursor: pointer;
      transition: background 0.1s ease, transform 0.08s ease;
    }

    tbody tr:hover {
      background: rgba(239,68,68,0.15);
      transform: translateY(-0.5px);
    }

    tbody tr.active-row {
      background: radial-gradient(circle at left, rgba(248,113,113,0.32), rgba(15,23,42,0.95));
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 1px 7px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid rgba(248,113,113,0.6);
      color: #fed7d7;
      background: rgba(15,23,42,0.8);
      white-space: nowrap;
    }

    .tag-dot {
      width: 5px;
      height: 5px;
      border-radius: 999px;
    }

    .tag-global .tag-dot {
      background: #f97316;
    }

    .tag-regional .tag-dot {
      background: #22c55e;
    }

    .tag-local .tag-dot {
      background: #e5e7eb;
    }

    .tag-season {
      border-color: rgba(244,114,182,0.7);
      color: #f9a8d4;
    }

    .tag-pop {
      border-color: rgba(52,211,153,0.75);
      color: #a7f3d0;
    }

    .tag-vei {
      border-color: rgba(96,165,250,0.8);
      color: #bfdbfe;
    }

    .details-header {
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-bottom: 4px;
    }

    .details-title {
      font-size: 17px;
      font-weight: 600;
    }

    .details-subtitle {
      font-size: 12px;
      color: #9ca3af;
    }

    .coords {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      color: #fecaca;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 4px 0;
    }

    .details-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.25fr) minmax(0, 1.1fr);
      gap: 10px;
      margin-top: 4px;
      font-size: 12px;
    }

    .details-section-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
      margin-bottom: 3px;
    }

    ul {
      padding-left: 16px;
      margin: 3px 0;
    }

    li {
      margin-bottom: 2px;
      line-height: 1.35;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      padding: 1px 7px;
      font-size: 10px;
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
    }

    .badge-super {
      border-color: rgba(249,115,22,0.9);
      color: #fed7aa;
    }

    .badge-large {
      border-color: rgba(59,130,246,0.9);
      color: #bfdbfe;
    }

    .badge-historic {
      border-color: rgba(52,211,153,0.9);
      color: #a7f3d0;
    }

    .scroll {
      max-height: 410px;
      overflow: auto;
      margin: 0 -6px -6px;
      padding: 0 6px 1px;
    }

    @media (max-width: 960px) {
      .container {
        grid-template-columns: minmax(0, 1fr);
      }
      .scroll {
        max-height: 280px;
      }
    }
  </style>
</head>
<body>
<header>
  <h1>Cosmic Clock ‚Äî Major Volcanic Eruptions & People</h1>
  <p>Click an eruption to see where it is, when it happened, whether it shook the whole planet or just its region,
     and what nearby cities and populations it affected (Pompeii, St. Pierre, Armero, etc.).</p>
  <p class="muted mini">
    Global-impact eruptions here include examples like Toba, Tambora, Krakatoa, Pinatubo, Samalas, Huaynaputina,
    Laki, Kuwae and Novarupta. Many dates come from historical records + radiometric dating; for very old events
    we only know approximate ages, not exact day and month.
  </p>
</header>

<div class="container">
  <section class="panel">
    <h2><span>üåã</span> Eruptions</h2>
    <div class="controls">
      <label>
        Scale:
        <select id="scaleFilter">
          <option value="all">All scales</option>
          <option value="Global">Global / hemispheric climate</option>
          <option value="Regional">Regional</option>
          <option value="Local">Local</option>
        </select>
      </label>

      <label>
        Population impact:
        <select id="popFilter">
          <option value="all">Any</option>
          <option value="yes">Cities / populations strongly affected</option>
          <option value="no">Little or no known population impact</option>
        </select>
      </label>

      <label>
        Search:
        <input type="text" id="searchBox" placeholder="name, volcano, country, notes‚Ä¶">
      </label>
    </div>

    <div class="scroll">
      <table>
        <thead>
        <tr>
          <th>Eruption</th>
          <th>Volcano</th>
          <th>Scale</th>
          <th>Lat</th>
          <th>Lon</th>
          <th>Date / Age</th>
        </tr>
        </thead>
        <tbody id="eruptionTableBody"></tbody>
      </table>
    </div>
  </section>

  <section class="panel">
    <h2><span>üß≠</span> Cosmic Clock & Effects</h2>
    <div id="detailsContent">
      <p class="muted">
        Select an eruption on the left to see:
      </p>
      <ul class="muted">
        <li>Latitude, longitude, hemisphere, and latitude band (cosmic clock position)</li>
        <li>Approximate season of the eruption (when the month is known)</li>
        <li>Global vs regional climate effects (volcanic winter, cooling, etc.)</li>
        <li>Nearby cities / populations and how they were affected</li>
      </ul>
    </div>
  </section>
</div>

<script>
  // --- Helper: classify latitude band for the "cosmic clock" position ---
  function latBand(lat) {
    const a = Math.abs(lat);
    if (a < 10) return "Equatorial band (0‚Äì10¬∞)";
    if (a < 23.5) return "Tropical band (10‚Äì23.5¬∞)";
    if (a < 40) return "Subtropical / warm mid-latitudes (23.5‚Äì40¬∞)";
    if (a < 60) return "Mid-latitudes (40‚Äì60¬∞)";
    return "High-latitude / polar (60¬∞+)";
  }

  // --- Helper: infer season from month & hemisphere (cosmic clock season) ---
  function inferSeason(lat, month, explicitSeasonHint) {
    if (explicitSeasonHint) return explicitSeasonHint;
    if (!month || month < 1 || month > 12) return "Season unknown (month not well constrained)";

    const northSeasons = [
      "Winter", "Winter", "Spring", "Spring", "Spring",
      "Summer", "Summer", "Summer", "Autumn", "Autumn", "Autumn", "Winter"
    ];
    const southSeasons = [
      "Summer", "Summer", "Autumn", "Autumn", "Autumn",
      "Winter", "Winter", "Winter", "Spring", "Spring", "Spring", "Summer"
    ];
    const idx = month - 1;
    const hemiNorth = lat >= 0;
    const s = hemiNorth ? northSeasons[idx] : southSeasons[idx];
    return s + " (approximate, based on month & hemisphere)";
  }

  // --- Dataset: curated high-impact eruptions ---
  const eruptions = [
    {
      id: "toba",
      name: "Youngest Toba supereruption",
      volcano: "Toba",
      region: "Sumatra, Indonesia",
      lat: 2.6845,
      lon: 98.8756,
      scale: "Global",
      vei: "8 (super-eruption)",
      dateText: "‚âà74,000 years ago (Late Pleistocene)",
      ageDetail: "VEI 8; ash blanket over much of South Asia; debated but possibly caused a severe volcanic winter and human population bottleneck.",
      month: null,
      explicitSeasonHint: null,
      datingMethod: "Tephrochronology, radiometric dating of volcanic deposits, ice cores and marine sediments.",
      climateImpact: "One of the largest known eruptions; likely caused strong, multi-year global cooling and environmental stress.",
      nearbySettlements: "Occurred long before cities; affected early Homo sapiens populations, especially in South Asia.",
      humanImpact: "Hypothesized sharp reduction of human population size (bottleneck), though severity is debated.",
      populationEffectFlag: true,
      notes: "Key deep-time anchor for your cosmic clock; global-scale disruption of climate and biosphere."
    },
    {
      id: "tambora",
      name: "1815 eruption of Mount Tambora",
      volcano: "Mount Tambora",
      region: "Sumbawa, Indonesia",
      lat: -8.25,
      lon: 118.0,
      scale: "Global",
      vei: "7",
      dateText: "10‚Äì11 April 1815",
      ageDetail: "Triggered the 1816 ‚ÄúYear Without a Summer‚Äù; global land temperatures dropped ‚âà0.4‚Äì1.0 ¬∞C.",
      month: 4,
      explicitSeasonHint: null,
      datingMethod: "Historical records, eyewitness accounts, ice cores, tree rings, instrumental climate data.",
      climateImpact: "Strong global cooling; crop failures and food crises in Europe, North America, and parts of Asia.",
      nearbySettlements: "Destroyed villages on Sumbawa and nearby islands; heavy casualties in Indonesia.",
      humanImpact: "Tens of thousands killed locally; worldwide harvest failures and migrations driven by cold, famine and economic stress.",
      populationEffectFlag: true,
      notes: "One of the clearest examples of a volcano driving global climate shock in modern history."
    },
    {
      id: "krakatoa",
      name: "1883 Krakatoa eruption",
      volcano: "Krakatoa (Krakatau)",
      region: "Sunda Strait, Indonesia",
      lat: -6.102,
      lon: 105.423,
      scale: "Global",
      vei: "6",
      dateText: "26‚Äì27 August 1883",
      ageDetail: "Produced a volcanic winter; Northern Hemisphere summers cooled by ‚âà0.4 ¬∞C.",
      month: 8,
      explicitSeasonHint: null,
      datingMethod: "Tide gauges, barographs, global weather records, ship logs, and later ice-core data.",
      climateImpact: "Short-lived global cooling, spectacular sunsets worldwide, disturbances in weather patterns.",
      nearbySettlements: "Tsunamis devastated coastal towns in Java and Sumatra; tens of thousands killed.",
      humanImpact: "Annihilated many coastal communities; shock waves circled the globe multiple times.",
      populationEffectFlag: true,
      notes: "Classic example of explosive island-arc volcanism with strong atmospheric and oceanic impacts."
    },
    {
      id: "pinatubo",
      name: "1991 eruption of Mount Pinatubo",
      volcano: "Mount Pinatubo",
      region: "Luzon, Philippines",
      lat: 15.13,
      lon: 120.35,
      scale: "Global",
      vei: "6",
      dateText: "June 15, 1991 (paroxysm)",
      ageDetail: "Injected ‚âà17‚Äì20 megatons of SO‚ÇÇ into the stratosphere; cooled global temperatures by ‚âà0.5 ¬∞C (1991‚Äì1993).",
      month: 6,
      explicitSeasonHint: null,
      datingMethod: "Satellite observations, aerosol measurements, climate models, instrumental records.",
      climateImpact: "Clear global cooling over several years; major test case for volcanic forcing in climate models.",
      nearbySettlements: "Affected Clark Air Base, surrounding towns in Zambales, Tarlac and Pampanga; heavy ash and lahars.",
      humanImpact: "Hundreds killed, ~20,000+ evacuated; long-term resettlement of communities due to lahars.",
      populationEffectFlag: true,
      notes: "Modern, well-instrumented eruption; key volcano for calibrating your climate layer in the cosmic clock."
    },
    {
      id: "samalas",
      name: "1257 Samalas eruption",
      volcano: "Samalas (Rinjani complex)",
      region: "Lombok, Indonesia",
      lat: -8.39,
      lon: 116.47,
      scale: "Global",
      vei: "7",
      dateText: "‚âà1257 CE",
      ageDetail: "Largest stratospheric gas injection of the Common Era; massive sulfate spikes in ice cores.",
      month: null,
      explicitSeasonHint: null,
      datingMethod: "Ice cores (sulfate), historical chronicles, tephra correlations, radiocarbon.",
      climateImpact: "Major global cooling; likely caused years of unusually cold summers and harvest failures, especially in the Northern Hemisphere.",
      nearbySettlements: "Devastated local populations on Lombok and nearby islands; tsunami and ashfall impacts.",
      humanImpact: "Likely strong disruptions to agriculture and societies across Eurasia, though details are still being reconstructed.",
      populationEffectFlag: true,
      notes: "A prime candidate for multi-year climatic stress on medieval societies."
    },
    {
      id: "huaynaputina",
      name: "1600 Huaynaputina eruption",
      volcano: "Huaynaputina",
      region: "Southern Peru, Central Andes",
      lat: -16.61,
      lon: -70.85,
      scale: "Global",
      vei: "6",
      dateText: "19 February 1600 and following days",
      ageDetail: "Largest historical eruption in South America; strong, prolonged cooling in the North Atlantic region.",
      month: 2,
      explicitSeasonHint: null,
      datingMethod: "Historical accounts, tephra mapping, radiocarbon, climate reconstructions.",
      climateImpact: "Exceptional cold summers and winters in the early 1600s; crop failures and famines in parts of Europe and Russia.",
      nearbySettlements: "Buried multiple Andean villages; ash falls and lahars devastated regional agriculture.",
      humanImpact: "Severe regional mortality and social stress; famine and economic crises observed in several countries.",
      populationEffectFlag: true,
      notes: "Important for linking tropical eruptions to Northern Hemisphere climate anomalies."
    },
    {
      id: "laki",
      name: "1783‚Äì1784 Laki fissure eruption",
      volcano: "Laki / Gr√≠msv√∂tn system",
      region: "Iceland",
      lat: 64.0,
      lon: -17.0,
      scale: "Global",
      vei: "6 (huge SO‚ÇÇ output)",
      dateText: "June 1783 ‚Äì February 1784",
      ageDetail: "Emitted ‚âà120 million tonnes of SO‚ÇÇ; major haze over Europe and climate impacts.",
      month: 6,
      explicitSeasonHint: null,
      datingMethod: "Historical records, ice cores, geologic mapping, climate modeling.",
      climateImpact: "Cooling and weather anomalies in Europe; possible drought impacts in India and North Africa.",
      nearbySettlements: "Catastrophic mortality of livestock in Iceland; famine killed a large fraction of Iceland‚Äôs population.",
      humanImpact: "Mass deaths in Iceland; respiratory and crop impacts reported across Europe (‚ÄúLaki haze‚Äù).",
      populationEffectFlag: true,
      notes: "Great example of a high-latitude fissure eruption with big atmospheric chemistry effects."
    },
    {
      id: "kuwae",
      name: "Mid-15th century Kuwae eruption",
      volcano: "Kuwae caldera",
      region: "Vanuatu (central Pacific)",
      lat: -16.83,
      lon: 168.54,
      scale: "Global",
      vei: "likely 6‚Äì7",
      dateText: "‚âà1458‚Äì1459 CE (approx.)",
      ageDetail: "Large tropical eruption linked to strong sulfate spikes in ice cores and environmental devastation in Vanuatu.",
      month: null,
      explicitSeasonHint: null,
      datingMethod: "Ice cores, radiocarbon, oral traditions and geological fieldwork on Kuwae.",
      climateImpact: "Likely hemispheric to global cooling for several years; part of a cluster of strong 15th-century eruptions.",
      nearbySettlements: "Southern and central Kuwae islands were likely depopulated; survivors sought refuge on nearby islands.",
      humanImpact: "Regional population displacement and cultural change in Vanuatu; no written city records, but strong oral histories.",
      populationEffectFlag: true,
      notes: "Nice bridge between climate proxies and indigenous oral tradition in your model."
    },
    {
      id: "novarupta",
      name: "1912 Novarupta / Katmai eruption",
      volcano: "Novarupta",
      region: "Alaska Peninsula, USA",
      lat: 58.27,
      lon: -155.16,
      scale: "Global",
      vei: "6",
      dateText: "6‚Äì9 June 1912",
      ageDetail: "Largest eruption of the 20th century by volume; ash and sulfate spread across the Northern Hemisphere.",
      month: 6,
      explicitSeasonHint: null,
      datingMethod: "Geologic mapping, eyewitness accounts, atmospheric observations, ice cores, tree rings.",
      climateImpact: "Short-term cooling and hazy skies across parts of the Northern Hemisphere; cold summer of 1912 observed.",
      nearbySettlements: "Ash >30 cm deep at Kodiak; villages and ecosystems in the Katmai region heavily impacted.",
      humanImpact: "Low human death toll due to sparse population, but major displacement and long-term ecological change.",
      populationEffectFlag: true,
      notes: "Volcanic ‚ÄúValley of Ten Thousand Smokes‚Äù; great case for regional-to-hemispheric aerosol forcing."
    },
    {
      id: "vesuvius79",
      name: "79 CE eruption of Vesuvius",
      volcano: "Mount Vesuvius",
      region: "Campania, Italy",
      lat: 40.82,
      lon: 14.43,
      scale: "Regional",
      vei: "5",
      dateText: "24‚Äì25 August 79 CE (traditional date)",
      ageDetail: "Plinian + pyroclastic surges; buried Pompeii, Herculaneum, Oplontis and Stabiae.",
      month: 8,
      explicitSeasonHint: null,
      datingMethod: "Classical texts (Pliny the Younger), archaeology, tephra stratigraphy; exact calendar date still debated.",
      climateImpact: "Primarily regional; no clear evidence of major global climate shift.",
      nearbySettlements: "Destroyed Pompeii and Herculaneum completely; heavy damage to surrounding Bay of Naples towns.",
      humanImpact: "Thousands killed; survivors resettled in other Roman towns; region reconstructed but cities never fully recovered their prior form.",
      populationEffectFlag: true,
      notes: "Iconic example of city-scale annihilation; perfect tie-in to your ancient city cosmic clock layer."
    },
    {
      id: "thera",
      name: "Minoan eruption of Thera",
      volcano: "Thera (Santorini)",
      region: "Aegean Sea, Greece",
      lat: 36.40,
      lon: 25.40,
      scale: "Regional",
      vei: "7 (est.)",
      dateText: "‚âà1600‚Äì1500 BCE",
      ageDetail: "Massive Plinian eruption; tsunamis and ash devastated Akrotiri on Thera and coastal Minoan sites.",
      month: null,
      explicitSeasonHint: null,
      datingMethod: "Radiocarbon (tree rings, seeds), tephra layers, archaeological synchronisms with Egypt and the Near East.",
      climateImpact: "Likely caused short-term regional cooling and crop disruption around the Eastern Mediterranean.",
      nearbySettlements: "Akrotiri destroyed; coastal settlements on Crete and other islands heavily damaged by tsunami and ash.",
      humanImpact: "Contributed to stress on Minoan civilization; may have triggered cultural and political shifts in the Aegean.",
      populationEffectFlag: true,
      notes: "Important for your Bronze Age city network and any collapse/transition patterns you model."
    },
    {
      id: "pelee1902",
      name: "1902 eruption of Mount Pel√©e",
      volcano: "Mount Pel√©e",
      region: "Martinique, Caribbean",
      lat: 14.81,
      lon: -61.17,
      scale: "Regional",
      vei: "4",
      dateText: "8 May 1902 (climactic blast) ‚Äì 1905",
      ageDetail: "Deadliest eruption of the 20th century; pyroclastic surge annihilated St. Pierre.",
      month: 5,
      explicitSeasonHint: null,
      datingMethod: "Historical observation, geologic mapping, eyewitness testimony.",
      climateImpact: "Mostly regional atmospheric effects; no strong global climate anomaly attributed.",
      nearbySettlements: "St. Pierre (‚âà28,000 people) destroyed in minutes; very few survivors.",
      humanImpact: "City-scale extinction event; major demographic and economic shock for Martinique.",
      populationEffectFlag: true,
      notes: "A perfect example of local cosmic-clock catastrophe: limited climate impact but extreme human impact."
    },
    {
      id: "nevado",
      name: "1985 Nevado del Ruiz eruption (Armero tragedy)",
      volcano: "Nevado del Ruiz",
      region: "Tolima, Colombia",
      lat: 4.89,
      lon: -75.32,
      scale: "Local",
      vei: "3 (small but deadly)",
      dateText: "13 November 1985",
      ageDetail: "Small explosive eruption melting summit ice; lahars destroyed Armero.",
      month: 11,
      explicitSeasonHint: null,
      datingMethod: "Instrumental monitoring, eyewitnesses, geologic mapping; well constrained in time.",
      climateImpact: "Negligible globally; local atmospheric effects only.",
      nearbySettlements: "Town of Armero (~25,000 residents) buried in lahars; ~23,000 deaths.",
      humanImpact: "One of the worst lahar disasters; massive regional trauma and relocation of survivors.",
      populationEffectFlag: true,
      notes: "Shows that even modest eruptions on glaciated peaks can cause extreme human disasters without global climate signals."
    },
    {
      id: "sthelens1980",
      name: "1980 Mount St. Helens eruption",
      volcano: "Mount St. Helens",
      region: "Washington State, USA",
      lat: 46.20,
      lon: -122.18,
      scale: "Regional",
      vei: "5",
      dateText: "18 May 1980",
      ageDetail: "Lateral blast, giant landslide, ash over much of western North America.",
      month: 5,
      explicitSeasonHint: null,
      datingMethod: "Dense instrumental data, eyewitness observations, satellite and aircraft imagery.",
      climateImpact: "Minor and short-term climate signal compared to Pinatubo; mainly regional ash and haze.",
      nearbySettlements: "Logging camps, recreation areas, and infrastructure destroyed; ashfall disrupted cities across several states.",
      humanImpact: "57 deaths, large economic damage; major changes to land use and hazard planning.",
      populationEffectFlag: true,
      notes: "Crucial teaching example: dramatic local/regional impact, but limited global climate effect."
    },
    {
      id: "hunga_tonga_2022",
      name: "2022 Hunga Tonga‚ÄìHunga Ha ªapai eruption",
      volcano: "Hunga Tonga‚ÄìHunga Ha ªapai",
      region: "Tonga, southwest Pacific",
      lat: -20.55,
      lon: -175.39,
      scale: "Global",
      vei: "5‚Äì6 (very powerful submarine explosion)",
      dateText: "15 January 2022",
      ageDetail: "Largest 21st-century eruption so far; record-breaking stratospheric plume and pressure waves.",
      month: 1,
      explicitSeasonHint: null,
      datingMethod: "Satellites, infrasound, tsunami gauges, atmospheric sensors.",
      climateImpact: "Unusual: injected enormous water vapor into the stratosphere; long-term net impact on global temperature is still being studied.",
      nearbySettlements: "Tsunami and ash devastated parts of Tonga; communications and infrastructure heavily damaged.",
      humanImpact: "Regional damage to islands and infrastructure; global telecom disruptions via submarine cables.",
      populationEffectFlag: true,
      notes: "Modern reminder for your simulator that future eruptions can affect both climate and global technology systems."
    }
  ];

  // --- Table rendering ---
  const tbody = document.getElementById("eruptionTableBody");
  const detailsContent = document.getElementById("detailsContent");
  const scaleFilter = document.getElementById("scaleFilter");
  const popFilter = document.getElementById("popFilter");
  const searchBox = document.getElementById("searchBox");

  function scaleTagClass(scale) {
    if (scale === "Global") return "tag tag-global";
    if (scale === "Regional") return "tag tag-regional";
    return "tag tag-local";
  }

  function veiBadgeClass(vei) {
    if (vei.includes("8")) return "badge badge-super";
    if (vei.includes("7") || vei.includes("6")) return "badge badge-large";
    return "badge badge-historic";
  }

  function renderTable() {
    const scale = scaleFilter.value;
    const pop = popFilter.value;
    const q = (searchBox.value || "").toLowerCase();

    tbody.innerHTML = "";

    const filtered = eruptions.filter(ev => {
      if (scale !== "all" && ev.scale !== scale) return false;
      if (pop === "yes" && !ev.populationEffectFlag) return false;
      if (pop === "no" && ev.populationEffectFlag) return false;

      if (q) {
        const hay = (ev.name + " " + ev.volcano + " " + ev.region + " " + ev.notes).toLowerCase();
        if (!hay.includes(q)) return false;
      }
      return true;
    });

    filtered.forEach(ev => {
      const tr = document.createElement("tr");
      tr.dataset.id = ev.id;

      const tdName = document.createElement("td");
      tdName.textContent = ev.name;

      const tdVolcano = document.createElement("td");
      tdVolcano.textContent = ev.volcano;

      const tdScale = document.createElement("td");
      const spanScale = document.createElement("span");
      spanScale.className = scaleTagClass(ev.scale);
      const dot = document.createElement("span");
      dot.className = "tag-dot";
      const label = document.createElement("span");
      label.textContent = ev.scale;
      spanScale.appendChild(dot);
      spanScale.appendChild(label);
      tdScale.appendChild(spanScale);

      const tdLat = document.createElement("td");
      tdLat.textContent = ev.lat.toFixed(2);

      const tdLon = document.createElement("td");
      tdLon.textContent = ev.lon.toFixed(2);

      const tdDate = document.createElement("td");
      tdDate.textContent = ev.dateText;

      tr.appendChild(tdName);
      tr.appendChild(tdVolcano);
      tr.appendChild(tdScale);
      tr.appendChild(tdLat);
      tr.appendChild(tdLon);
      tr.appendChild(tdDate);

      tr.addEventListener("click", () => {
        document.querySelectorAll("#eruptionTableBody tr").forEach(r => r.classList.remove("active-row"));
        tr.classList.add("active-row");
        renderDetails(ev);
      });

      tbody.appendChild(tr);
    });

    if (!filtered.length) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.colSpan = 6;
      td.className = "muted";
      td.textContent = "No eruptions match the current filters.";
      tr.appendChild(td);
      tbody.appendChild(tr);
    }
  }

  function renderDetails(ev) {
    const hemisphere = ev.lat >= 0 ? "Northern" : "Southern";
    const band = latBand(ev.lat);
    const season = inferSeason(ev.lat, ev.month, ev.explicitSeasonHint);

    const badgeClass = veiBadgeClass(ev.vei);
    const popTag = ev.populationEffectFlag
      ? `<span class="tag tag-pop"><span class="tag-dot" style="background:#22c55e;"></span><span>Strong population impact</span></span>`
      : `<span class="tag tag-pop"><span class="tag-dot" style="background:#4b5563;"></span><span>Limited population impact</span></span>`;

    const seasonTag = `<span class="tag tag-season"><span class="tag-dot" style="background:#f472b6;"></span><span>${season}</span></span>`;

    detailsContent.innerHTML = `
      <div class="details-header">
        <div class="details-title">${ev.name}</div>
        <div class="details-subtitle">${ev.volcano} ‚Äî ${ev.region}</div>
        <div class="coords">Lat ${ev.lat.toFixed(4)}¬∞, Lon ${ev.lon.toFixed(4)}¬∞ (${hemisphere} Hemisphere)</div>
      </div>

      <div class="pill-row">
        <div class="${scaleTagClass(ev.scale)}">
          <span class="tag-dot"></span>
          <span>${ev.scale} impact scale</span>
        </div>
        <span class="${badgeClass}">VEI: ${ev.vei}</span>
        ${seasonTag}
        ${popTag}
      </div>

      <div class="details-grid">
        <div>
          <div class="details-section-title">Cosmic Clock Position</div>
          <ul>
            <li><strong>Latitude band:</strong> ${band}</li>
            <li><strong>Hemisphere:</strong> ${hemisphere} Hemisphere</li>
            <li><strong>Season inference:</strong> ${season}</li>
            <li><strong>Eruption summary:</strong> ${ev.ageDetail}</li>
          </ul>

          <div class="details-section-title">Dating &amp; Chronology</div>
          <ul>
            <li><strong>Date / age used:</strong> ${ev.dateText}</li>
            <li><strong>Dating methods:</strong> ${ev.datingMethod}</li>
          </ul>
        </div>

        <div>
          <div class="details-section-title">Climate &amp; Population Effects</div>
          <ul>
            <li><strong>Climate / environmental impact:</strong> ${ev.climateImpact}</li>
            <li><strong>Nearby cities / populations:</strong> ${ev.nearbySettlements}</li>
            <li><strong>Human impact:</strong> ${ev.humanImpact}</li>
          </ul>

          <div class="details-section-title">Notes</div>
          <p class="mini">${ev.notes}</p>
        </div>
      </div>

      <p class="muted mini" style="margin-top:6px;">
        Here the ‚Äúcosmic clock‚Äù connects each eruption‚Äôs latitude, hemisphere and season to its role in Earth‚Äôs
        annual energy cycle. Global-scale eruptions inject sulfur and ash high into the atmosphere, shifting the
        clock for whole decades; regional eruptions mostly show up as local trauma and city abandonment.
      </p>
    `;
  }

  // Wire up filters
  scaleFilter.addEventListener("change", renderTable);
  popFilter.addEventListener("change", renderTable);
  searchBox.addEventListener("input", renderTable);

  // Initial render
  renderTable();
</script>
</body>
</html>
