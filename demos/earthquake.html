<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Earthquake & Tsunami Cosmic Clock Simulator</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #020617;
      color: #e5e7eb;
    }

    header {
      padding: 16px 24px;
      border-bottom: 1px solid rgba(148,163,184,0.4);
      background: radial-gradient(circle at top left, #0ea5e9 0, #020617 45%, #000 100%);
      color: #e5e7eb;
    }

    header h1 {
      margin: 0 0 4px;
      font-size: 24px;
      letter-spacing: 0.04em;
    }

    header p {
      margin: 2px 0;
      font-size: 13px;
      color: #bae6fd;
    }

    .muted {
      color: #9ca3af;
      font-size: 11px;
    }

    .mini {
      font-size: 11px;
    }

    .container {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.7fr);
      gap: 16px;
      padding: 16px 20px 20px;
    }

    .panel {
      background: radial-gradient(circle at top, rgba(56,189,248,0.15), rgba(15,23,42,0.98));
      border-radius: 16px;
      border: 1px solid rgba(148,163,184,0.35);
      box-shadow: 0 18px 45px rgba(15,23,42,0.9);
      padding: 14px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .panel h2 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #e5e7eb;
    }

    .panel h2 span {
      font-size: 18px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      font-size: 12px;
    }

    .controls label {
      font-size: 12px;
      color: #bae6fd;
    }

    select, input[type="text"] {
      background: rgba(15,23,42,0.9);
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
      padding: 4px 10px;
      font-size: 12px;
      outline: none;
    }

    select:focus, input[type="text"]:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 1px rgba(56,189,248,0.7);
    }

    input[type="text"] {
      min-width: 150px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 6px;
      font-size: 12px;
    }

    thead {
      position: sticky;
      top: 0;
      background: linear-gradient(to right, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
      z-index: 1;
    }

    th, td {
      padding: 6px 6px;
      text-align: left;
      border-bottom: 1px solid rgba(15,118,110,0.7);
    }

    th {
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #9ca3af;
    }

    tbody tr {
      cursor: pointer;
      transition: background 0.1s ease, transform 0.08s ease;
    }

    tbody tr:hover {
      background: rgba(56,189,248,0.15);
      transform: translateY(-0.5px);
    }

    tbody tr.active-row {
      background: radial-gradient(circle at left, rgba(45,212,191,0.32), rgba(15,23,42,0.95));
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 1px 7px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid rgba(56,189,248,0.7);
      color: #bae6fd;
      background: rgba(15,23,42,0.8);
      white-space: nowrap;
    }

    .tag-dot {
      width: 5px;
      height: 5px;
      border-radius: 999px;
    }

    .tag-global .tag-dot {
      background: #f97316;
    }

    .tag-regional .tag-dot {
      background: #22c55e;
    }

    .tag-local .tag-dot {
      background: #e5e7eb;
    }

    .tag-tsu {
      border-color: rgba(252,165,165,0.8);
      color: #fecaca;
    }

    .tag-season {
      border-color: rgba(244,114,182,0.7);
      color: #f9a8d4;
    }

    .tag-pop {
      border-color: rgba(52,211,153,0.75);
      color: #a7f3d0;
    }

    .details-header {
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-bottom: 4px;
    }

    .details-title {
      font-size: 17px;
      font-weight: 600;
    }

    .details-subtitle {
      font-size: 12px;
      color: #9ca3af;
    }

    .coords {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      color: #bae6fd;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 4px 0;
    }

    .details-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.25fr) minmax(0, 1.1fr);
      gap: 10px;
      margin-top: 4px;
      font-size: 12px;
    }

    .details-section-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
      margin-bottom: 3px;
    }

    ul {
      padding-left: 16px;
      margin: 3px 0;
    }

    li {
      margin-bottom: 2px;
      line-height: 1.35;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      padding: 1px 7px;
      font-size: 10px;
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
    }

    .badge-mega {
      border-color: rgba(249,115,22,0.9);
      color: #fed7aa;
    }

    .badge-large {
      border-color: rgba(59,130,246,0.9);
      color: #bfdbfe;
    }

    .badge-historic {
      border-color: rgba(52,211,153,0.9);
      color: #a7f3d0;
    }

    .scroll {
      max-height: 410px;
      overflow: auto;
      margin: 0 -6px -6px;
      padding: 0 6px 1px;
    }

    @media (max-width: 960px) {
      .container {
        grid-template-columns: minmax(0, 1fr);
      }
      .scroll {
        max-height: 280px;
      }
    }
  </style>
</head>
<body>
<header>
  <h1>Earthquake & Tsunami Cosmic Clock Simulator</h1>
  <p>Click an earthquake to see where and when it struck, whether it launched a local or ocean-basin tsunami,
     and how nearby cities and populations were affected.</p>
  <p class="muted mini">
    Note: Earthquakes themselves do not change global climate the way large volcanic eruptions or asteroid impacts do.
    Here ‚Äúglobal‚Äù mainly means ocean-basin tsunamis and world-scale social/economic effects.
  </p>
</header>

<div class="container">
  <section class="panel">
    <h2><span>üåé</span> Earthquakes & Tsunamis</h2>
    <div class="controls">
      <label>
        Impact scale:
        <select id="scaleFilter">
          <option value="all">All scales</option>
          <option value="Global">Global / ocean-basin</option>
          <option value="Regional">Regional</option>
          <option value="Local">Local</option>
        </select>
      </label>

      <label>
        Tsunami:
        <select id="tsuFilter">
          <option value="all">Any</option>
          <option value="none">No tsunami</option>
          <option value="local">Local / regional tsunami</option>
          <option value="basin">Ocean-basin / ‚Äúsuper‚Äù tsunami</option>
        </select>
      </label>

      <label>
        Population impact:
        <select id="popFilter">
          <option value="all">Any</option>
          <option value="yes">Strong population impact</option>
          <option value="no">Limited population impact</option>
        </select>
      </label>

      <label>
        Search:
        <input type="text" id="searchBox" placeholder="name, country, notes‚Ä¶">
      </label>
    </div>

    <div class="scroll">
      <table>
        <thead>
        <tr>
          <th>Event</th>
          <th>Mag</th>
          <th>Scale</th>
          <th>Lat</th>
          <th>Lon</th>
          <th>Date / Age</th>
        </tr>
        </thead>
        <tbody id="quakeTableBody"></tbody>
      </table>
    </div>
  </section>

  <section class="panel">
    <h2><span>üß≠</span> Cosmic Clock & Effects</h2>
    <div id="detailsContent">
      <p class="muted">
        Select an event on the left to see:
      </p>
      <ul class="muted">
        <li>Latitude, longitude, hemisphere, and latitude band (cosmic clock position)</li>
        <li>Approximate season of the main shock (when month is known)</li>
        <li>Whether there was a tsunami (local vs ocean-basin)</li>
        <li>Nearby cities / populations and aftermath (famine, migration, rebuilding, etc.)</li>
      </ul>
    </div>
  </section>
</div>

<script>
  // --- Cosmic clock helpers ---
  function latBand(lat) {
    const a = Math.abs(lat);
    if (a < 10) return "Equatorial band (0‚Äì10¬∞)";
    if (a < 23.5) return "Tropical band (10‚Äì23.5¬∞)";
    if (a < 40) return "Subtropical / warm mid-latitudes (23.5‚Äì40¬∞)";
    if (a < 60) return "Mid-latitudes (40‚Äì60¬∞)";
    return "High-latitude / polar (60¬∞+)";
  }

  function inferSeason(lat, month, explicitSeasonHint) {
    if (explicitSeasonHint) return explicitSeasonHint;
    if (!month || month < 1 || month > 12) return "Season unknown (month not well constrained)";

    const north = [
      "Winter","Winter","Spring","Spring","Spring",
      "Summer","Summer","Summer","Autumn","Autumn","Autumn","Winter"
    ];
    const south = [
      "Summer","Summer","Autumn","Autumn","Autumn",
      "Winter","Winter","Winter","Spring","Spring","Spring","Summer"
    ];
    const idx = month - 1;
    const hemiNorth = lat >= 0;
    const s = hemiNorth ? north[idx] : south[idx];
    return s + " (approximate, based on month & hemisphere)";
  }

  // --- Data: curated earthquakes & tsunamis ---
  // tsunamiExtent: "none" | "local" | "basin"
  const quakes = [
    {
      id: "storegga",
      name: "Storegga submarine slide tsunami",
      region: "Norwegian Sea, off Norway",
      lat: 64.0,
      lon: 4.0,
      magnitude: "triggering quake est. >7",
      scale: "Regional",
      tsunamiExtent: "basin",
      dateText: "‚âà6225‚Äì6170 BCE",
      month: null,
      explicitSeasonHint: null,
      datingMethod: "Radiocarbon on tsunami sediments along Norway, Scotland and North Sea coasts.",
      climateImpact: "No global climate change, but huge tsunami across North Atlantic margins.",
      nearbySettlements: "Mesolithic communities along Norway, Scotland, North Sea (Doggerland coasts).",
      humanImpact: "Likely drowned many coastal settlements; may have killed a large share of Mesolithic coastal population in parts of Britain and accelerated loss of low-lying Doggerland.",
      populationEffectFlag: true,
      notes: "Giant submarine landslide off Norway‚Äôs margin; important candidate for ancient mega-tsunami memory."
    },
    {
      id: "helike",
      name: "373 BCE Helike earthquake & tsunami",
      region: "Gulf of Corinth, Greece",
      lat: 38.15,
      lon: 22.18,
      magnitude: "est. ~7",
      scale: "Regional",
      tsunamiExtent: "local",
      dateText: "Winter 373 BCE",
      month: null,
      explicitSeasonHint: "Winter in Northern Hemisphere (classical sources)",
      datingMethod: "Ancient historical accounts plus submerged ruins & tsunami deposits.",
      climateImpact: "No climate impact; strong local coastal change.",
      nearbySettlements: "City of Helike; other poleis around the Gulf of Corinth.",
      humanImpact: "Helike was destroyed and submerged by quake and tsunami; survivors in nearby cities preserved the story in myth and history.",
      populationEffectFlag: true,
      notes: "Sometimes compared to an ‚ÄòAtlantis-like‚Äô event, but Helike is archaeologically real."
    },
    {
      id: "lisbon1755",
      name: "1755 Lisbon earthquake & tsunami",
      region: "Offshore Portugal, NE Atlantic",
      lat: 38.72,
      lon: -9.14,
      magnitude: "‚âà8.5‚Äì9.0",
      scale: "Global",
      tsunamiExtent: "basin",
      dateText: "1 November 1755",
      month: 11,
      explicitSeasonHint: null,
      datingMethod: "Historical reports, tsunami records, seismotectonic modeling.",
      climateImpact: "No strong global climate change; but basin-wide tsunami and global cultural shock.",
      nearbySettlements: "Lisbon (Portugal), C√°diz (Spain); waves observed as far as Caribbean coasts.",
      humanImpact: "Tens of thousands killed in Lisbon alone; large parts of the city destroyed by shaking, tsunami and fire; influenced European philosophy and earthquake science.",
      populationEffectFlag: true,
      notes: "Classic example of earthquake + tsunami + firestorm. Tsunami crossed the Atlantic with measurable height in the Caribbean."
    },
    {
      id: "cascadia1700",
      name: "1700 Cascadia megathrust",
      region: "Pacific Northwest, North America",
      lat: 45.0,
      lon: -125.0,
      magnitude: "8.7‚Äì9.2",
      scale: "Global",
      tsunamiExtent: "basin",
      dateText: "26 January 1700",
      month: 1,
      explicitSeasonHint: null,
      datingMethod: "Drowned forests on the Pacific NW coast plus ‚Äòorphan tsunami‚Äô records in Japan.",
      climateImpact: "No known global climate effect; powerful Pacific-wide tsunami.",
      nearbySettlements: "Coastal First Nations / Native American villages along Washington, Oregon, British Columbia; Japanese coastal towns.",
      humanImpact: "Many Indigenous communities were killed or displaced; Japanese records describe a damaging tsunami with no felt local quake.",
      populationEffectFlag: true,
      notes: "Great case of linking tree rings, oral tradition and Japanese written records into one event."
    },
    {
      id: "shaanxi1556",
      name: "1556 Shaanxi (Huaxian) earthquake",
      region: "Shaanxi Province, China",
      lat: 34.5,
      lon: 109.7,
      magnitude: "‚âà8.0",
      scale: "Regional",
      tsunamiExtent: "none",
      dateText: "23 January 1556",
      month: 1,
      explicitSeasonHint: null,
      datingMethod: "Historical Chinese records and macroseismic analysis.",
      climateImpact: "No climate effect; purely tectonic continental quake.",
      nearbySettlements: "Densely populated loess-plateau region (yaodong cave dwellings).",
      humanImpact: "Often regarded as deadliest recorded earthquake (~hundreds of thousands killed directly; famine and disease increased the toll). Many survivors migrated.",
      populationEffectFlag: true,
      notes: "Shows how building style and geomorphology (loess caves) can amplify quake deaths without any tsunami."
    },
    {
      id: "valdivia1960",
      name: "1960 Great Chilean (Valdivia) earthquake",
      region: "Southern Chile, Pacific rim",
      lat: -38.14,
      lon: -73.03,
      magnitude: "9.4‚Äì9.6",
      scale: "Global",
      tsunamiExtent: "basin",
      dateText: "22 May 1960",
      month: 5,
      explicitSeasonHint: null,
      datingMethod: "Instrumental seismology, tsunami gauges, field geology.",
      climateImpact: "No major global climate signal, but triggered tsunamis across the Pacific and crustal adjustments.",
      nearbySettlements: "Valdivia, Concepci√≥n, Puerto Montt; coasts of Hawaii, Japan, Philippines, New Zealand, etc.",
      humanImpact: "Thousands killed in Chile; tsunami deaths and damage across the Pacific basin.",
      populationEffectFlag: true,
      notes: "Strongest earthquake ever instrumentally recorded; textbook ocean-basin tsunami event."
    },
    {
      id: "alaska1964",
      name: "1964 Alaska (Prince William Sound) earthquake",
      region: "Alaska, USA",
      lat: 61.05,
      lon: -147.5,
      magnitude: "9.2",
      scale: "Global",
      tsunamiExtent: "basin",
      dateText: "27 March 1964",
      month: 3,
      explicitSeasonHint: null,
      datingMethod: "Instrumentation, tsunami records, crustal deformation studies.",
      climateImpact: "No global climate change, but large tsunamis and land-level changes.",
      nearbySettlements: "Anchorage, Valdez, coastal communities in Alaska and British Columbia; tsunamis reached Hawaii and US West Coast.",
      humanImpact: "About 130 deaths; many from tsunamis. Long-term relocation and rebuilding in some Alaskan towns.",
      populationEffectFlag: true,
      notes: "Second-largest recorded quake; demonstrates high-latitude megathrust behavior."
    },
    {
      id: "indianocean2004",
      name: "2004 Indian Ocean earthquake & tsunami",
      region: "Off Sumatra, Indonesia",
      lat: 3.32,
      lon: 95.85,
      magnitude: "9.1‚Äì9.3",
      scale: "Global",
      tsunamiExtent: "basin",
      dateText: "26 December 2004",
      month: 12,
      explicitSeasonHint: null,
      datingMethod: "Seismic networks, GPS, tsunami deposits, eyewitness and satellite data.",
      climateImpact: "No climate shift, but enormous human/economic impact in 13 countries.",
      nearbySettlements: "Aceh (Sumatra), coastal Thailand, Sri Lanka, India, Maldives, East Africa.",
      humanImpact: "‚âà230,000 deaths, millions displaced; massive long-term rebuilding and changes to coastal settlement patterns.",
      populationEffectFlag: true,
      notes: "One of the deadliest natural disasters in modern history; ideal for your tsunami ‚Äòsuper-event‚Äô layer."
    },
    {
      id: "tohoku2011",
      name: "2011 T≈çhoku earthquake & tsunami",
      region: "NE Honshu, Japan",
      lat: 38.32,
      lon: 142.37,
      magnitude: "9.0‚Äì9.1",
      scale: "Global",
      tsunamiExtent: "basin",
      dateText: "11 March 2011",
      month: 3,
      explicitSeasonHint: null,
      datingMethod: "Dense seismic & GPS networks, tsunami gauges, satellite data.",
      climateImpact: "No major global climate change; huge tsunami and nuclear accident with global technological impact.",
      nearbySettlements: "Sendai, coastal towns of T≈çhoku; Pacific coasts across the basin saw tsunami waves.",
      humanImpact: ">18,000 dead or missing; Fukushima evacuation, long-term displacement and energy-policy changes worldwide.",
      populationEffectFlag: true,
      notes: "Combines megathrust quake, tsunami, and high-tech infrastructure failure‚Äîvery relevant for your modern ‚ÄòAtlantis‚Äô scenarios."
    },
    {
      id: "sf1906",
      name: "1906 San Francisco earthquake & fires",
      region: "Northern California, USA",
      lat: 37.77,
      lon: -122.42,
      magnitude: "‚âà7.9",
      scale: "Regional",
      tsunamiExtent: "local",
      dateText: "18 April 1906",
      month: 4,
      explicitSeasonHint: null,
      datingMethod: "Historical seismology, fault rupture mapping, macroseismic data.",
      climateImpact: "No climate effect; minor local tsunami.",
      nearbySettlements: "San Francisco and Bay Area cities.",
      humanImpact: "700‚Äì3000+ killed; city nearly destroyed mainly by fire; massive rebuilding and urban redesign.",
      populationEffectFlag: true,
      notes: "Example of earthquake where the real killer was fire, not water."
    },
    {
      id: "loma1989",
      name: "1989 Loma Prieta earthquake",
      region: "Central California, USA (SF Bay Area)",
      lat: 37.04,
      lon: -121.88,
      magnitude: "6.9",
      scale: "Regional",
      tsunamiExtent: "none",
      dateText: "17 October 1989",
      month: 10,
      explicitSeasonHint: null,
      datingMethod: "Modern instrumentation; widely studied.",
      climateImpact: "No climate or tsunami impact.",
      nearbySettlements: "Santa Cruz, San Francisco, Oakland, Bay Bridge corridor.",
      humanImpact: "63 deaths, 3,700+ injured; catastrophic collapse of the double-deck Cypress Street Viaduct in Oakland, crushing cars; pieces of the Bay Bridge fell.",
      populationEffectFlag: true,
      notes: "This is the California double-decker freeway disaster you mentioned; great example of engineering vulnerability."
    },
    {
      id: "haiti2010",
      name: "2010 Haiti earthquake",
      region: "Near Port-au-Prince, Haiti",
      lat: 18.46,
      lon: -72.53,
      magnitude: "7.0",
      scale: "Regional",
      tsunamiExtent: "local",
      dateText: "12 January 2010",
      month: 1,
      explicitSeasonHint: null,
      datingMethod: "Seismic networks, field investigations; very shallow thrust event.",
      climateImpact: "No climate change; small local tsunami only.",
      nearbySettlements: "Port-au-Prince and surrounding towns.",
      humanImpact: "Hundreds of thousands dead, >1 million displaced; long-term housing, food, disease and migration crises.",
      populationEffectFlag: true,
      notes: "One of the deadliest modern quakes for a single country; shows how vulnerability + poverty magnify disaster."
    },
    {
      id: "tangshan1976",
      name: "1976 Tangshan earthquake",
      region: "Hebei Province, China",
      lat: 39.63,
      lon: 118.19,
      magnitude: "7.5‚Äì7.6",
      scale: "Regional",
      tsunamiExtent: "none",
      dateText: "28 July 1976",
      month: 7,
      explicitSeasonHint: null,
      datingMethod: "Instrumental plus Chinese reports; shallow crustal quake.",
      climateImpact: "No tsunami and no climate signal.",
      nearbySettlements: "Tangshan and nearby industrial cities.",
      humanImpact: "Hundreds of thousands of deaths; large population displacement and long rebuilding period.",
      populationEffectFlag: true,
      notes: "Illustrates a purely continental, extremely deadly earthquake without any tsunami."
    },
    {
      id: "ancient_blacksea",
      name: "Black Sea flood (hypothesized quake-assisted)",
      region: "Black Sea / Bosporus region",
      lat: 42.0,
      lon: 30.0,
      magnitude: "unknown (if any single quake)",
      scale: "Regional",
      tsunamiExtent: "basin",
      dateText: "Hypotheses: ~17,000‚Äì8,000 years ago (various models)",
      month: null,
      explicitSeasonHint: null,
      datingMethod: "Marine geology, cores, radiocarbon; multiple competing models.",
      climateImpact: "Sea-level rise + possible flood pulses; not a discrete worldwide climate shock.",
      nearbySettlements: "Early Neolithic/late hunter-gatherer communities around the Black Sea margins.",
      humanImpact: "Some scientists suggest major coastal flooding and migration; connection to ‚ÄòNoah‚Äôs Flood‚Äô traditions is debated and not proven.",
      populationEffectFlag: true,
      notes: "Useful as a speculative layer for flood myths in your cosmic clock, but keep clearly marked as debated."
    }
  ];

  // --- Table rendering ---
  const tbody = document.getElementById("quakeTableBody");
  const detailsContent = document.getElementById("detailsContent");
  const scaleFilter = document.getElementById("scaleFilter");
  const tsuFilter = document.getElementById("tsuFilter");
  const popFilter = document.getElementById("popFilter");
  const searchBox = document.getElementById("searchBox");

  function scaleTagClass(scale) {
    if (scale === "Global") return "tag tag-global";
    if (scale === "Regional") return "tag tag-regional";
    return "tag tag-local";
  }

  function tsunamiLabel(ev) {
    if (ev.tsunamiExtent === "basin") return "Ocean-basin tsunami";
    if (ev.tsunamiExtent === "local") return "Local / regional tsunami";
    return "No tsunami";
  }

  function renderTable() {
    const scale = scaleFilter.value;
    const tsu = tsuFilter.value;
    const pop = popFilter.value;
    const q = (searchBox.value || "").toLowerCase();

    tbody.innerHTML = "";

    const filtered = quakes.filter(ev => {
      if (scale !== "all" && ev.scale !== scale) return false;

      if (tsu === "none" && ev.tsunamiExtent !== "none") return false;
      if (tsu === "local" && ev.tsunamiExtent !== "local") return false;
      if (tsu === "basin" && ev.tsunamiExtent !== "basin") return false;

      if (pop === "yes" && !ev.populationEffectFlag) return false;
      if (pop === "no" && ev.populationEffectFlag) return false;

      if (q) {
        const hay = (ev.name + " " + ev.region + " " + ev.notes).toLowerCase();
        if (!hay.includes(q)) return false;
      }
      return true;
    });

    filtered.forEach(ev => {
      const tr = document.createElement("tr");
      tr.dataset.id = ev.id;

      const tdName = document.createElement("td");
      tdName.textContent = ev.name;

      const tdMag = document.createElement("td");
      tdMag.textContent = ev.magnitude;

      const tdScale = document.createElement("td");
      const spanScale = document.createElement("span");
      spanScale.className = scaleTagClass(ev.scale);
      const dot = document.createElement("span");
      dot.className = "tag-dot";
      const label = document.createElement("span");
      label.textContent = ev.scale;
      spanScale.appendChild(dot);
      spanScale.appendChild(label);
      tdScale.appendChild(spanScale);

      const tdLat = document.createElement("td");
      tdLat.textContent = typeof ev.lat === "number" ? ev.lat.toFixed(2) : "";

      const tdLon = document.createElement("td");
      tdLon.textContent = typeof ev.lon === "number" ? ev.lon.toFixed(2) : "";

      const tdDate = document.createElement("td");
      tdDate.textContent = ev.dateText;

      tr.appendChild(tdName);
      tr.appendChild(tdMag);
      tr.appendChild(tdScale);
      tr.appendChild(tdLat);
      tr.appendChild(tdLon);
      tr.appendChild(tdDate);

      tr.addEventListener("click", () => {
        document.querySelectorAll("#quakeTableBody tr").forEach(r => r.classList.remove("active-row"));
        tr.classList.add("active-row");
        renderDetails(ev);
      });

      tbody.appendChild(tr);
    });

    if (!filtered.length) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.colSpan = 6;
      td.className = "muted";
      td.textContent = "No events match the current filters.";
      tr.appendChild(td);
      tbody.appendChild(tr);
    }
  }

  function renderDetails(ev) {
    const hemisphere = ev.lat >= 0 ? "Northern" : "Southern";
    const band = latBand(ev.lat);
    const season = inferSeason(ev.lat, ev.month, ev.explicitSeasonHint);
    const tsunamiText = tsunamiLabel(ev);

    const magNum = parseFloat(ev.magnitude);
    let badgeClass = "badge badge-historic";
    if (!isNaN(magNum)) {
      if (magNum >= 9.0) badgeClass = "badge badge-mega";
      else if (magNum >= 7.5) badgeClass = "badge badge-large";
    }

    const popTag = ev.populationEffectFlag
      ? `<span class="tag tag-pop"><span class="tag-dot" style="background:#22c55e;"></span><span>Strong population impact</span></span>`
      : `<span class="tag tag-pop"><span class="tag-dot" style="background:#4b5563;"></span><span>Limited population impact</span></span>`;

    const seasonTag = `<span class="tag tag-season"><span class="tag-dot" style="background:#f472b6;"></span><span>${season}</span></span>`;

    const tsuTag = `<span class="tag tag-tsu"><span class="tag-dot" style="background:#fb7185;"></span><span>${tsunamiText}</span></span>`;

    detailsContent.innerHTML = `
      <div class="details-header">
        <div class="details-title">${ev.name}</div>
        <div class="details-subtitle">${ev.region}</div>
        <div class="coords">Lat ${ev.lat.toFixed(4)}¬∞, Lon ${ev.lon.toFixed(4)}¬∞ (${hemisphere} Hemisphere)</div>
      </div>

      <div class="pill-row">
        <div class="${scaleTagClass(ev.scale)}">
          <span class="tag-dot"></span>
          <span>${ev.scale} impact scale</span>
        </div>
        <span class="${badgeClass}">Magnitude: ${ev.magnitude}</span>
        ${tsuTag}
        ${seasonTag}
        ${popTag}
      </div>

      <div class="details-grid">
        <div>
          <div class="details-section-title">Cosmic Clock Position</div>
          <ul>
            <li><strong>Latitude band:</strong> ${band}</li>
            <li><strong>Hemisphere:</strong> ${hemisphere} Hemisphere</li>
            <li><strong>Season inference:</strong> ${season}</li>
          </ul>

          <div class="details-section-title">Dating &amp; Seismology</div>
          <ul>
            <li><strong>Date / age:</strong> ${ev.dateText}</li>
            <li><strong>Magnitude info:</strong> ${ev.magnitude}</li>
            <li><strong>Dating / analysis methods:</strong> ${ev.datingMethod}</li>
          </ul>
        </div>

        <div>
          <div class="details-section-title">Tsunami &amp; Population Effects</div>
          <ul>
            <li><strong>Tsunami:</strong> ${tsunamiText}</li>
            <li><strong>Nearby cities / populations:</strong> ${ev.nearbySettlements}</li>
            <li><strong>Human impact:</strong> ${ev.humanImpact}</li>
            <li><strong>Climate / environment:</strong> ${ev.climateImpact}</li>
          </ul>

          <div class="details-section-title">Notes</div>
          <p class="mini">${ev.notes}</p>
        </div>
      </div>

      <p class="muted mini" style="margin-top:6px;">
        In this simulator, the ‚Äúcosmic clock‚Äù uses latitude, hemisphere and season to place each quake and tsunami
        into Earth‚Äôs annual energy cycle. Earthquakes themselves do not drive long-term global climate shifts, but
        their tsunamis, floods, fires and famines can force people to migrate, abandon cities, or re-order their
        societies ‚Äî the traces you‚Äôre hunting in your ancient city network.
      </p>
    `;
  }

  // Wire up filters
  scaleFilter.addEventListener("change", renderTable);
  tsuFilter.addEventListener("change", renderTable);
  popFilter.addEventListener("change", renderTable);
  searchBox.addEventListener("input", renderTable);

  // Initial render
  renderTable();
</script>
</body>
</html>
