<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Meteor Impact Cosmic Clock Simulator</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #050816;
      color: #e5e7eb;
    }

    header {
      padding: 16px 24px;
      border-bottom: 1px solid rgba(148,163,184,0.4);
      background: radial-gradient(circle at top left, #1d4ed8 0, #020617 45%, #000 100%);
      color: #e5e7eb;
    }

    header h1 {
      margin: 0 0 4px;
      font-size: 24px;
      letter-spacing: 0.04em;
    }

    header p {
      margin: 2px 0;
      font-size: 13px;
      color: #cbd5f5;
    }

    .container {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.6fr);
      gap: 16px;
      padding: 16px 20px 20px;
    }

    .panel {
      background: radial-gradient(circle at top, rgba(37,99,235,0.12), rgba(15,23,42,0.98));
      border-radius: 16px;
      border: 1px solid rgba(148,163,184,0.35);
      box-shadow: 0 18px 45px rgba(15,23,42,0.9);
      padding: 14px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .panel h2 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #e5e7eb;
    }

    .panel h2 span {
      font-size: 18px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      font-size: 12px;
    }

    .controls label {
      font-size: 12px;
      color: #cbd5f5;
    }

    select, input[type="text"] {
      background: rgba(15,23,42,0.9);
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
      padding: 4px 10px;
      font-size: 12px;
      outline: none;
    }

    select:focus, input[type="text"]:focus {
      border-color: #60a5fa;
      box-shadow: 0 0 0 1px rgba(37,99,235,0.6);
    }

    input[type="text"] {
      min-width: 150px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 6px;
      font-size: 12px;
    }

    thead {
      position: sticky;
      top: 0;
      background: linear-gradient(to right, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
      z-index: 1;
    }

    th, td {
      padding: 6px 6px;
      text-align: left;
      border-bottom: 1px solid rgba(30,64,175,0.6);
    }

    th {
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #9ca3af;
    }

    tbody tr {
      cursor: pointer;
      transition: background 0.1s ease, transform 0.08s ease;
    }

    tbody tr:hover {
      background: rgba(37,99,235,0.15);
      transform: translateY(-0.5px);
    }

    tbody tr.active-row {
      background: radial-gradient(circle at left, rgba(96,165,250,0.32), rgba(15,23,42,0.95));
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 1px 7px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid rgba(96,165,250,0.6);
      color: #bfdbfe;
      background: rgba(15,23,42,0.8);
      white-space: nowrap;
    }

    .tag-dot {
      width: 5px;
      height: 5px;
      border-radius: 999px;
    }

    .tag-global .tag-dot {
      background: #f97316;
    }

    .tag-regional .tag-dot {
      background: #22c55e;
    }

    .tag-local .tag-dot {
      background: #e5e7eb;
    }

    .tag-season {
      border-color: rgba(244,114,182,0.7);
      color: #f9a8d4;
    }

    .tag-pop {
      border-color: rgba(52,211,153,0.75);
      color: #a7f3d0;
    }

    .details-header {
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-bottom: 4px;
    }

    .details-title {
      font-size: 17px;
      font-weight: 600;
    }

    .details-subtitle {
      font-size: 12px;
      color: #9ca3af;
    }

    .coords {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      color: #cbd5f5;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 4px 0;
    }

    .details-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.1fr);
      gap: 10px;
      margin-top: 4px;
      font-size: 12px;
    }

    .details-section-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
      margin-bottom: 3px;
    }

    ul {
      padding-left: 16px;
      margin: 3px 0;
    }

    li {
      margin-bottom: 2px;
      line-height: 1.35;
    }

    .muted {
      color: #9ca3af;
      font-size: 11px;
    }

    .mini {
      font-size: 11px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      padding: 1px 7px;
      font-size: 10px;
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
    }

    .badge-ancient {
      border-color: rgba(249,115,22,0.8);
      color: #fed7aa;
    }

    .badge-historic {
      border-color: rgba(52,211,153,0.8);
      color: #a7f3d0;
    }

    .scroll {
      max-height: 410px;
      overflow: auto;
      margin: 0 -6px -6px;
      padding: 0 6px 1px;
    }

    @media (max-width: 960px) {
      .container {
        grid-template-columns: minmax(0,1fr);
      }
      .scroll {
        max-height: 280px;
      }
    }
  </style>
</head>
<body>
<header>
  <h1>Cosmic Clock ‚Äî Major Meteor Impacts vs. People & Climate</h1>
  <p>Click a meteor event to see its location, age/dating (including radiocarbon where available), and an inferred
    seasonal ‚Äúcosmic clock‚Äù from its latitude and date.</p>
  <p class="muted mini">
    Note: many events are dated by radiometric methods (Ar‚ÄìAr, U‚ÄìPb, etc.). Radiocarbon is only possible for the last
    ~50,000 years, so those fields are blank for most very ancient impacts.
  </p>
</header>

<div class="container">
  <section class="panel">
    <h2><span>‚òÑÔ∏è</span> Impact Events</h2>
    <div class="controls">
      <label>
        Scale:
        <select id="scaleFilter">
          <option value="all">All scales</option>
          <option value="Global">Global / mass-extinction scale</option>
          <option value="Regional">Regional</option>
          <option value="Local">Local</option>
        </select>
      </label>

      <label>
        Population impact:
        <select id="popFilter">
          <option value="all">Any</option>
          <option value="yes">Affected people / settlements</option>
          <option value="no">No known population impact</option>
        </select>
      </label>

      <label>
        Search:
        <input type="text" id="searchBox" placeholder="name, country, notes‚Ä¶">
      </label>
    </div>

    <div class="scroll">
      <table>
        <thead>
        <tr>
          <th>Event</th>
          <th>Scale</th>
          <th>Location</th>
          <th>Lat</th>
          <th>Lon</th>
          <th>Date / Age</th>
        </tr>
        </thead>
        <tbody id="impactTableBody">
        <!-- rows injected by JS -->
        </tbody>
      </table>
    </div>
  </section>

  <section class="panel" id="detailsPanel">
    <h2><span>üß≠</span> Cosmic Clock & Effects</h2>
    <div id="detailsContent">
      <p class="muted">
        Select an impact on the left to see:
      </p>
      <ul class="muted">
        <li>Lat/long, hemisphere, and latitude band (cosmic clock position)</li>
        <li>Best available age / dating method (radiocarbon where possible)</li>
        <li>Whether it changed global climate or just the local area</li>
        <li>Evidence of impacts on cities, cultures, or living populations</li>
      </ul>
    </div>
  </section>
</div>

<script>
  // --- Helper: classify latitude band for the "cosmic clock" feeling ---
  function latBand(lat) {
    const aLat = Math.abs(lat);
    if (aLat < 10) return "Equatorial band (0‚Äì10¬∞)";
    if (aLat < 23.5) return "Tropical band (10‚Äì23.5¬∞)";
    if (aLat < 40) return "Subtropical / warm mid-latitudes (23.5‚Äì40¬∞)";
    if (aLat < 60) return "Mid-latitudes (40‚Äì60¬∞)";
    return "High-latitude / polar (60¬∞+)";
  }

  // --- Helper: infer season from month & hemisphere ---
  function inferSeason(lat, month, explicitSeasonHint) {
    if (explicitSeasonHint) return explicitSeasonHint; // use research-based hint when we have it
    if (!month || month < 1 || month > 12) return "Season unknown";

    const northSeasons = [
      "Winter", "Winter", "Spring", "Spring", "Spring",
      "Summer", "Summer", "Summer", "Autumn", "Autumn", "Autumn", "Winter"
    ];
    const southSeasons = [
      "Summer", "Summer", "Autumn", "Autumn", "Autumn",
      "Winter", "Winter", "Winter", "Spring", "Spring", "Spring", "Summer"
    ];
    const idx = month - 1;
    const hemiIsNorth = lat >= 0;
    const s = hemiIsNorth ? northSeasons[idx] : southSeasons[idx];
    return s + " (approximate, based on month & hemisphere)";
  }

  // --- Dataset: selected major / high-impact meteor events ---
  // Many ages are radiometric (Ma = million years; ka / yr BP = thousand years before present)
  const impacts = [
    {
      id: "chicxulub",
      name: "Chicxulub impact",
      region: "Yucat√°n Peninsula, Mexico",
      lat: 21.33,
      lon: -89.50,
      scale: "Global",
      impactType: "Large asteroid; mass extinction",
      dateText: "‚âà66,043,000 years ago",
      ageDetail: "66.043 ¬± 0.011 Ma (Cretaceous‚ÄìPaleogene boundary, Ar‚ÄìAr dating of ejecta)",
      datingMethod: "High-precision radiometric dating (argon‚Äìargon, multiple sites)",
      carbonDating: "",
      month: null,
      explicitSeasonHint: "Spring in the Northern Hemisphere (inferred from Tanis fossil fish growth lines)",
      humanImpact: "No humans existed; caused extinction of ~75% of species, including non-avian dinosaurs. Global climate collapse (dust, aerosols, fires).",
      climateImpact: "Severe, global climatic disruption and mass extinction.",
      populationEffectFlag: false,
      notes: "One of the largest known impacts on Earth; crater ~180‚Äì200 km wide, buried under Yucat√°n."
    },
    {
      id: "popigai",
      name: "Popigai crater",
      region: "Northern Siberia, Russia",
      lat: 71.60,
      lon: 111.20,
      scale: "Global",
      impactType: "Large asteroid; possible mass-extinction link",
      dateText: "‚âà35.7 million years ago (Late Eocene)",
      ageDetail: "‚âà35.7 Ma (radiometric dating; similar age to Late Eocene extinction events)",
      datingMethod: "Radiometric dating (Ar‚ÄìAr); correlated with extinction horizons",
      carbonDating: "",
      month: null,
      explicitSeasonHint: null,
      humanImpact: "No humans; likely contributed to Late Eocene global environmental stress.",
      climateImpact: "Probable significant global climatic effects (dust, aerosols) during Late Eocene.",
      populationEffectFlag: false,
      notes: "Craters of similar age suggest a cluster of Eocene impacts; Popigai is ~90‚Äì100 km in diameter."
    },
    {
      id: "manicouagan",
      name: "Manicouagan impact structure",
      region: "Quebec, Canada",
      lat: 51.38,
      lon: -68.70,
      scale: "Regional",
      impactType: "Large crater in Pangaea; Triassic",
      dateText: "‚âà214‚Äì215 million years ago (Late Triassic)",
      ageDetail: "214‚Äì215 Ma (Triassic, Ar‚ÄìAr dating of impact melt)",
      datingMethod: "Radiometric dating (Ar‚ÄìAr) of impact glass and stratigraphy",
      carbonDating: "",
      month: null,
      explicitSeasonHint: null,
      humanImpact: "Pre-human; may have affected Triassic ecosystems regionally.",
      climateImpact: "Likely significant regional to hemispheric climate effects; global extinction role debated.",
      populationEffectFlag: false,
      notes: "Crater ~100 km across; now partly expressed as a ring-shaped reservoir (\"Eye of Quebec\")."
    },
    {
      id: "zhamanshin",
      name: "Zhamanshin crater",
      region: "Aktobe Region, Kazakhstan",
      lat: 48.40,
      lon: 60.97,
      scale: "Regional",
      impactType: "Mid-Pleistocene impact; nuclear-winter scale candidate",
      dateText: "‚âà0.9 ¬± 0.1 million years ago (Pleistocene)",
      ageDetail: "0.9 ¬± 0.1 Ma (Pleistocene, radiometric dating of impact glass)",
      datingMethod: "Radiometric dating of impact glass and crater deposits",
      carbonDating: "",
      month: null,
      explicitSeasonHint: null,
      humanImpact: "Far pre-human; could have produced short-term global cooling but not a mass extinction.",
      climateImpact: "Potential for nuclear-winter-like effects on climate for a short interval.",
      populationEffectFlag: false,
      notes: "Most recent known impact large enough to approach nuclear-winter scale."
    },
    {
      id: "meteor_crater",
      name: "Meteor Crater (Barringer)",
      region: "Arizona, USA",
      lat: 35.0272,
      lon: -111.0225,
      scale: "Regional",
      impactType: "Small iron asteroid; explosive crater",
      dateText: "‚âà50,000 years ago",
      ageDetail: "‚âà50 ka (Pleistocene; exposure dating of rocks and sediments)",
      datingMethod: "Cosmogenic nuclide exposure dating and stratigraphic constraints",
      carbonDating: "",
      month: null,
      explicitSeasonHint: null,
      humanImpact: "Humans were probably not in the immediate area; impact destroyed local ecosystem within tens of km.",
      climateImpact: "No global effect; intense regional blast, ejecta blanket, and possible distant seismic effects.",
      populationEffectFlag: false,
      notes: "Best-preserved simple impact crater on Earth; ~1.2 km wide, ~170 m deep with raised rim."
    },
    {
      id: "lonar",
      name: "Lonar impact crater",
      region: "Maharashtra, India",
      lat: 19.97,
      lon: 76.51,
      scale: "Local",
      impactType: "Impact into Deccan basalt; crater lake",
      dateText: "‚âà52,000 years (older estimates) to ‚âà570,000 ¬± 47,000 years",
      ageDetail: "Thermoluminescence: ~52 ka; newer Ar‚ÄìAr dating: ~576 ¬± 47 ka",
      datingMethod: "Thermoluminescence of impact glass; Ar‚ÄìAr dating of crater rocks",
      carbonDating: "",
      month: null,
      explicitSeasonHint: null,
      humanImpact: "Pre-agricultural humans may have been in South Asia, but no direct link to population movement is known.",
      climateImpact: "Local hydrothermal and ecological effects only.",
      populationEffectFlag: false,
      notes: "One of the few confirmed hypervelocity craters in basalt; now a saline/alkaline lake."
    },
    {
      id: "kaali",
      name: "Kaali crater group",
      region: "Saaremaa Island, Estonia",
      lat: 58.3728,
      lon: 22.6694,
      scale: "Local",
      impactType: "Multiple small craters in a populated Bronze Age landscape",
      dateText: "Shortly after 1530‚Äì1450 BCE (~3237 ¬± 10 ¬π‚Å¥C yr BP)",
      ageDetail: "Radiocarbon: 3237 ¬± 10 ¬π‚Å¥C years BP from charcoal in ejecta; Bronze Age",
      datingMethod: "Radiocarbon dating of charcoal in proximal ejecta, plus sediment studies",
      carbonDating: "Yes ‚Äî ¬π‚Å¥C ages on charcoal; formation shortly after 1530‚Äì1450 BCE.",
      month: null,
      explicitSeasonHint: null,
      humanImpact: "Occurred in an already populated area; likely destroyed forest and may have affected local settlements and mythology.",
      climateImpact: "Local to regional blast, fire, and ecological disruption; no global effect.",
      populationEffectFlag: true,
      notes: "One of the few impacts clearly within a populated region in prehistory; ring-shaped crater with a lake today."
    },
    {
      id: "campo_del_cielo",
      name: "Campo del Cielo crater field",
      region: "Chaco / Santiago del Estero, Argentina",
      lat: -27.6333,
      lon: -61.7000,
      scale: "Local",
      impactType: "Strewn field of iron fragments; multiple small craters",
      dateText: "‚âà4,200‚Äì4,700 years ago (2200‚Äì2700 BCE)",
      ageDetail: "4,200‚Äì4,700 yr BP (Holocene) from ¬π‚Å¥C dating of charred wood beneath fragments",
      datingMethod: "Radiocarbon dating of buried charred wood; stratigraphic evidence",
      carbonDating: "Yes ‚Äî ¬π‚Å¥C ages from charred wood give ~4.2‚Äì4.7 ka.",
      month: null,
      explicitSeasonHint: null,
      humanImpact: "Indigenous peoples knew the iron masses and incorporated them into tools and stories; local blast scars but no clear evidence of city-scale abandonment.",
      climateImpact: "Local environmental damage where individual fragments struck; no regional climate change.",
      populationEffectFlag: true,
      notes: "At least 26 small craters; more than 100 tonnes of iron recovered; name means ‚ÄúField of the Sky‚Äù."
    },
    {
      id: "tunguska",
      name: "Tunguska event",
      region: "Podkamennaya Tunguska River, Siberia, Russia",
      lat: 60.9,
      lon: 101.9,
      scale: "Regional",
      impactType: "Airburst of ~50‚Äì60 m object over remote taiga",
      dateText: "30 June 1908",
      ageDetail: "Witness accounts, seismic and atmospheric data (20th century)",
      datingMethod: "Historical records, tree-ring studies, eyewitnesses, and later physical modeling",
      carbonDating: "",
      month: 6,
      explicitSeasonHint: null,
      humanImpact: "Flattened ~2,000 km¬≤ of forest (tens of millions of trees). Very few people lived there; a handful of local casualties are possible, but no large city was hit.",
      climateImpact: "Injected energy and dust into the atmosphere; some short-term atmospheric phenomena reported, but no long-lasting global climate shift.",
      populationEffectFlag: true,
      notes: "Explosion energy ~3‚Äì15 megatons TNT equivalent; powerful enough to devastate a modern city if it had occurred over one."
    },
    {
      id: "sikhote_alin",
      name: "Sikhote-Alin meteorite fall",
      region: "Primorsky Krai, Russia",
      lat: 46.1560,
      lon: 134.6520,
      scale: "Local",
      impactType: "Large iron meteorite shower; many small craters",
      dateText: "12 February 1947",
      ageDetail: "Observed fall in daylight; well-documented eyewitness accounts",
      datingMethod: "Direct observation and later mapping of strewn field and craters",
      carbonDating: "",
      month: 2,
      explicitSeasonHint: null,
      humanImpact: "Spectacular daylight fireball and loud explosions; fragments formed dozens of small craters in remote forest; no large settlements destroyed.",
      climateImpact: "Negligible beyond local blast and forest damage.",
      populationEffectFlag: true,
      notes: "One of the largest witnessed iron falls (>23 tonnes of recovered metal)."
    },
    {
      id: "chelyabinsk",
      name: "Chelyabinsk airburst",
      region: "Chelyabinsk Oblast, Russia",
      lat: 54.8,
      lon: 61.1,
      scale: "Local",
      impactType: "Superbolide airburst over a city",
      dateText: "15 February 2013",
      ageDetail: "Satellite data, infrasound, seismographs, and thousands of videos",
      datingMethod: "Instrumental records and recovered LL5 chondrite meteorites",
      carbonDating: "",
      month: 2,
      explicitSeasonHint: null,
      humanImpact: "Around 1,500‚Äì1,600 people injured (mostly by flying glass), >7,000 buildings damaged in six cities, but no direct impact crater in the urban area.",
      climateImpact: "No climate change, but an important modern reminder of impact risk.",
      populationEffectFlag: true,
      notes: "Explosion ~400‚Äì500 kilotons TNT; the brightest object in the sky, briefly brighter than the Sun."
    },
    {
      id: "carancas",
      name: "Carancas impact event",
      region: "Puno Region, Peru (Altiplano near Lake Titicaca)",
      lat: -16.6645,
      lon: -69.0441,
      scale: "Local",
      impactType: "Small chondritic meteorite forming a crater",
      dateText: "15 September 2007",
      ageDetail: "Exact date and local time known from eyewitnesses and seismic records",
      datingMethod: "Historical documentation and analysis of crater and meteorite fragments",
      carbonDating: "",
      month: 9,
      explicitSeasonHint: null,
      humanImpact: "Villagers reported illness (headaches, nausea) from gases/boiling water in the crater; minor structural damage nearby but no mass casualties.",
      climateImpact: "Negligible globally; localized water and soil contamination plus shock and fear.",
      populationEffectFlag: true,
      notes: "Unusual because a stony meteorite produced a small ~13.5 m crater and noticeable ground effects."
    }
  ];

  // --- Build table ---
  const tbody = document.getElementById("impactTableBody");
  const detailsContent = document.getElementById("detailsContent");
  const scaleFilter = document.getElementById("scaleFilter");
  const popFilter = document.getElementById("popFilter");
  const searchBox = document.getElementById("searchBox");

  function scaleTagClass(scale) {
    if (scale === "Global") return "tag tag-global";
    if (scale === "Regional") return "tag tag-regional";
    return "tag tag-local";
  }

  function renderTable() {
    const scale = scaleFilter.value;
    const pop = popFilter.value;
    const q = (searchBox.value || "").toLowerCase();

    tbody.innerHTML = "";

    const filtered = impacts.filter(ev => {
      if (scale !== "all" && ev.scale !== scale) return false;
      if (pop === "yes" && !ev.populationEffectFlag) return false;
      if (pop === "no" && ev.populationEffectFlag) return false;

      if (q) {
        const hay = (ev.name + " " + ev.region + " " + ev.impactType + " " + ev.notes).toLowerCase();
        if (!hay.includes(q)) return false;
      }
      return true;
    });

    filtered.forEach(ev => {
      const tr = document.createElement("tr");
      tr.dataset.id = ev.id;

      const tdName = document.createElement("td");
      tdName.textContent = ev.name;

      const tdScale = document.createElement("td");
      const spanScale = document.createElement("span");
      spanScale.className = scaleTagClass(ev.scale);
      const dot = document.createElement("span");
      dot.className = "tag-dot";
      const label = document.createElement("span");
      label.textContent = ev.scale;
      spanScale.appendChild(dot);
      spanScale.appendChild(label);
      tdScale.appendChild(spanScale);

      const tdLoc = document.createElement("td");
      tdLoc.textContent = ev.region;

      const tdLat = document.createElement("td");
      tdLat.textContent = ev.lat.toFixed(2);

      const tdLon = document.createElement("td");
      tdLon.textContent = ev.lon.toFixed(2);

      const tdAge = document.createElement("td");
      tdAge.textContent = ev.dateText;

      tr.appendChild(tdName);
      tr.appendChild(tdScale);
      tr.appendChild(tdLoc);
      tr.appendChild(tdLat);
      tr.appendChild(tdLon);
      tr.appendChild(tdAge);

      tr.addEventListener("click", () => {
        document.querySelectorAll("#impactTableBody tr").forEach(r => r.classList.remove("active-row"));
        tr.classList.add("active-row");
        renderDetails(ev);
      });

      tbody.appendChild(tr);
    });

    if (!filtered.length) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.colSpan = 6;
      td.className = "muted";
      td.textContent = "No events match the current filters.";
      tr.appendChild(td);
      tbody.appendChild(tr);
    }
  }

  // --- Render details panel ---
  function renderDetails(ev) {
    const hemisphere = ev.lat >= 0 ? "Northern" : "Southern";
    const band = latBand(ev.lat);
    const season = inferSeason(ev.lat, ev.month, ev.explicitSeasonHint);

    const isAncient = ev.dateText.includes("years ago") || ev.dateText.includes("Ma");
    const badgeClass = isAncient ? "badge badge-ancient" : "badge badge-historic";
    const badgeText = isAncient ? "Geologic / prehistory" : "Historical / recent";

    const popTag = ev.populationEffectFlag
      ? `<span class="tag tag-pop"><span class="tag-dot" style="background:#22c55e;"></span><span>Population affected</span></span>`
      : `<span class="tag tag-pop"><span class="tag-dot" style="background:#4b5563;"></span><span>Little / no direct population effect</span></span>`;

    const seasonTag = `<span class="tag tag-season"><span class="tag-dot" style="background:#f472b6;"></span><span>${season}</span></span>`;

    detailsContent.innerHTML = `
      <div class="details-header">
        <div class="details-title">${ev.name}</div>
        <div class="details-subtitle">${ev.region}</div>
        <div class="coords">Lat ${ev.lat.toFixed(4)}¬∞, Lon ${ev.lon.toFixed(4)}¬∞ (${hemisphere} Hemisphere)</div>
      </div>

      <div class="pill-row">
        <div class="${scaleTagClass(ev.scale)}">
          <span class="tag-dot"></span>
          <span>${ev.scale} impact scale</span>
        </div>
        <span class="${badgeClass}">${badgeText}</span>
        ${seasonTag}
        ${popTag}
      </div>

      <div class="details-grid">
        <div>
          <div class="details-section-title">Cosmic Clock Position</div>
          <ul>
            <li><strong>Latitude band:</strong> ${band}</li>
            <li><strong>Hemisphere:</strong> ${hemisphere} Hemisphere</li>
            <li><strong>Season inference:</strong> ${season}</li>
            <li><strong>Impact type:</strong> ${ev.impactType}</li>
          </ul>

          <div class="details-section-title">Dating &amp; Chronology</div>
          <ul>
            <li><strong>Date / age:</strong> ${ev.dateText}</li>
            <li><strong>Age detail:</strong> ${ev.ageDetail}</li>
            <li><strong>Primary dating method:</strong> ${ev.datingMethod}</li>
            <li><strong>Radiocarbon (¬π‚Å¥C) info:</strong> ${
              ev.carbonDating ? ev.carbonDating : "Not applicable or too old for radiocarbon; dated by other radiometric methods."
            }</li>
          </ul>
        </div>

        <div>
          <div class="details-section-title">Effects on Climate &amp; Life</div>
          <ul>
            <li><strong>Climate / environmental impact:</strong> ${ev.climateImpact}</li>
            <li><strong>Human / population impact:</strong> ${ev.humanImpact}</li>
          </ul>

          <div class="details-section-title">Notes</div>
          <p class="mini">${ev.notes}</p>
        </div>
      </div>

      <p class="muted mini" style="margin-top:6px;">
        ‚ÄúCosmic clock‚Äù here means: using latitude, hemisphere, and (when known) month of impact to
        place the event on Earth‚Äôs annual cycle of seasons and climate bands. For deep-time impacts
        we only know the age and latitude of the crater today, not the exact day and month.
      </p>
    `;
  }

  // --- Wire up filters ---
  scaleFilter.addEventListener("change", renderTable);
  popFilter.addEventListener("change", renderTable);
  searchBox.addEventListener("input", renderTable);

  // Initial render
  renderTable();
</script>
</body>
</html>
