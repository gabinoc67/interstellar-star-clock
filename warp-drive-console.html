<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Warp Drive Console</title>
  <style>
    html, body {
      margin: 0; padding: 0; height: 100vh;
      overflow: hidden; background: #000;
      font-family: 'Segoe UI', sans-serif;
    }
    /* Starfield */
    body::before {
      content:"";position:fixed;top:0;left:0;right:0;bottom:0;
      background:
        radial-gradient(#fff 1px,transparent 1px),
        radial-gradient(#fff 1px,transparent 1px);
      background-size:50px 50px;
      background-position:0 0,25px 25px;
      opacity:0.08;animation:starDrift 60s linear infinite;
      z-index:0;
    }
    @keyframes starDrift {
      from{background-position:0 0,25px 25px;}
      to{background-position:500px 1000px,525px 1025px;}
    }
    /* Controls */
    #controls {
      position:fixed; top:20px; left:20px; z-index:100;
      background:rgba(0,0,0,0.7); padding:12px 16px;
      border-radius:8px; color:#fff;
    }
    #controls select,#controls button {
      margin-left:8px; font-size:14px; padding:4px 6px;
    }
    /* Viewport */
    #viewport {
      position:relative; width:100%; height:100%; z-index:1;
      overflow:hidden;
    }
    /* Planet styling */
    .planet {
      position:absolute; top:50%; left:50%;
      height:150px; width:auto;
      object-fit:contain;
      transform:translate(-50%,-50%) scale(1);
      transform-origin:center center;
      will-change:transform,opacity;
      transition:filter 0.2s ease;
      animation:rotatePlanet 60s linear infinite;
    }
    @keyframes rotatePlanet {
      from{transform:translate(-50%,-50%) scale(1) rotate(0deg);}
      to{transform:translate(-50%,-50%) scale(1) rotate(360deg);}
    }
    /* Fade and blur */
    .fade-out { opacity:0; transition:opacity 2s ease-out; }
    .fade-in  { opacity:1; transition:opacity 2s ease-in;  }
    .zooming  { filter:blur(2px) brightness(1.2);       }
    /* HUD */
    #hud {
      position:fixed; bottom:20px; right:20px; z-index:100;
      background:rgba(0,0,0,0.6); color:#0ff;
      padding:10px 14px; font-family:monospace; font-size:14px;
      border:1px solid #0ff; border-radius:6px;
    }
    #hud div { margin:4px 0; }
    /* Vector Panel */
    #vectorsPanel {
      position:fixed; top:20px; right:20px; z-index:90;
      background:rgba(0,0,64,0.4); border:1px solid cyan;
      border-radius:6px;
    }
    #vectorsCanvas {
      display:block; width:180px; height:180px;
    }
  </style>
</head>
<body>

  <!-- Controls -->
  <div id="controls">
    Warp Drive:
    <select id="warp">
      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
      <option>6</option><option>7</option><option>8</option><option>9</option><option>10</option>
    </select>
    Destination:
    <select id="destination">
      <option>mercury2</option><option>venus2</option><option>earth</option>
      <option>mars</option><option>jupiter</option><option>saturn</option>
      <option>uranus</option><option>neptune2</option><option>pluto2</option>
      <option>moon</option>
    </select>
    <button id="engage">Engage</button>
    <button id="reset">Reset</button>
  </div>

  <!-- Warp Viewport -->
  <div id="viewport">
    <img id="planet" class="planet" src="earth.png" alt="Planet">
  </div>

  <!-- Vector Panel -->
  <div id="vectorsPanel">
    <canvas id="vectorsCanvas" width="180" height="180"></canvas>
  </div>

  <!-- HUD -->
  <div id="hud">
    <div>üåê Warp Level: <span id="hudWarp">1</span></div>
    <div>üöÄ Target:     <span id="hudDest">earth</span></div>
    <div>üåÄ Zoom Scale: <span id="hudZoom">1.30</span></div>
    <div>üïí ETA:        <span id="hudETA">0.0s</span></div>
    <div>üìè Distance:   <span id="hudDist">1.00 AU</span></div>
    <div>‚ö° Speed:       <span id="hudSpeed">1.00c</span></div>
  </div>

  <!-- Audio -->
  <audio id="soundWarp"   src="warp.mp3"   preload="auto"></audio>
  <audio id="soundArrive" src="arrive.mp3"   preload="auto"></audio>
  <audio id="soundHum"    src="hum.mp3"      preload="auto" loop autoplay></audio>

  <script>
    // Elements
    const planetImg       = document.getElementById('planet');
    const warpSelect      = document.getElementById('warp');
    const destSelect      = document.getElementById('destination');
    const engageBtn       = document.getElementById('engage');
    const resetBtn        = document.getElementById('reset');
    const soundWarp       = document.getElementById('soundWarp');
    const soundArrive     = document.getElementById('soundArrive');

    // HUD refs
    const hudWarp         = document.getElementById('hudWarp');
    const hudDest         = document.getElementById('hudDest');
    const hudZoom         = document.getElementById('hudZoom');
    const hudETA          = document.getElementById('hudETA');
    const hudDist         = document.getElementById('hudDist');
    const hudSpeed        = document.getElementById('hudSpeed');

    // Canvas for vectors
    const canvas          = document.getElementById('vectorsCanvas');
    const ctx             = canvas.getContext('2d');

    // Constants
    const TARGET_SCALE    = 1.3;    // 130% final size
    const MIN_SCALE       = 0.05;   // 5% start/end size
    const AU_DISTANCES    = {
      mercury2:0.39, venus2:0.72, earth:1.0, mars:1.52,
      jupiter:5.2, saturn:9.5, uranus:19.8, neptune2:30,
      pluto2:39.5, moon:0.00257
    };

    let zooming = false, zoom=TARGET_SCALE, animFrame;
    let vectorAngle=0;

    // Update HUD
    function updateHUD(eta=0, dist=1, speed=1){
      hudWarp.textContent   = warpSelect.value;
      hudDest.textContent   = destSelect.value;
      hudZoom.textContent   = zoom.toFixed(2);
      hudETA.textContent    = `${eta.toFixed(1)}s`;
      hudDist.textContent   = `${dist.toFixed(2)} AU`;
      hudSpeed.textContent  = `${speed.toFixed(2)}c`;
    }

    // Compute ETA etc.
    function computeETA(warp, dest){
      const dist = AU_DISTANCES[dest]||1;
      const speed= Math.pow(warp,3);
      const eta   = (dist*500)/speed;
      return {eta,dist,speed};
    }

    // Zoom OUT (planet recedes)
    function zoomOut(speed, cb){
      cancelAnimationFrame(animFrame);
      zooming=true; zoom=TARGET_SCALE;
      planetImg.classList.add('zooming');
      function frame(){
        if(!zooming) return;
        zoom = Math.max(MIN_SCALE, zoom - speed);
        planetImg.style.transform=`translate(-50%,-50%) scale(${zoom})`;
        updateHUD();
        if(zoom>MIN_SCALE+0.001) animFrame=requestAnimationFrame(frame);
        else { zooming=false; cb(); }
      }
      frame();
    }

    // Zoom IN (planet approaches)
    function zoomIn(speed, cb){
      cancelAnimationFrame(animFrame);
      zooming=true; zoom=MIN_SCALE;
      planetImg.classList.add('zooming');
      function frame(){
        if(!zooming) return;
        zoom = Math.min(TARGET_SCALE, zoom + speed);
        planetImg.style.transform=`translate(-50%,-50%) scale(${zoom})`;
        updateHUD();
        if(zoom<TARGET_SCALE-0.001) animFrame=requestAnimationFrame(frame);
        else { zooming=false; planetImg.classList.remove('zooming'); cb?.(); }
      }
      frame();
    }

    // Engage button
    engageBtn.onclick = ()=>{
      const warp = +warpSelect.value;
      const dest = destSelect.value;
      const {eta,dist,speed} = computeETA(warp,dest);
      updateHUD(eta,dist,speed);
      soundWarp.currentTime=0; soundWarp.play();
      zoomOut(0.005*warp, ()=>{
        planetImg.classList.add('fade-out');
        setTimeout(()=>{
          planetImg.src = `${dest}.png`;
          planetImg.classList.remove('fade-out');
          planetImg.classList.add('fade-in');
          soundArrive.currentTime=0; soundArrive.play();
          zoomIn(0.01*warp, ()=>{
            planetImg.classList.remove('fade-in');
          });
        },500);
      });
    };

    // Reset button
    resetBtn.onclick = ()=>{
      warpSelect.value='1';
      destSelect.value='earth';
      planetImg.src='earth.png';
      zoom=TARGET_SCALE;
      planetImg.style.transform=`translate(-50%,-50%) scale(${zoom})`;
      planetImg.classList.remove('fade-in','fade-out','zooming');
      updateHUD(0,AU_DISTANCES['earth'],1);
    };

    // Vector panel animation
    function drawVectors(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      const cx=canvas.width/2, cy=canvas.height/2;
      for(let i=0;i<8;i++){
        const a = vectorAngle + i*(Math.PI/4);
        const x = cx + Math.cos(a)*60;
        const y = cy + Math.sin(a)*60;
        ctx.beginPath();
        ctx.moveTo(cx,cy);
        ctx.lineTo(x,y);
        ctx.strokeStyle='cyan';
        ctx.lineWidth=1;
        ctx.stroke();
        ctx.beginPath();
        ctx.arc(x,y,2,0,2*Math.PI);
        ctx.fillStyle='cyan';
        ctx.fill();
      }
      vectorAngle += 0.01;
      requestAnimationFrame(drawVectors);
    }

    // Init
    resetBtn.click();
    drawVectors();
  </script>
</body>
</html>
